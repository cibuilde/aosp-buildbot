
name: AOSP Build
on:
  push:
    tags:
    - '*'
env:
  branch: 'android-12.0.0_r1'
jobs:

  build_step5:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
    - name: Checkout
      uses: actions/checkout@main
    - name: Call Composite Action bootstrap
      uses: ./.github/actions/bootstrap
      id: bootstrap

    - name: Restore Cache prebuilts/misc
      id: prebuilts_misc
      uses: actions/cache@v3
      with:
        path: aosp/prebuilts/misc
        key: prebuilts_misc@${{ env.branch }}
        restore-keys: prebuilts_misc@${{ env.branch }}
    - name: Clone project prebuilts/misc
      if: steps.prebuilts_misc.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_sparse_exclude prebuilts/misc '!/common/robolectric' '!/darwin-x86' '!/darwin-x86_64' '!/gdbserver'
    - name: Restore Cache prebuilts/jdk/jdk8
      id: prebuilts_jdk_jdk8
      uses: actions/cache@v3
      with:
        path: aosp/prebuilts/jdk/jdk8
        key: prebuilts_jdk_jdk8@${{ env.branch }}
        restore-keys: prebuilts_jdk_jdk8@${{ env.branch }}
    - name: Clone project prebuilts/jdk/jdk8
      if: steps.prebuilts_jdk_jdk8.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform prebuilts/jdk/jdk8
    - name: Restore Cache prebuilts/jdk/jdk11
      id: prebuilts_jdk_jdk11
      uses: actions/cache@v3
      with:
        path: aosp/prebuilts/jdk/jdk11
        key: prebuilts_jdk_jdk11@${{ env.branch }}
        restore-keys: prebuilts_jdk_jdk11@${{ env.branch }}
    - name: Clone project prebuilts/jdk/jdk11
      if: steps.prebuilts_jdk_jdk11.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform prebuilts/jdk/jdk11
    - name: Restore Cache external/rust/crates/futures-macro
      id: external_rust_crates_futures-macro
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/futures-macro
        key: external_rust_crates_futures-macro@${{ env.branch }}
        restore-keys: external_rust_crates_futures-macro@${{ env.branch }}
    - name: Clone project external/rust/crates/futures-macro
      if: steps.external_rust_crates_futures-macro.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/futures-macro
    - name: Restore Cache external/rust/crates/num-derive
      id: external_rust_crates_num-derive
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/num-derive
        key: external_rust_crates_num-derive@${{ env.branch }}
        restore-keys: external_rust_crates_num-derive@${{ env.branch }}
    - name: Clone project external/rust/crates/num-derive
      if: steps.external_rust_crates_num-derive.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/num-derive
    - name: Restore Cache external/rust/crates/paste
      id: external_rust_crates_paste
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/paste
        key: external_rust_crates_paste@${{ env.branch }}
        restore-keys: external_rust_crates_paste@${{ env.branch }}
    - name: Clone project external/rust/crates/paste
      if: steps.external_rust_crates_paste.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/paste
    - name: Restore Cache external/rust/crates/proc-macro-hack
      id: external_rust_crates_proc-macro-hack
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/proc-macro-hack
        key: external_rust_crates_proc-macro-hack@${{ env.branch }}
        restore-keys: external_rust_crates_proc-macro-hack@${{ env.branch }}
    - name: Clone project external/rust/crates/proc-macro-hack
      if: steps.external_rust_crates_proc-macro-hack.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/proc-macro-hack
    - name: Restore Cache external/rust/crates/serde_derive
      id: external_rust_crates_serde_derive
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/serde_derive
        key: external_rust_crates_serde_derive@${{ env.branch }}
        restore-keys: external_rust_crates_serde_derive@${{ env.branch }}
    - name: Clone project external/rust/crates/serde_derive
      if: steps.external_rust_crates_serde_derive.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/serde_derive
    - name: Restore Cache external/rust/crates/thiserror-impl
      id: external_rust_crates_thiserror-impl
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/thiserror-impl
        key: external_rust_crates_thiserror-impl@${{ env.branch }}
        restore-keys: external_rust_crates_thiserror-impl@${{ env.branch }}
    - name: Clone project external/rust/crates/thiserror-impl
      if: steps.external_rust_crates_thiserror-impl.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/thiserror-impl
    - name: Restore Cache external/rust/crates/tokio-macros
      id: external_rust_crates_tokio-macros
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/tokio-macros
        key: external_rust_crates_tokio-macros@${{ env.branch }}
        restore-keys: external_rust_crates_tokio-macros@${{ env.branch }}
    - name: Clone project external/rust/crates/tokio-macros
      if: steps.external_rust_crates_tokio-macros.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/tokio-macros
    - name: Restore Cache external/libyuv
      id: external_libyuv
      uses: actions/cache@v3
      with:
        path: aosp/external/libyuv
        key: external_libyuv@${{ env.branch }}
        restore-keys: external_libyuv@${{ env.branch }}
    - name: Clone project external/libyuv
      if: steps.external_libyuv.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/libyuv
    - name: Restore Cache frameworks/compile/mclinker
      id: frameworks_compile_mclinker
      uses: actions/cache@v3
      with:
        path: aosp/frameworks/compile/mclinker
        key: frameworks_compile_mclinker@${{ env.branch }}
        restore-keys: frameworks_compile_mclinker@${{ env.branch }}
    - name: Clone project frameworks/compile/mclinker
      if: steps.frameworks_compile_mclinker.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform frameworks/compile/mclinker
    - name: Restore Cache external/llvm
      id: external_llvm
      uses: actions/cache@v3
      with:
        path: aosp/external/llvm
        key: external_llvm@${{ env.branch }}
        restore-keys: external_llvm@${{ env.branch }}
    - name: Clone project external/llvm
      if: steps.external_llvm.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/llvm
    - name: Restore Cache external/dng_sdk
      id: external_dng_sdk
      uses: actions/cache@v3
      with:
        path: aosp/external/dng_sdk
        key: external_dng_sdk@${{ env.branch }}
        restore-keys: external_dng_sdk@${{ env.branch }}
    - name: Clone project external/dng_sdk
      if: steps.external_dng_sdk.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/dng_sdk
    - name: Restore Cache external/iputils
      id: external_iputils
      uses: actions/cache@v3
      with:
        path: aosp/external/iputils
        key: external_iputils@${{ env.branch }}
        restore-keys: external_iputils@${{ env.branch }}
    - name: Clone project external/iputils
      if: steps.external_iputils.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/iputils
    - name: Restore Cache external/protobuf
      id: external_protobuf
      uses: actions/cache@v3
      with:
        path: aosp/external/protobuf
        key: external_protobuf@${{ env.branch }}
        restore-keys: external_protobuf@${{ env.branch }}
    - name: Clone project external/protobuf
      if: steps.external_protobuf.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/protobuf
    - name: Restore Cache external/rust/crates/futures-util
      id: external_rust_crates_futures-util
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/futures-util
        key: external_rust_crates_futures-util@${{ env.branch }}
        restore-keys: external_rust_crates_futures-util@${{ env.branch }}
    - name: Clone project external/rust/crates/futures-util
      if: steps.external_rust_crates_futures-util.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/futures-util
    - name: Restore Cache external/tensorflow
      id: external_tensorflow
      uses: actions/cache@v3
      with:
        path: aosp/external/tensorflow
        key: external_tensorflow@${{ env.branch }}
        restore-keys: external_tensorflow@${{ env.branch }}
    - name: Clone project external/tensorflow
      if: steps.external_tensorflow.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/tensorflow
    - name: Restore Cache external/flatbuffers
      id: external_flatbuffers
      uses: actions/cache@v3
      with:
        path: aosp/external/flatbuffers
        key: external_flatbuffers@${{ env.branch }}
        restore-keys: external_flatbuffers@${{ env.branch }}
    - name: Clone project external/flatbuffers
      if: steps.external_flatbuffers.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/flatbuffers
    - name: Restore Cache external/gemmlowp
      id: external_gemmlowp
      uses: actions/cache@v3
      with:
        path: aosp/external/gemmlowp
        key: external_gemmlowp@${{ env.branch }}
        restore-keys: external_gemmlowp@${{ env.branch }}
    - name: Clone project external/gemmlowp
      if: steps.external_gemmlowp.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/gemmlowp
    - name: Restore Cache external/eigen
      id: external_eigen
      uses: actions/cache@v3
      with:
        path: aosp/external/eigen
        key: external_eigen@${{ env.branch }}
        restore-keys: external_eigen@${{ env.branch }}
    - name: Clone project external/eigen
      if: steps.external_eigen.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/eigen
    - name: Restore Cache hardware/ril
      id: hardware_ril
      uses: actions/cache@v3
      with:
        path: aosp/hardware/ril
        key: hardware_ril@${{ env.branch }}
        restore-keys: hardware_ril@${{ env.branch }}
    - name: Clone project hardware/ril
      if: steps.hardware_ril.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform hardware/ril
    - name: Restore Cache system/memory/libion
      id: system_memory_libion
      uses: actions/cache@v3
      with:
        path: aosp/system/memory/libion
        key: system_memory_libion@${{ env.branch }}
        restore-keys: system_memory_libion@${{ env.branch }}
    - name: Clone project system/memory/libion
      if: steps.system_memory_libion.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/memory/libion
    - name: Restore Cache external/aac
      id: external_aac
      uses: actions/cache@v3
      with:
        path: aosp/external/aac
        key: external_aac@${{ env.branch }}
        restore-keys: external_aac@${{ env.branch }}
    - name: Clone project external/aac
      if: steps.external_aac.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/aac
    - name: Restore Cache external/conscrypt
      id: external_conscrypt
      uses: actions/cache@v3
      with:
        path: aosp/external/conscrypt
        key: external_conscrypt@${{ env.branch }}
        restore-keys: external_conscrypt@${{ env.branch }}
    - name: Clone project external/conscrypt
      if: steps.external_conscrypt.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/conscrypt
    - name: Restore Cache libnativehelper
      id: libnativehelper
      uses: actions/cache@v3
      with:
        path: aosp/libnativehelper
        key: libnativehelper@${{ env.branch }}
        restore-keys: libnativehelper@${{ env.branch }}
    - name: Clone project libnativehelper
      if: steps.libnativehelper.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform libnativehelper
    - name: Restore Cache external/curl
      id: external_curl
      uses: actions/cache@v3
      with:
        path: aosp/external/curl
        key: external_curl@${{ env.branch }}
        restore-keys: external_curl@${{ env.branch }}
    - name: Clone project external/curl
      if: steps.external_curl.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/curl
    - name: Restore Cache external/freetype
      id: external_freetype
      uses: actions/cache@v3
      with:
        path: aosp/external/freetype
        key: external_freetype@${{ env.branch }}
        restore-keys: external_freetype@${{ env.branch }}
    - name: Clone project external/freetype
      if: steps.external_freetype.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/freetype
    - name: Restore Cache external/fsverity-utils
      id: external_fsverity-utils
      uses: actions/cache@v3
      with:
        path: aosp/external/fsverity-utils
        key: external_fsverity-utils@${{ env.branch }}
        restore-keys: external_fsverity-utils@${{ env.branch }}
    - name: Clone project external/fsverity-utils
      if: steps.external_fsverity-utils.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/fsverity-utils
    - name: Restore Cache external/gptfdisk
      id: external_gptfdisk
      uses: actions/cache@v3
      with:
        path: aosp/external/gptfdisk
        key: external_gptfdisk@${{ env.branch }}
        restore-keys: external_gptfdisk@${{ env.branch }}
    - name: Clone project external/gptfdisk
      if: steps.external_gptfdisk.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/gptfdisk
    - name: Restore Cache external/grpc-grpc
      id: external_grpc-grpc
      uses: actions/cache@v3
      with:
        path: aosp/external/grpc-grpc
        key: external_grpc-grpc@${{ env.branch }}
        restore-keys: external_grpc-grpc@${{ env.branch }}
    - name: Clone project external/grpc-grpc
      if: steps.external_grpc-grpc.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/grpc-grpc
    - name: Restore Cache external/image_io
      id: external_image_io
      uses: actions/cache@v3
      with:
        path: aosp/external/image_io
        key: external_image_io@${{ env.branch }}
        restore-keys: external_image_io@${{ env.branch }}
    - name: Clone project external/image_io
      if: steps.external_image_io.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/image_io
    - name: Restore Cache external/iw
      id: external_iw
      uses: actions/cache@v3
      with:
        path: aosp/external/iw
        key: external_iw@${{ env.branch }}
        restore-keys: external_iw@${{ env.branch }}
    - name: Clone project external/iw
      if: steps.external_iw.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/iw
    - name: Restore Cache external/libexif
      id: external_libexif
      uses: actions/cache@v3
      with:
        path: aosp/external/libexif
        key: external_libexif@${{ env.branch }}
        restore-keys: external_libexif@${{ env.branch }}
    - name: Clone project external/libexif
      if: steps.external_libexif.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/libexif
    - name: Restore Cache external/minijail
      id: external_minijail
      uses: actions/cache@v3
      with:
        path: aosp/external/minijail
        key: external_minijail@${{ env.branch }}
        restore-keys: external_minijail@${{ env.branch }}
    - name: Clone project external/minijail
      if: steps.external_minijail.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/minijail
    - name: Restore Cache external/rust/crates/android_log-sys
      id: external_rust_crates_android_log-sys
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/android_log-sys
        key: external_rust_crates_android_log-sys@${{ env.branch }}
        restore-keys: external_rust_crates_android_log-sys@${{ env.branch }}
    - name: Clone project external/rust/crates/android_log-sys
      if: steps.external_rust_crates_android_log-sys.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/android_log-sys
    - name: Restore Cache external/rust/crates/anyhow
      id: external_rust_crates_anyhow
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/anyhow
        key: external_rust_crates_anyhow@${{ env.branch }}
        restore-keys: external_rust_crates_anyhow@${{ env.branch }}
    - name: Clone project external/rust/crates/anyhow
      if: steps.external_rust_crates_anyhow.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/anyhow
    - name: Restore Cache external/rust/crates/byteorder
      id: external_rust_crates_byteorder
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/byteorder
        key: external_rust_crates_byteorder@${{ env.branch }}
        restore-keys: external_rust_crates_byteorder@${{ env.branch }}
    - name: Clone project external/rust/crates/byteorder
      if: steps.external_rust_crates_byteorder.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/byteorder
    - name: Restore Cache external/rust/crates/cfg-if
      id: external_rust_crates_cfg-if
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/cfg-if
        key: external_rust_crates_cfg-if@${{ env.branch }}
        restore-keys: external_rust_crates_cfg-if@${{ env.branch }}
    - name: Clone project external/rust/crates/cfg-if
      if: steps.external_rust_crates_cfg-if.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/cfg-if
    - name: Restore Cache external/rust/crates/itoa
      id: external_rust_crates_itoa
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/itoa
        key: external_rust_crates_itoa@${{ env.branch }}
        restore-keys: external_rust_crates_itoa@${{ env.branch }}
    - name: Clone project external/rust/crates/itoa
      if: steps.external_rust_crates_itoa.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/itoa
    - name: Restore Cache external/rust/crates/lazy_static
      id: external_rust_crates_lazy_static
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/lazy_static
        key: external_rust_crates_lazy_static@${{ env.branch }}
        restore-keys: external_rust_crates_lazy_static@${{ env.branch }}
    - name: Clone project external/rust/crates/lazy_static
      if: steps.external_rust_crates_lazy_static.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/lazy_static
    - name: Restore Cache external/rust/crates/libc
      id: external_rust_crates_libc
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/libc
        key: external_rust_crates_libc@${{ env.branch }}
        restore-keys: external_rust_crates_libc@${{ env.branch }}
    - name: Clone project external/rust/crates/libc
      if: steps.external_rust_crates_libc.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/libc
    - name: Restore Cache external/rust/crates/num-traits
      id: external_rust_crates_num-traits
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/num-traits
        key: external_rust_crates_num-traits@${{ env.branch }}
        restore-keys: external_rust_crates_num-traits@${{ env.branch }}
    - name: Clone project external/rust/crates/num-traits
      if: steps.external_rust_crates_num-traits.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/num-traits
    - name: Restore Cache external/rust/crates/ppv-lite86
      id: external_rust_crates_ppv-lite86
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/ppv-lite86
        key: external_rust_crates_ppv-lite86@${{ env.branch }}
        restore-keys: external_rust_crates_ppv-lite86@${{ env.branch }}
    - name: Clone project external/rust/crates/ppv-lite86
      if: steps.external_rust_crates_ppv-lite86.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/ppv-lite86
    - name: Restore Cache external/rust/crates/ryu
      id: external_rust_crates_ryu
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/ryu
        key: external_rust_crates_ryu@${{ env.branch }}
        restore-keys: external_rust_crates_ryu@${{ env.branch }}
    - name: Clone project external/rust/crates/ryu
      if: steps.external_rust_crates_ryu.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/ryu
    - name: Restore Cache external/rust/crates/serde
      id: external_rust_crates_serde
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/serde
        key: external_rust_crates_serde@${{ env.branch }}
        restore-keys: external_rust_crates_serde@${{ env.branch }}
    - name: Clone project external/rust/crates/serde
      if: steps.external_rust_crates_serde.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/serde
    - name: Restore Cache external/rust/crates/thiserror
      id: external_rust_crates_thiserror
      uses: actions/cache@v3
      with:
        path: aosp/external/rust/crates/thiserror
        key: external_rust_crates_thiserror@${{ env.branch }}
        restore-keys: external_rust_crates_thiserror@${{ env.branch }}
    - name: Clone project external/rust/crates/thiserror
      if: steps.external_rust_crates_thiserror.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/rust/crates/thiserror
    - name: Restore Cache external/scrypt
      id: external_scrypt
      uses: actions/cache@v3
      with:
        path: aosp/external/scrypt
        key: external_scrypt@${{ env.branch }}
        restore-keys: external_scrypt@${{ env.branch }}
    - name: Clone project external/scrypt
      if: steps.external_scrypt.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/scrypt
    - name: Restore Cache external/sonivox
      id: external_sonivox
      uses: actions/cache@v3
      with:
        path: aosp/external/sonivox
        key: external_sonivox@${{ env.branch }}
        restore-keys: external_sonivox@${{ env.branch }}
    - name: Clone project external/sonivox
      if: steps.external_sonivox.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/sonivox
    - name: Restore Cache external/tcpdump
      id: external_tcpdump
      uses: actions/cache@v3
      with:
        path: aosp/external/tcpdump
        key: external_tcpdump@${{ env.branch }}
        restore-keys: external_tcpdump@${{ env.branch }}
    - name: Clone project external/tcpdump
      if: steps.external_tcpdump.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/tcpdump
    - name: Restore Cache external/tinyxml2
      id: external_tinyxml2
      uses: actions/cache@v3
      with:
        path: aosp/external/tinyxml2
        key: external_tinyxml2@${{ env.branch }}
        restore-keys: external_tinyxml2@${{ env.branch }}
    - name: Clone project external/tinyxml2
      if: steps.external_tinyxml2.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/tinyxml2
    - name: Restore Cache external/tremolo
      id: external_tremolo
      uses: actions/cache@v3
      with:
        path: aosp/external/tremolo
        key: external_tremolo@${{ env.branch }}
        restore-keys: external_tremolo@${{ env.branch }}
    - name: Clone project external/tremolo
      if: steps.external_tremolo.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/tremolo
    - name: Restore Cache external/avb
      id: external_avb
      uses: actions/cache@v3
      with:
        path: aosp/external/avb
        key: external_avb@${{ env.branch }}
        restore-keys: external_avb@${{ env.branch }}
    - name: Clone project external/avb
      if: steps.external_avb.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/avb
    - name: Restore Cache external/cblas
      id: external_cblas
      uses: actions/cache@v3
      with:
        path: aosp/external/cblas
        key: external_cblas@${{ env.branch }}
        restore-keys: external_cblas@${{ env.branch }}
    - name: Clone project external/cblas
      if: steps.external_cblas.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/cblas
    - name: Restore Cache external/libcups
      id: external_libcups
      uses: actions/cache@v3
      with:
        path: aosp/external/libcups
        key: external_libcups@${{ env.branch }}
        restore-keys: external_libcups@${{ env.branch }}
    - name: Clone project external/libcups
      if: steps.external_libcups.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/libcups
    - name: Restore Cache frameworks/libs/net
      id: frameworks_libs_net
      uses: actions/cache@v3
      with:
        path: aosp/frameworks/libs/net
        key: frameworks_libs_net@${{ env.branch }}
        restore-keys: frameworks_libs_net@${{ env.branch }}
    - name: Clone project frameworks/libs/net
      if: steps.frameworks_libs_net.outputs.cache-hit != 'true'
      run: |
        pushd aosp
        source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform frameworks/libs/net

    - name: Download Release
      run: |
        source $GITHUB_WORKSPACE/envsetup.sh
        download_release bionic-0 bionic build_step1
        download_release external_scudo-0 external/scudo build_step0
        download_release external_arm-optimized-routines-0 external/arm-optimized-routines build_step0
        download_release external_libcxx-0 external/libcxx build_step3
        download_release external_libcxxabi-0 external/libcxxabi build_step2
        download_release external_libjpeg-turbo-0 external/libjpeg-turbo build_step4
        download_release external_llvm-0 external/llvm build_step4
        download_release external_zlib-0 external/zlib build_step2
        download_release external_boringssl-0 external/boringssl build_step4
        download_release system_logging-0 system/logging build_step4
        download_release external_rust_crates_futures-channel-0 external/rust/crates/futures-channel build_step1
        download_release external_rust_crates_futures-core-0 external/rust/crates/futures-core build_step0
        download_release external_rust_crates_futures-io-0 external/rust/crates/futures-io build_step0
        download_release external_rust_crates_futures-macro-0 external/rust/crates/futures-macro build_step4
        download_release external_rust_crates_futures-sink-0 external/rust/crates/futures-sink build_step0
        download_release external_rust_crates_futures-task-0 external/rust/crates/futures-task build_step0
        download_release external_rust_crates_memchr-0 external/rust/crates/memchr build_step0
        download_release external_rust_crates_pin-project-lite-0 external/rust/crates/pin-project-lite build_step0
        download_release external_rust_crates_pin-utils-0 external/rust/crates/pin-utils build_step0
        download_release external_rust_crates_proc-macro-hack-0 external/rust/crates/proc-macro-hack build_step0
        download_release external_rust_crates_proc-macro-nested-0 external/rust/crates/proc-macro-nested build_step0
        download_release external_rust_crates_slab-0 external/rust/crates/slab build_step0
        download_release external_ruy-0 external/ruy build_step4
        download_release external_libtextclassifier-0 external/libtextclassifier build_step4
        download_release external_nanopb-c-0 external/nanopb-c build_step4
        download_release external_libpng-0 external/libpng build_step4
        download_release external_e2fsprogs-0 external/e2fsprogs build_step4
        download_release external_modp_b64-0 external/modp_b64 build_step4
        download_release external_libnl-0 external/libnl build_step4
        download_release external_libcap-0 external/libcap build_step4
        download_release external_rust_crates_serde_derive-0 external/rust/crates/serde_derive build_step4
        download_release external_rust_crates_thiserror-impl-0 external/rust/crates/thiserror-impl build_step4
        download_release external_libpcap-0 external/libpcap build_step4
        download_release external_fmtlib-0 external/fmtlib build_step4
        download_release external_eigen-0 external/eigen build_step4
        download_release external_rust_crates_proc-macro2-0 external/rust/crates/proc-macro2 build_step1
        download_release external_rust_crates_unicode-xid-0 external/rust/crates/unicode-xid build_step0
        download_release external_rust_crates_quote-0 external/rust/crates/quote build_step2
        download_release external_rust_crates_syn-0 external/rust/crates/syn build_step3

    - name: Build Step-5
      run: |
        pushd aosp
        export TOP=$(pwd)
        $GITHUB_WORKSPACE/steps/build_step5.sh
        df -h

    - uses: ncipollo/release-action@main
      with:
        name: 'build_step5'
        artifacts: "aosp/external_libyuv-0.tar.xz,aosp/frameworks_compile_mclinker-0.tar.xz,aosp/external_dng_sdk-0.tar.xz,aosp/external_iputils-0.tar.xz,aosp/external_protobuf-0.tar.xz,aosp/external_rust_crates_futures-util-0.tar.xz,aosp/external_tensorflow-0.tar.xz,aosp/hardware_ril-0.tar.xz,aosp/system_memory_libion-0.tar.xz,aosp/external_aac-0.tar.xz,aosp/external_compiler-rt-0.tar.xz,aosp/external_conscrypt-0.tar.xz,aosp/external_curl-0.tar.xz,aosp/external_freetype-0.tar.xz,aosp/external_fsverity-utils-0.tar.xz,aosp/external_gptfdisk-0.tar.xz,aosp/external_grpc-grpc-0.tar.xz,aosp/external_image_io-0.tar.xz,aosp/external_iw-0.tar.xz,aosp/external_libexif-0.tar.xz,aosp/external_minijail-0.tar.xz,aosp/external_rust_crates_android_log-sys-0.tar.xz,aosp/external_rust_crates_anyhow-0.tar.xz,aosp/external_rust_crates_byteorder-0.tar.xz,aosp/external_rust_crates_cfg-if-0.tar.xz,aosp/external_rust_crates_itoa-0.tar.xz,aosp/external_rust_crates_lazy_static-0.tar.xz,aosp/external_rust_crates_libc-0.tar.xz,aosp/external_rust_crates_num-traits-0.tar.xz,aosp/external_rust_crates_ppv-lite86-0.tar.xz,aosp/external_rust_crates_ryu-0.tar.xz,aosp/external_rust_crates_serde-0.tar.xz,aosp/external_rust_crates_thiserror-0.tar.xz,aosp/external_scrypt-0.tar.xz,aosp/external_sonivox-0.tar.xz,aosp/external_tcpdump-0.tar.xz,aosp/external_tinyxml2-0.tar.xz,aosp/external_tremolo-0.tar.xz,aosp/libnativehelper-0.tar.xz,aosp/system_libbase-0.tar.xz,aosp/external_avb-0.tar.xz,aosp/external_cblas-0.tar.xz,aosp/external_libcups-0.tar.xz,aosp/frameworks_libs_net-0.tar.xz"
        removeArtifacts: true
        allowUpdates: true
