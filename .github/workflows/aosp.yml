
name: AOSP Build
on:
  push:
    branches:
    - main
env:
  branch: 'android-12.0.0_r1'
jobs:
  build_step7:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Download get_clang_version.py
      run: |
        curl 'https://android.googlesource.com/platform/build/soong/+/refs/heads/master/scripts/get_clang_version.py?format=TEXT' | base64 -d > $GITHUB_WORKSPACE/get_clang_version.py
        mkdir -p aosp

    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: aosp/build/make
        key: build_make@${{ env.branch }}
        restore-keys: build_make@${{ env.branch }}
    - name: Clone project build/make
      if: steps.build_make.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform build
        mv build make && mkdir build && mv make build/
        sed -i 's/^PRODUCT_EXTRA_VNDK_VERSIONS/#PRODUCT_EXTRA_VNDK_VERSIONS/g' build/make/target/product/gsi_release.mk

    - name: Restore Cache art
      id: art
      uses: actions/cache@v3
      with:
        path: aosp/art
        key: art@${{ env.branch }}
        restore-keys: art@${{ env.branch }}
    - name: Clone project art
      if: steps.art.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform art

    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: aosp/bionic
        key: bionic@${{ env.branch }}
        restore-keys: bionic@${{ env.branch }}
    - name: Clone project bionic
      if: steps.bionic.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform bionic

    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: aosp/build/blueprint
        key: build_blueprint@${{ env.branch }}
        restore-keys: build_blueprint@${{ env.branch }}
    - name: Clone project build/blueprint
      if: steps.build_blueprint.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform build/blueprint

    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: aosp/build/soong
        key: build_soong@${{ env.branch }}
        restore-keys: build_soong@${{ env.branch }}
    - name: Clone project build/soong
      if: steps.build_soong.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform build/soong

    - name: Restore Cache device/google/cuttlefish
      id: device_google_cuttlefish
      uses: actions/cache@v3
      with:
        path: aosp/device/google/cuttlefish
        key: device_google_cuttlefish@${{ env.branch }}
        restore-keys: device_google_cuttlefish@${{ env.branch }}
    - name: Clone project device/google/cuttlefish
      if: steps.device_google_cuttlefish.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth device/google/cuttlefish

    - name: Restore Cache external/e2fsprogs
      id: external_e2fsprogs
      uses: actions/cache@v3
      with:
        path: aosp/external/e2fsprogs
        key: external_e2fsprogs@${{ env.branch }}
        restore-keys: external_e2fsprogs@${{ env.branch }}
    - name: Clone project external/e2fsprogs
      if: steps.external_e2fsprogs.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/e2fsprogs

    - name: Restore Cache external/eigen
      id: external_eigen
      uses: actions/cache@v3
      with:
        path: aosp/external/eigen
        key: external_eigen@${{ env.branch }}
        restore-keys: external_eigen@${{ env.branch }}
    - name: Clone project external/eigen
      if: steps.external_eigen.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/eigen

    - name: Restore Cache external/gflags
      id: external_gflags
      uses: actions/cache@v3
      with:
        path: aosp/external/gflags
        key: external_gflags@${{ env.branch }}
        restore-keys: external_gflags@${{ env.branch }}
    - name: Clone project external/gflags
      if: steps.external_gflags.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/gflags

    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: aosp/external/golang-protobuf
        key: external_golang-protobuf@${{ env.branch }}
        restore-keys: external_golang-protobuf@${{ env.branch }}
    - name: Clone project external/golang-protobuf
      if: steps.external_golang-protobuf.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/golang-protobuf

    - name: Restore Cache external/googletest
      id: external_googletest
      uses: actions/cache@v3
      with:
        path: aosp/external/googletest
        key: external_googletest@${{ env.branch }}
        restore-keys: external_googletest@${{ env.branch }}
    - name: Clone project external/googletest
      if: steps.external_googletest.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/googletest

    - name: Restore Cache external/jsoncpp
      id: external_jsoncpp
      uses: actions/cache@v3
      with:
        path: aosp/external/jsoncpp
        key: external_jsoncpp@${{ env.branch }}
        restore-keys: external_jsoncpp@${{ env.branch }}
    - name: Clone project external/jsoncpp
      if: steps.external_jsoncpp.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/jsoncpp

    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: aosp/external/libcxx
        key: external_libcxx@${{ env.branch }}
        restore-keys: external_libcxx@${{ env.branch }}
    - name: Clone project external/libcxx
      if: steps.external_libcxx.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/libcxx

    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: aosp/external/libcxxabi
        key: external_libcxxabi@${{ env.branch }}
        restore-keys: external_libcxxabi@${{ env.branch }}
    - name: Clone project external/libcxxabi
      if: steps.external_libcxxabi.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/libcxxabi

    - name: Restore Cache external/perfetto
      id: external_perfetto
      uses: actions/cache@v3
      with:
        path: aosp/external/perfetto
        key: external_perfetto@${{ env.branch }}
        restore-keys: external_perfetto@${{ env.branch }}
    - name: Clone project external/perfetto
      if: steps.external_perfetto.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/perfetto

    - name: Restore Cache external/protobuf
      id: external_protobuf
      uses: actions/cache@v3
      with:
        path: aosp/external/protobuf
        key: external_protobuf@${{ env.branch }}
        restore-keys: external_protobuf@${{ env.branch }}
    - name: Clone project external/protobuf
      if: steps.external_protobuf.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/protobuf

    - name: Restore Cache external/skia
      id: external_skia
      uses: actions/cache@v3
      with:
        path: aosp/external/skia
        key: external_skia@${{ env.branch }}
        restore-keys: external_skia@${{ env.branch }}
    - name: Clone project external/skia
      if: steps.external_skia.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/skia

    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: aosp/external/starlark-go
        key: external_starlark-go@${{ env.branch }}
        restore-keys: external_starlark-go@${{ env.branch }}
    - name: Clone project external/starlark-go
      if: steps.external_starlark-go.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/starlark-go

    - name: Restore Cache external/webrtc
      id: external_webrtc
      uses: actions/cache@v3
      with:
        path: aosp/external/webrtc
        key: external_webrtc@${{ env.branch }}
        restore-keys: external_webrtc@${{ env.branch }}
    - name: Clone project external/webrtc
      if: steps.external_webrtc.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/webrtc

    - name: Restore Cache external/zlib
      id: external_zlib
      uses: actions/cache@v3
      with:
        path: aosp/external/zlib
        key: external_zlib@${{ env.branch }}
        restore-keys: external_zlib@${{ env.branch }}
    - name: Clone project external/zlib
      if: steps.external_zlib.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform external/zlib

    - name: Restore Cache frameworks/av
      id: frameworks_av
      uses: actions/cache@v3
      with:
        path: aosp/frameworks/av
        key: frameworks_av@${{ env.branch }}
        restore-keys: frameworks_av@${{ env.branch }}
    - name: Clone project frameworks/av
      if: steps.frameworks_av.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform frameworks/av

    - name: Restore Cache frameworks/base
      id: frameworks_base
      uses: actions/cache@v3
      with:
        path: aosp/frameworks/base
        key: frameworks_base@${{ env.branch }}
        restore-keys: frameworks_base@${{ env.branch }}
    - name: Clone project frameworks/base
      if: steps.frameworks_base.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_sparse_exclude frameworks/base "!/data/videos" "!/media/tests/contents" "!/docs" "!/native/graphics/jni/fuzz" "!/cmd/incidentd/testdata"

    - name: Restore Cache frameworks/native
      id: frameworks_native
      uses: actions/cache@v3
      with:
        path: aosp/frameworks/native
        key: frameworks_native@${{ env.branch }}
        restore-keys: frameworks_native@${{ env.branch }}
    - name: Clone project frameworks/native
      if: steps.frameworks_native.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform frameworks/native

    - name: Restore Cache frameworks/proto_logging
      id: frameworks_proto_logging
      uses: actions/cache@v3
      with:
        path: aosp/frameworks/proto_logging
        key: frameworks_proto_logging@${{ env.branch }}
        restore-keys: frameworks_proto_logging@${{ env.branch }}
    - name: Clone project frameworks/proto_logging
      if: steps.frameworks_proto_logging.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform frameworks/proto_logging

    - name: Restore Cache hardware/libhardware
      id: hardware_libhardware
      uses: actions/cache@v3
      with:
        path: aosp/hardware/libhardware
        key: hardware_libhardware@${{ env.branch }}
        restore-keys: hardware_libhardware@${{ env.branch }}
    - name: Clone project hardware/libhardware
      if: steps.hardware_libhardware.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform hardware/libhardware

    - name: Restore Cache packages/modules/DnsResolver
      id: packages_modules_DnsResolver
      uses: actions/cache@v3
      with:
        path: aosp/packages/modules/DnsResolver
        key: packages_modules_DnsResolver@${{ env.branch }}
        restore-keys: packages_modules_DnsResolver@${{ env.branch }}
    - name: Clone project packages/modules/DnsResolver
      if: steps.packages_modules_DnsResolver.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform packages/modules/DnsResolver

    - name: Restore Cache packages/modules/Permission
      id: packages_modules_Permission
      uses: actions/cache@v3
      with:
        path: aosp/packages/modules/Permission
        key: packages_modules_Permission@${{ env.branch }}
        restore-keys: packages_modules_Permission@${{ env.branch }}
    - name: Clone project packages/modules/Permission
      if: steps.packages_modules_Permission.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform packages/modules/Permission

    - name: Restore Cache packages/modules/StatsD
      id: packages_modules_StatsD
      uses: actions/cache@v3
      with:
        path: aosp/packages/modules/StatsD
        key: packages_modules_StatsD@${{ env.branch }}
        restore-keys: packages_modules_StatsD@${{ env.branch }}
    - name: Clone project packages/modules/StatsD
      if: steps.packages_modules_StatsD.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform packages/modules/StatsD

    - name: Restore Cache packages/modules/adb
      id: packages_modules_adb
      uses: actions/cache@v3
      with:
        path: aosp/packages/modules/adb
        key: packages_modules_adb@${{ env.branch }}
        restore-keys: packages_modules_adb@${{ env.branch }}
    - name: Clone project packages/modules/adb
      if: steps.packages_modules_adb.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform packages/modules/adb

    - name: Restore Cache packages/modules/common
      id: packages_modules_common
      uses: actions/cache@v3
      with:
        path: aosp/packages/modules/common
        key: packages_modules_common@${{ env.branch }}
        restore-keys: packages_modules_common@${{ env.branch }}
    - name: Clone project packages/modules/common
      if: steps.packages_modules_common.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform packages/modules/common

    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: aosp/prebuilts/build-tools
        key: prebuilts_build-tools@${{ env.branch }}
        restore-keys: prebuilts_build-tools@${{ env.branch }}
    - name: Clone project prebuilts/build-tools
      if: steps.prebuilts_build-tools.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_sparse prebuilts/build-tools linux-x86/bin linux-x86/lib64 path common

    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: aosp/prebuilts/clang-tools
        key: prebuilts_clang-tools@${{ env.branch }}
        restore-keys: prebuilts_clang-tools@${{ env.branch }}
    - name: Clone project prebuilts/clang-tools
      if: steps.prebuilts_clang-tools.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_sparse prebuilts/clang-tools linux-x86/bin linux-x86/lib64/clang

    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: aosp/prebuilts/clang/host/linux-x86
        key: prebuilts_clang_host_linux-x86@${{ env.branch }}
        restore-keys: prebuilts_clang_host_linux-x86@${{ env.branch }}
    - name: Clone project prebuilts/clang/host/linux-x86
      if: steps.prebuilts_clang_host_linux-x86.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_sparse prebuilts/clang/host/linux-x86 $(python ${GITHUB_WORKSPACE}/get_clang_version.py) clang-r416183b soong

    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
        key: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@${{ env.branch }}
        restore-keys: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@${{ env.branch }}
    - name: Clone project prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      if: steps.prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_sparse prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8 sysroot lib/gcc/x86_64-linux/4.8.3 x86_64-linux/lib64 x86_64-linux/lib32

    - name: Restore Cache prebuilts/misc
      id: prebuilts_misc
      uses: actions/cache@v3
      with:
        path: aosp/prebuilts/misc
        key: prebuilts_misc@${{ env.branch }}
        restore-keys: prebuilts_misc@${{ env.branch }}
    - name: Clone project prebuilts/misc
      if: steps.prebuilts_misc.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_sparse_exclude prebuilts/misc "!/common/robolectric" "!/darwin-x86" "!/darwin-x86_64" "!/gdbserver"

    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: aosp/prebuilts/ndk
        key: prebuilts_ndk@${{ env.branch }}
        restore-keys: prebuilts_ndk@${{ env.branch }}
    - name: Clone project prebuilts/ndk
      if: steps.prebuilts_ndk.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_sparse prebuilts/ndk current

    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: aosp/prebuilts/rust
        key: prebuilts_rust@${{ env.branch }}
        restore-keys: prebuilts_rust@${{ env.branch }}
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_sparse prebuilts/rust bootstrap linux-x86/1.51.0

    - name: Restore Cache system/apex
      id: system_apex
      uses: actions/cache@v3
      with:
        path: aosp/system/apex
        key: system_apex@${{ env.branch }}
        restore-keys: system_apex@${{ env.branch }}
    - name: Clone project system/apex
      if: steps.system_apex.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/apex

    - name: Restore Cache system/bt
      id: system_bt
      uses: actions/cache@v3
      with:
        path: aosp/system/bt
        key: system_bt@${{ env.branch }}
        restore-keys: system_bt@${{ env.branch }}
    - name: Clone project system/bt
      if: steps.system_bt.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/bt

    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: aosp/system/core
        key: system_core@${{ env.branch }}
        restore-keys: system_core@${{ env.branch }}
    - name: Clone project system/core
      if: steps.system_core.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/core

    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: aosp/system/libbase
        key: system_libbase@${{ env.branch }}
        restore-keys: system_libbase@${{ env.branch }}
    - name: Clone project system/libbase
      if: steps.system_libbase.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/libbase

    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: aosp/system/logging
        key: system_logging@${{ env.branch }}
        restore-keys: system_logging@${{ env.branch }}
    - name: Clone project system/logging
      if: steps.system_logging.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/logging

    - name: Restore Cache system/media
      id: system_media
      uses: actions/cache@v3
      with:
        path: aosp/system/media
        key: system_media@${{ env.branch }}
        restore-keys: system_media@${{ env.branch }}
    - name: Clone project system/media
      if: steps.system_media.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/media

    - name: Restore Cache system/netd
      id: system_netd
      uses: actions/cache@v3
      with:
        path: aosp/system/netd
        key: system_netd@${{ env.branch }}
        restore-keys: system_netd@${{ env.branch }}
    - name: Clone project system/netd
      if: steps.system_netd.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/netd

    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: aosp/system/sepolicy
        key: system_sepolicy@${{ env.branch }}
        restore-keys: system_sepolicy@${{ env.branch }}
    - name: Clone project system/sepolicy
      if: steps.system_sepolicy.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/sepolicy

    - name: Restore Cache system/tools/aidl
      id: system_tools_aidl
      uses: actions/cache@v3
      with:
        path: aosp/system/tools/aidl
        key: system_tools_aidl@${{ env.branch }}
        restore-keys: system_tools_aidl@${{ env.branch }}
    - name: Clone project system/tools/aidl
      if: steps.system_tools_aidl.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/tools/aidl

    - name: Restore Cache system/tools/hidl
      id: system_tools_hidl
      uses: actions/cache@v3
      with:
        path: aosp/system/tools/hidl
        key: system_tools_hidl@${{ env.branch }}
        restore-keys: system_tools_hidl@${{ env.branch }}
    - name: Clone project system/tools/hidl
      if: steps.system_tools_hidl.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/tools/hidl

    - name: Restore Cache system/unwinding
      id: system_unwinding
      uses: actions/cache@v3
      with:
        path: aosp/system/unwinding
        key: system_unwinding@${{ env.branch }}
        restore-keys: system_unwinding@${{ env.branch }}
    - name: Clone project system/unwinding
      if: steps.system_unwinding.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        clone_depth_platform system/unwinding

    - name: Restore Cache art-6.tar.xz
      id: art-6
      uses: actions/cache@v3
      with:
        path: aosp/art-6.tar.xz
        key: art-6
        restore-keys: art-6
    - name: Clone project art-6.tar.xz
      if: steps.art-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release art-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache bionic-6.tar.xz
      id: bionic-6
      uses: actions/cache@v3
      with:
        path: aosp/bionic-6.tar.xz
        key: bionic-6
        restore-keys: bionic-6
    - name: Clone project bionic-6.tar.xz
      if: steps.bionic-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release bionic-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache build_soong-6.tar.xz
      id: build_soong-6
      uses: actions/cache@v3
      with:
        path: aosp/build_soong-6.tar.xz
        key: build_soong-6
        restore-keys: build_soong-6
    - name: Clone project build_soong-6.tar.xz
      if: steps.build_soong-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release build_soong-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache device_google_cuttlefish-6.tar.xz
      id: device_google_cuttlefish-6
      uses: actions/cache@v3
      with:
        path: aosp/device_google_cuttlefish-6.tar.xz
        key: device_google_cuttlefish-6
        restore-keys: device_google_cuttlefish-6
    - name: Clone project device_google_cuttlefish-6.tar.xz
      if: steps.device_google_cuttlefish-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release device_google_cuttlefish-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache external_arm-optimized-routines-0.tar.xz
      id: external_arm-optimized-routines-0
      uses: actions/cache@v3
      with:
        path: aosp/external_arm-optimized-routines-0.tar.xz
        key: external_arm-optimized-routines-0
        restore-keys: external_arm-optimized-routines-0
    - name: Clone project external_arm-optimized-routines-0.tar.xz
      if: steps.external_arm-optimized-routines-0.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_arm-optimized-routines-0.tar.xz android-12.0.0_r1-0

    - name: Restore Cache external_boringssl-4.tar.xz
      id: external_boringssl-4
      uses: actions/cache@v3
      with:
        path: aosp/external_boringssl-4.tar.xz
        key: external_boringssl-4
        restore-keys: external_boringssl-4
    - name: Clone project external_boringssl-4.tar.xz
      if: steps.external_boringssl-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_boringssl-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_e2fsprogs-4.tar.xz
      id: external_e2fsprogs-4
      uses: actions/cache@v3
      with:
        path: aosp/external_e2fsprogs-4.tar.xz
        key: external_e2fsprogs-4
        restore-keys: external_e2fsprogs-4
    - name: Clone project external_e2fsprogs-4.tar.xz
      if: steps.external_e2fsprogs-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_e2fsprogs-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_fmtlib-4.tar.xz
      id: external_fmtlib-4
      uses: actions/cache@v3
      with:
        path: aosp/external_fmtlib-4.tar.xz
        key: external_fmtlib-4
        restore-keys: external_fmtlib-4
    - name: Clone project external_fmtlib-4.tar.xz
      if: steps.external_fmtlib-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_fmtlib-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_gflags-4.tar.xz
      id: external_gflags-4
      uses: actions/cache@v3
      with:
        path: aosp/external_gflags-4.tar.xz
        key: external_gflags-4
        restore-keys: external_gflags-4
    - name: Clone project external_gflags-4.tar.xz
      if: steps.external_gflags-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_gflags-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_gwp_asan-4.tar.xz
      id: external_gwp_asan-4
      uses: actions/cache@v3
      with:
        path: aosp/external_gwp_asan-4.tar.xz
        key: external_gwp_asan-4
        restore-keys: external_gwp_asan-4
    - name: Clone project external_gwp_asan-4.tar.xz
      if: steps.external_gwp_asan-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_gwp_asan-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_jsoncpp-4.tar.xz
      id: external_jsoncpp-4
      uses: actions/cache@v3
      with:
        path: aosp/external_jsoncpp-4.tar.xz
        key: external_jsoncpp-4
        restore-keys: external_jsoncpp-4
    - name: Clone project external_jsoncpp-4.tar.xz
      if: steps.external_jsoncpp-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_jsoncpp-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_libcxx-3.tar.xz
      id: external_libcxx-3
      uses: actions/cache@v3
      with:
        path: aosp/external_libcxx-3.tar.xz
        key: external_libcxx-3
        restore-keys: external_libcxx-3
    - name: Clone project external_libcxx-3.tar.xz
      if: steps.external_libcxx-3.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_libcxx-3.tar.xz android-12.0.0_r1-3

    - name: Restore Cache external_libcxxabi-2.tar.xz
      id: external_libcxxabi-2
      uses: actions/cache@v3
      with:
        path: aosp/external_libcxxabi-2.tar.xz
        key: external_libcxxabi-2
        restore-keys: external_libcxxabi-2
    - name: Clone project external_libcxxabi-2.tar.xz
      if: steps.external_libcxxabi-2.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_libcxxabi-2.tar.xz android-12.0.0_r1-2

    - name: Restore Cache external_libevent-4.tar.xz
      id: external_libevent-4
      uses: actions/cache@v3
      with:
        path: aosp/external_libevent-4.tar.xz
        key: external_libevent-4
        restore-keys: external_libevent-4
    - name: Clone project external_libevent-4.tar.xz
      if: steps.external_libevent-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_libevent-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_libopus-4.tar.xz
      id: external_libopus-4
      uses: actions/cache@v3
      with:
        path: aosp/external_libopus-4.tar.xz
        key: external_libopus-4
        restore-keys: external_libopus-4
    - name: Clone project external_libopus-4.tar.xz
      if: steps.external_libopus-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_libopus-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_libvpx-4.tar.xz
      id: external_libvpx-4
      uses: actions/cache@v3
      with:
        path: aosp/external_libvpx-4.tar.xz
        key: external_libvpx-4
        restore-keys: external_libvpx-4
    - name: Clone project external_libvpx-4.tar.xz
      if: steps.external_libvpx-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_libvpx-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_libyuv-5.tar.xz
      id: external_libyuv-5
      uses: actions/cache@v3
      with:
        path: aosp/external_libyuv-5.tar.xz
        key: external_libyuv-5
        restore-keys: external_libyuv-5
    - name: Clone project external_libyuv-5.tar.xz
      if: steps.external_libyuv-5.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_libyuv-5.tar.xz android-12.0.0_r1-5

    - name: Restore Cache external_perfetto-6.tar.xz
      id: external_perfetto-6
      uses: actions/cache@v3
      with:
        path: aosp/external_perfetto-6.tar.xz
        key: external_perfetto-6
        restore-keys: external_perfetto-6
    - name: Clone project external_perfetto-6.tar.xz
      if: steps.external_perfetto-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_perfetto-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache external_pffft-4.tar.xz
      id: external_pffft-4
      uses: actions/cache@v3
      with:
        path: aosp/external_pffft-4.tar.xz
        key: external_pffft-4
        restore-keys: external_pffft-4
    - name: Clone project external_pffft-4.tar.xz
      if: steps.external_pffft-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_pffft-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_protobuf-5.tar.xz
      id: external_protobuf-5
      uses: actions/cache@v3
      with:
        path: aosp/external_protobuf-5.tar.xz
        key: external_protobuf-5
        restore-keys: external_protobuf-5
    - name: Clone project external_protobuf-5.tar.xz
      if: steps.external_protobuf-5.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_protobuf-5.tar.xz android-12.0.0_r1-5

    - name: Restore Cache external_rnnoise-4.tar.xz
      id: external_rnnoise-4
      uses: actions/cache@v3
      with:
        path: aosp/external_rnnoise-4.tar.xz
        key: external_rnnoise-4
        restore-keys: external_rnnoise-4
    - name: Clone project external_rnnoise-4.tar.xz
      if: steps.external_rnnoise-4.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_rnnoise-4.tar.xz android-12.0.0_r1-4

    - name: Restore Cache external_scudo-0.tar.xz
      id: external_scudo-0
      uses: actions/cache@v3
      with:
        path: aosp/external_scudo-0.tar.xz
        key: external_scudo-0
        restore-keys: external_scudo-0
    - name: Clone project external_scudo-0.tar.xz
      if: steps.external_scudo-0.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_scudo-0.tar.xz android-12.0.0_r1-0

    - name: Restore Cache external_tinyxml2-5.tar.xz
      id: external_tinyxml2-5
      uses: actions/cache@v3
      with:
        path: aosp/external_tinyxml2-5.tar.xz
        key: external_tinyxml2-5
        restore-keys: external_tinyxml2-5
    - name: Clone project external_tinyxml2-5.tar.xz
      if: steps.external_tinyxml2-5.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_tinyxml2-5.tar.xz android-12.0.0_r1-5

    - name: Restore Cache external_webrtc-6.tar.xz
      id: external_webrtc-6
      uses: actions/cache@v3
      with:
        path: aosp/external_webrtc-6.tar.xz
        key: external_webrtc-6
        restore-keys: external_webrtc-6
    - name: Clone project external_webrtc-6.tar.xz
      if: steps.external_webrtc-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_webrtc-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache external_zlib-2.tar.xz
      id: external_zlib-2
      uses: actions/cache@v3
      with:
        path: aosp/external_zlib-2.tar.xz
        key: external_zlib-2
        restore-keys: external_zlib-2
    - name: Clone project external_zlib-2.tar.xz
      if: steps.external_zlib-2.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release external_zlib-2.tar.xz android-12.0.0_r1-2

    - name: Restore Cache frameworks_av-6.tar.xz
      id: frameworks_av-6
      uses: actions/cache@v3
      with:
        path: aosp/frameworks_av-6.tar.xz
        key: frameworks_av-6
        restore-keys: frameworks_av-6
    - name: Clone project frameworks_av-6.tar.xz
      if: steps.frameworks_av-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release frameworks_av-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache frameworks_base-6.tar.xz
      id: frameworks_base-6
      uses: actions/cache@v3
      with:
        path: aosp/frameworks_base-6.tar.xz
        key: frameworks_base-6
        restore-keys: frameworks_base-6
    - name: Clone project frameworks_base-6.tar.xz
      if: steps.frameworks_base-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release frameworks_base-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache frameworks_proto_logging-6.tar.xz
      id: frameworks_proto_logging-6
      uses: actions/cache@v3
      with:
        path: aosp/frameworks_proto_logging-6.tar.xz
        key: frameworks_proto_logging-6
        restore-keys: frameworks_proto_logging-6
    - name: Clone project frameworks_proto_logging-6.tar.xz
      if: steps.frameworks_proto_logging-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release frameworks_proto_logging-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache packages_modules_DnsResolver-6.tar.xz
      id: packages_modules_DnsResolver-6
      uses: actions/cache@v3
      with:
        path: aosp/packages_modules_DnsResolver-6.tar.xz
        key: packages_modules_DnsResolver-6
        restore-keys: packages_modules_DnsResolver-6
    - name: Clone project packages_modules_DnsResolver-6.tar.xz
      if: steps.packages_modules_DnsResolver-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release packages_modules_DnsResolver-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache packages_modules_StatsD-6.tar.xz
      id: packages_modules_StatsD-6
      uses: actions/cache@v3
      with:
        path: aosp/packages_modules_StatsD-6.tar.xz
        key: packages_modules_StatsD-6
        restore-keys: packages_modules_StatsD-6
    - name: Clone project packages_modules_StatsD-6.tar.xz
      if: steps.packages_modules_StatsD-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release packages_modules_StatsD-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache packages_modules_adb-6.tar.xz
      id: packages_modules_adb-6
      uses: actions/cache@v3
      with:
        path: aosp/packages_modules_adb-6.tar.xz
        key: packages_modules_adb-6
        restore-keys: packages_modules_adb-6
    - name: Clone project packages_modules_adb-6.tar.xz
      if: steps.packages_modules_adb-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release packages_modules_adb-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache system_core-6.tar.xz
      id: system_core-6
      uses: actions/cache@v3
      with:
        path: aosp/system_core-6.tar.xz
        key: system_core-6
        restore-keys: system_core-6
    - name: Clone project system_core-6.tar.xz
      if: steps.system_core-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release system_core-6.tar.xz android-12.0.0_r1-6

    - name: Restore Cache system_libbase-5.tar.xz
      id: system_libbase-5
      uses: actions/cache@v3
      with:
        path: aosp/system_libbase-5.tar.xz
        key: system_libbase-5
        restore-keys: system_libbase-5
    - name: Clone project system_libbase-5.tar.xz
      if: steps.system_libbase-5.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release system_libbase-5.tar.xz android-12.0.0_r1-5

    - name: Restore Cache system_logging-6.tar.xz
      id: system_logging-6
      uses: actions/cache@v3
      with:
        path: aosp/system_logging-6.tar.xz
        key: system_logging-6
        restore-keys: system_logging-6
    - name: Clone project system_logging-6.tar.xz
      if: steps.system_logging-6.outputs.cache-hit != 'true'
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        download_release system_logging-6.tar.xz android-12.0.0_r1-6

    - name: Extract Artifacts
      run: |
        cd aosp && source $GITHUB_WORKSPACE/envsetup.sh
        extract_tar art-6.tar.xz art/
        extract_tar bionic-6.tar.xz bionic/
        extract_tar build_soong-6.tar.xz build/soong/
        extract_tar device_google_cuttlefish-6.tar.xz device/google/cuttlefish/
        extract_tar external_arm-optimized-routines-0.tar.xz external/arm-optimized-routines/
        extract_tar external_boringssl-4.tar.xz external/boringssl/
        extract_tar external_e2fsprogs-4.tar.xz external/e2fsprogs/
        extract_tar external_fmtlib-4.tar.xz external/fmtlib/
        extract_tar external_gflags-4.tar.xz external/gflags/
        extract_tar external_gwp_asan-4.tar.xz external/gwp_asan/
        extract_tar external_jsoncpp-4.tar.xz external/jsoncpp/
        extract_tar external_libcxx-3.tar.xz external/libcxx/
        extract_tar external_libcxxabi-2.tar.xz external/libcxxabi/
        extract_tar external_libevent-4.tar.xz external/libevent/
        extract_tar external_libopus-4.tar.xz external/libopus/
        extract_tar external_libvpx-4.tar.xz external/libvpx/
        extract_tar external_libyuv-5.tar.xz external/libyuv/
        extract_tar external_perfetto-6.tar.xz external/perfetto/
        extract_tar external_pffft-4.tar.xz external/pffft/
        extract_tar external_protobuf-5.tar.xz external/protobuf/
        extract_tar external_rnnoise-4.tar.xz external/rnnoise/
        extract_tar external_scudo-0.tar.xz external/scudo/
        extract_tar external_tinyxml2-5.tar.xz external/tinyxml2/
        extract_tar external_webrtc-6.tar.xz external/webrtc/
        extract_tar external_zlib-2.tar.xz external/zlib/
        extract_tar frameworks_av-6.tar.xz frameworks/av/
        extract_tar frameworks_base-6.tar.xz frameworks/base/
        extract_tar frameworks_proto_logging-6.tar.xz frameworks/proto_logging/
        extract_tar packages_modules_DnsResolver-6.tar.xz packages/modules/DnsResolver/
        extract_tar packages_modules_StatsD-6.tar.xz packages/modules/StatsD/
        extract_tar packages_modules_adb-6.tar.xz packages/modules/adb/
        extract_tar system_core-6.tar.xz system/core/
        extract_tar system_libbase-5.tar.xz system/libbase/
        extract_tar system_logging-6.tar.xz system/logging/

    - name: Start Soong
      run: |
        pushd aosp
        export TOP=$(pwd)
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/jdk && touch prebuilts/jdk/.find-ignore
        mkdir -p prebuilts/jdk/jdk8 && mkdir -p prebuilts/jdk/jdk11
        ln -sf $JAVA_HOME_8_X64 prebuilts/jdk/jdk8/linux-x86
        ln -sf $JAVA_HOME_11_X64 prebuilts/jdk/jdk11/linux-x86
        mkdir -p prebuilts/go && touch prebuilts/go/.find-ignore
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $GITHUB_WORKSPACE/soong_build out/soong/.bootstrap/bin
        ln -sf $GITHUB_WORKSPACE/bpglob out/soong/.minibootstrap
        cp $GITHUB_WORKSPACE/ckati prebuilts/build-tools/linux-x86/bin
        mkdir -p prebuiltlibs && cp $GITHUB_WORKSPACE/Android.bp prebuiltlibs/
        mkdir -p prebuiltlibs && cp $GITHUB_WORKSPACE/rust_prebuilt.list prebuiltlibs/
        echo "eng.buildbot.$(date '+%Y%m%d.%H%M%S')" > out/soong/build_number.txt
        mkdir -p external/compiler-rt/lib/cfi/ && curl 'https://android.googlesource.com/platform/external/compiler-rt/+/android12-gsi/lib/cfi/cfi_blocklist.txt?format=TEXT' | base64 -d > external/compiler-rt/lib/cfi/cfi_blocklist.txt
        $GITHUB_WORKSPACE/scripts/build7.sh
        df -h

    - uses: softprops/action-gh-release@master
      with:
        name: ${{ env.branch }}-7
        tag_name: ${{ env.branch }}-7
        files: |
          aosp/art-7.tar.xz
          aosp/device_google_cuttlefish-7.tar.xz
          aosp/external_perfetto-7.tar.xz
          aosp/frameworks_av-7.tar.xz
          aosp/frameworks_base-7.tar.xz
          aosp/packages_modules_DnsResolver-7.tar.xz
          aosp/packages_modules_adb-7.tar.xz

    - name: Archive art-7.tar.xz
      uses: actions/upload-artifact@v3
      with:
        name: art-7.tar.xz
        path: aosp/art-7.tar.xz

    - name: Archive device_google_cuttlefish-7.tar.xz
      uses: actions/upload-artifact@v3
      with:
        name: device_google_cuttlefish-7.tar.xz
        path: aosp/device_google_cuttlefish-7.tar.xz

    - name: Archive external_perfetto-7.tar.xz
      uses: actions/upload-artifact@v3
      with:
        name: external_perfetto-7.tar.xz
        path: aosp/external_perfetto-7.tar.xz

    - name: Archive frameworks_av-7.tar.xz
      uses: actions/upload-artifact@v3
      with:
        name: frameworks_av-7.tar.xz
        path: aosp/frameworks_av-7.tar.xz

    - name: Archive frameworks_base-7.tar.xz
      uses: actions/upload-artifact@v3
      with:
        name: frameworks_base-7.tar.xz
        path: aosp/frameworks_base-7.tar.xz

    - name: Archive packages_modules_DnsResolver-7.tar.xz
      uses: actions/upload-artifact@v3
      with:
        name: packages_modules_DnsResolver-7.tar.xz
        path: aosp/packages_modules_DnsResolver-7.tar.xz

    - name: Archive packages_modules_adb-7.tar.xz
      uses: actions/upload-artifact@v3
      with:
        name: packages_modules_adb-7.tar.xz
        path: aosp/packages_modules_adb-7.tar.xz

    - name: Restore Cache art-7.tar.xz
      id: art-7
      uses: actions/cache@v3
      with:
        path: aosp/art-7.tar.xz
        key: art-7
        restore-keys: art-7

    - name: Restore Cache device_google_cuttlefish-7.tar.xz
      id: device_google_cuttlefish-7
      uses: actions/cache@v3
      with:
        path: aosp/device_google_cuttlefish-7.tar.xz
        key: device_google_cuttlefish-7
        restore-keys: device_google_cuttlefish-7

    - name: Restore Cache external_perfetto-7.tar.xz
      id: external_perfetto-7
      uses: actions/cache@v3
      with:
        path: aosp/external_perfetto-7.tar.xz
        key: external_perfetto-7
        restore-keys: external_perfetto-7

    - name: Restore Cache frameworks_av-7.tar.xz
      id: frameworks_av-7
      uses: actions/cache@v3
      with:
        path: aosp/frameworks_av-7.tar.xz
        key: frameworks_av-7
        restore-keys: frameworks_av-7

    - name: Restore Cache frameworks_base-7.tar.xz
      id: frameworks_base-7
      uses: actions/cache@v3
      with:
        path: aosp/frameworks_base-7.tar.xz
        key: frameworks_base-7
        restore-keys: frameworks_base-7

    - name: Restore Cache packages_modules_DnsResolver-7.tar.xz
      id: packages_modules_DnsResolver-7
      uses: actions/cache@v3
      with:
        path: aosp/packages_modules_DnsResolver-7.tar.xz
        key: packages_modules_DnsResolver-7
        restore-keys: packages_modules_DnsResolver-7

    - name: Restore Cache packages_modules_adb-7.tar.xz
      id: packages_modules_adb-7
      uses: actions/cache@v3
      with:
        path: aosp/packages_modules_adb-7.tar.xz
        key: packages_modules_adb-7
        restore-keys: packages_modules_adb-7