name: AOSP Build
on: push
env:
  BRANCH: android-12.0.0_r1
jobs:
  clone_bootstrap:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@main
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Clone project build/make
      if: steps.build_make.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform build
        mv build make && mkdir build && mv make build/
        sed -i 's/^PRODUCT_EXTRA_VNDK_VERSIONS/#PRODUCT_EXTRA_VNDK_VERSIONS/g' build/make/target/product/gsi_release.mk
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Clone project build/blueprint
      if: steps.build_blueprint.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform build/blueprint
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Clone project build/soong
      if: steps.build_soong.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform build/soong
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Clone project bionic
      if: steps.bionic.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform bionic
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Clone project external/libcxx
      if: steps.external_libcxx.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/libcxx
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Clone project external/libcxxabi
      if: steps.external_libcxxabi.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/libcxxabi
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Clone project external/compiler-rt
      if: steps.external_compiler-rt.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/compiler-rt
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Clone project external/gwp_asan
      if: steps.external_gwp_asan.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/gwp_asan
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Clone project external/golang-protobuf
      if: steps.external_golang-protobuf.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/golang-protobuf
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Clone project external/starlark-go
      if: steps.external_starlark-go.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/starlark-go
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Clone project system/core
      if: steps.system_core.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/core
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Clone project system/libbase
      if: steps.system_libbase.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/libbase
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Clone project system/libhwbinder
      if: steps.system_libhwbinder.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/libhwbinder
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Clone project system/logging
      if: steps.system_logging.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/logging
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Clone project system/sepolicy
      if: steps.system_sepolicy.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/sepolicy
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Clone project kernel/configs
      if: steps.kernel_configs.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth kernel/configs
  clone_prebuilts:
    needs: [clone_bootstrap]
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@main
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Download get_clang_version.py and Link go
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        curl "https://android.googlesource.com/platform/build/soong/+/refs/heads/master/scripts/get_clang_version.py?format=TEXT" | base64 -d > $ROOTDIR/get_clang_version.py
        popd
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Clone project prebuilts/build-tools
      if: steps.prebuilts_build-tools.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_sparse prebuilts/build-tools linux-x86/bin linux-x86/lib64 path common
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Clone project prebuilts/clang-tools
      if: steps.prebuilts_clang-tools.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_sparse prebuilts/clang-tools linux-x86/bin linux-x86/lib64/clang
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Clone project prebuilts/clang/host/linux-x86
      if: steps.prebuilts_clang_host_linux-x86.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_sparse prebuilts/clang/host/linux-x86 $(python ${ROOTDIR}/get_clang_version.py) soong
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Clone project prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      if: steps.prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_sparse prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8 sysroot lib/gcc/x86_64-linux/4.8.3 x86_64-linux/lib64
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Clone project prebuilts/ndk
      if: steps.prebuilts_ndk.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_sparse prebuilts/ndk current
  external_arm-optimized-routines-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache external/arm-optimized-routines
      id: external_arm-optimized-routines
      uses: actions/cache@v3
      with:
        path: "aosp/external/arm-optimized-routines"
        key: "external_arm-optimized-routines@$BRANCH"
        restore-keys: "external_arm-optimized-routines@$BRANCH"
    - name: Clone project external/arm-optimized-routines
      if: steps.external_arm-optimized-routines.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/arm-optimized-routines
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_arm-optimized-routines-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_recovery_x86_64_static/libarm-optimized-routines-string.a out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_64_static/libarm-optimized-routines-string.a out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_64_static_apex10000/libarm-optimized-routines-string.a out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_x86_64_static/libarm-optimized-routines-string.a out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_x86_64_static_apex10000/libarm-optimized-routines-string.a out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_recovery_x86_64_static/libarm-optimized-routines-math.a out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_64_static/libarm-optimized-routines-math.a out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_64_static_apex10000/libarm-optimized-routines-math.a out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_x86_64_static/libarm-optimized-routines-math.a out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_x86_64_static_apex10000/libarm-optimized-routines-math.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_arm-optimized-routines-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_recovery_x86_64_static/libarm-optimized-routines-string.a ] && mkdir -p prebuiltlibs/external/arm-optimized-routines/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_recovery_x86_64_static/libarm-optimized-routines-string.a prebuiltlibs/external/arm-optimized-routines/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_64_static/libarm-optimized-routines-string.a ] && mkdir -p prebuiltlibs/external/arm-optimized-routines/android_x86_64_static/ && cp out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_64_static/libarm-optimized-routines-string.a prebuiltlibs/external/arm-optimized-routines/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_64_static_apex10000/libarm-optimized-routines-string.a ] && mkdir -p prebuiltlibs/external/arm-optimized-routines/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_64_static_apex10000/libarm-optimized-routines-string.a prebuiltlibs/external/arm-optimized-routines/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_x86_64_static/libarm-optimized-routines-string.a ] && mkdir -p prebuiltlibs/external/arm-optimized-routines/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_x86_64_static/libarm-optimized-routines-string.a prebuiltlibs/external/arm-optimized-routines/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_x86_64_static_apex10000/libarm-optimized-routines-string.a ] && mkdir -p prebuiltlibs/external/arm-optimized-routines/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-string/android_x86_x86_64_static_apex10000/libarm-optimized-routines-string.a prebuiltlibs/external/arm-optimized-routines/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_recovery_x86_64_static/libarm-optimized-routines-math.a ] && mkdir -p prebuiltlibs/external/arm-optimized-routines/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_recovery_x86_64_static/libarm-optimized-routines-math.a prebuiltlibs/external/arm-optimized-routines/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_64_static/libarm-optimized-routines-math.a ] && mkdir -p prebuiltlibs/external/arm-optimized-routines/android_x86_64_static/ && cp out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_64_static/libarm-optimized-routines-math.a prebuiltlibs/external/arm-optimized-routines/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_64_static_apex10000/libarm-optimized-routines-math.a ] && mkdir -p prebuiltlibs/external/arm-optimized-routines/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_64_static_apex10000/libarm-optimized-routines-math.a prebuiltlibs/external/arm-optimized-routines/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_x86_64_static/libarm-optimized-routines-math.a ] && mkdir -p prebuiltlibs/external/arm-optimized-routines/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_x86_64_static/libarm-optimized-routines-math.a prebuiltlibs/external/arm-optimized-routines/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_x86_64_static_apex10000/libarm-optimized-routines-math.a ] && mkdir -p prebuiltlibs/external/arm-optimized-routines/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/arm-optimized-routines/libarm-optimized-routines-math/android_x86_x86_64_static_apex10000/libarm-optimized-routines-math.a prebuiltlibs/external/arm-optimized-routines/android_x86_x86_64_static_apex10000/ || true
        cp -r out/soong/ninja/external/arm-optimized-routines prebuiltlibs/external/arm-optimized-routines/external_arm-optimized-routines-0
        grep '|external/arm-optimized-routines' out/soong/module-info.txt >> prebuiltlibs/external/arm-optimized-routines/MODULES
        du -ad1 external/arm-optimized-routines | sort -rnk1 > prebuiltlibs/external/arm-optimized-routines/.SIZE
        popd
    - name: write Android.bp external_arm-optimized-routines-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_static {\n\tname: \"libarm-optimized-routines-string\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libarm-optimized-routines-string.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libarm-optimized-routines-string.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libarm-optimized-routines-string.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libarm-optimized-routines-string.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libarm-optimized-routines-string.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libarm-optimized-routines-string.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [],\n\tsystem_shared_libs: [\"\",], stl: \"none\", apex_available: [\"//apex_available:platform\",\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_static {\n\tname: \"libarm-optimized-routines-math\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libarm-optimized-routines-math.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libarm-optimized-routines-math.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libarm-optimized-routines-math.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libarm-optimized-routines-math.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libarm-optimized-routines-math.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libarm-optimized-routines-math.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [],\n\tsystem_shared_libs: [\"\",], stl: \"none\", apex_available: [\"//apex_available:platform\",\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/arm-optimized-routines/Android.bp
        printf "\n" >> prebuiltlibs/external/arm-optimized-routines/Android.bp
        popd
    - name: Archive external_arm-optimized-routines-0
      uses: actions/upload-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines
  external_gwp_asan-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_gwp_asan-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/gwp_asan/gwp_asan/android_recovery_x86_64_static/gwp_asan.a out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_64_static/gwp_asan.a out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_64_static_apex10000/gwp_asan.a out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_x86_64_static/gwp_asan.a out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_x86_64_static_apex10000/gwp_asan.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_gwp_asan-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/gwp_asan/gwp_asan/android_recovery_x86_64_static/gwp_asan.a ] && mkdir -p prebuiltlibs/external/gwp_asan/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/gwp_asan/gwp_asan/android_recovery_x86_64_static/gwp_asan.a prebuiltlibs/external/gwp_asan/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_64_static/gwp_asan.a ] && mkdir -p prebuiltlibs/external/gwp_asan/android_x86_64_static/ && cp out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_64_static/gwp_asan.a prebuiltlibs/external/gwp_asan/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_64_static_apex10000/gwp_asan.a ] && mkdir -p prebuiltlibs/external/gwp_asan/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_64_static_apex10000/gwp_asan.a prebuiltlibs/external/gwp_asan/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_x86_64_static/gwp_asan.a ] && mkdir -p prebuiltlibs/external/gwp_asan/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_x86_64_static/gwp_asan.a prebuiltlibs/external/gwp_asan/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_x86_64_static_apex10000/gwp_asan.a ] && mkdir -p prebuiltlibs/external/gwp_asan/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/gwp_asan/gwp_asan/android_x86_x86_64_static_apex10000/gwp_asan.a prebuiltlibs/external/gwp_asan/android_x86_x86_64_static_apex10000/ || true
        cp -r out/soong/ninja/external/gwp_asan prebuiltlibs/external/gwp_asan/external_gwp_asan-0
        grep '|external/gwp_asan' out/soong/module-info.txt >> prebuiltlibs/external/gwp_asan/MODULES
        du -ad1 external/gwp_asan | sort -rnk1 > prebuiltlibs/external/gwp_asan/.SIZE
        popd
    - name: write Android.bp external_gwp_asan-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_static {\n\tname: \"gwp_asan\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/gwp_asan.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/gwp_asan.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/gwp_asan.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/gwp_asan.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/gwp_asan.a\",\n\tsrcs: [\"android_recovery_x86_64_static/gwp_asan.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [],\n\tmin_sdk_version: \"S\", system_shared_libs: [\"\",], stl: \"none\", apex_available: [\"//apex_available:platform\",\"com.android.runtime\",\"com.android.media.swcodec\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/gwp_asan/Android.bp
        printf "\n" >> prebuiltlibs/external/gwp_asan/Android.bp
        popd
    - name: Archive external_gwp_asan-0
      uses: actions/upload-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan
  external_scudo-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache external/scudo
      id: external_scudo
      uses: actions/cache@v3
      with:
        path: "aosp/external/scudo"
        key: "external_scudo@$BRANCH"
        restore-keys: "external_scudo@$BRANCH"
    - name: Clone project external/scudo
      if: steps.external_scudo.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/scudo
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_scudo-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/scudo/libscudo/android_recovery_x86_64_static/libscudo.a out/soong/.intermediates/external/scudo/libscudo/android_x86_64_static/libscudo.a out/soong/.intermediates/external/scudo/libscudo/android_x86_64_static_apex10000/libscudo.a out/soong/.intermediates/external/scudo/libscudo/android_x86_x86_64_static/libscudo.a out/soong/.intermediates/external/scudo/libscudo/android_x86_x86_64_static_apex10000/libscudo.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_scudo-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/scudo/libscudo/android_recovery_x86_64_static/libscudo.a ] && mkdir -p prebuiltlibs/external/scudo/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/scudo/libscudo/android_recovery_x86_64_static/libscudo.a prebuiltlibs/external/scudo/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/scudo/libscudo/android_x86_64_static/libscudo.a ] && mkdir -p prebuiltlibs/external/scudo/android_x86_64_static/ && cp out/soong/.intermediates/external/scudo/libscudo/android_x86_64_static/libscudo.a prebuiltlibs/external/scudo/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/scudo/libscudo/android_x86_64_static_apex10000/libscudo.a ] && mkdir -p prebuiltlibs/external/scudo/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/scudo/libscudo/android_x86_64_static_apex10000/libscudo.a prebuiltlibs/external/scudo/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/scudo/libscudo/android_x86_x86_64_static/libscudo.a ] && mkdir -p prebuiltlibs/external/scudo/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/scudo/libscudo/android_x86_x86_64_static/libscudo.a prebuiltlibs/external/scudo/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/scudo/libscudo/android_x86_x86_64_static_apex10000/libscudo.a ] && mkdir -p prebuiltlibs/external/scudo/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/scudo/libscudo/android_x86_x86_64_static_apex10000/libscudo.a prebuiltlibs/external/scudo/android_x86_x86_64_static_apex10000/ || true
        cp -r out/soong/ninja/external/scudo prebuiltlibs/external/scudo/external_scudo-0
        grep '|external/scudo' out/soong/module-info.txt >> prebuiltlibs/external/scudo/MODULES
        du -ad1 external/scudo | sort -rnk1 > prebuiltlibs/external/scudo/.SIZE
        popd
    - name: write Android.bp external_scudo-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_static {\n\tname: \"libscudo\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libscudo.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libscudo.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libscudo.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libscudo.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libscudo.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libscudo.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [],\n\tsystem_shared_libs: [\"\",], stl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/scudo/Android.bp
        printf "\n" >> prebuiltlibs/external/scudo/Android.bp
        popd
    - name: Archive external_scudo-0
      uses: actions/upload-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo
  bionic-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts,external_arm-optimized-routines-0,external_gwp_asan-0,external_scudo-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Restore Cache external/scudo
      id: external_scudo
      uses: actions/cache@v3
      with:
        path: "aosp/external/scudo"
        key: "external_scudo@$BRANCH"
        restore-keys: "external_scudo@$BRANCH"
    - name: Clone project external/scudo
      if: steps.external_scudo.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/scudo
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Restore Cache external/arm-optimized-routines
      id: external_arm-optimized-routines
      uses: actions/cache@v3
      with:
        path: "aosp/external/arm-optimized-routines"
        key: "external_arm-optimized-routines@$BRANCH"
        restore-keys: "external_arm-optimized-routines@$BRANCH"
    - name: Clone project external/arm-optimized-routines
      if: steps.external_arm-optimized-routines.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/arm-optimized-routines
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target bionic-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/bionic/libc/crtbegin_so/android_recovery_x86_64/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_vendor.31_x86_64/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_vendor.31_x86_x86_64/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex10000/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex29/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex30/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex31/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_29/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_29_apex30/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_30/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_30_apex30/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_current/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex10000/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex29/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex30/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex31/crtbegin_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_recovery_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_vendor.31_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_vendor.31_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_29/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_29_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_30/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_30_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_current/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend_so.o out/soong/.intermediates/bionic/libc/crtbegin_static/android_x86_64/crtbegin_static.o out/soong/.intermediates/bionic/libc/crtbegin_static/android_x86_64_apex10000/crtbegin_static.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_recovery_x86_64/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_vendor.31_x86_64/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_vendor.31_x86_x86_64/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex10000/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex29/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex30/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex31/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64_apex10000/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64_apex29/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64_apex31/crtbegin_dynamic.o out/soong/.intermediates/bionic/libc/crtend_android/android_recovery_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_vendor.31_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_vendor.31_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex30/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend.o out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_recovery_x86_64_static/libasync_safe.a out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_vendor.31_x86_64_static/libasync_safe.a out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_vendor.31_x86_x86_64_static/libasync_safe.a out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static/libasync_safe.a out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static_apex10000/libasync_safe.a out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static_apex31/libasync_safe.a out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static_lto-thin/libasync_safe.a out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static/libasync_safe.a out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static_apex10000/libasync_safe.a out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static_apex31/libasync_safe.a out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static_lto-thin/libasync_safe.a out/soong/.intermediates/bionic/libdl/libdl_android/android_x86_64_shared/libdl_android.so out/soong/.intermediates/bionic/libdl/libdl_android/android_x86_x86_64_shared/libdl_android.so out/soong/.intermediates/bionic/libdl/libdl/android_recovery_x86_64_shared/libdl.so out/soong/.intermediates/bionic/libdl/libdl/android_vendor.31_x86_64_shared/libdl.so out/soong/.intermediates/bionic/libdl/libdl/android_vendor.31_x86_x86_64_shared/libdl.so out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_shared/libdl.so out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_shared_apex10000/libdl.so out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_shared_current/libdl.so out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_static/libdl.a out/soong/.intermediates/bionic/libdl/libdl/android_x86_x86_64_shared/libdl.so out/soong/.intermediates/bionic/libdl/libdl/android_x86_x86_64_shared_apex10000/libdl.so out/soong/.intermediates/bionic/libdl/libdl/android_x86_x86_64_shared_current/libdl.so out/soong/.intermediates/bionic/libc/libc/android_recovery_x86_64_shared/libc.so out/soong/.intermediates/bionic/libc/libc/android_vendor.31_x86_64_shared/libc.so out/soong/.intermediates/bionic/libc/libc/android_vendor.31_x86_x86_64_shared/libc.so out/soong/.intermediates/bionic/libc/libc/android_x86_64_shared/libc.so out/soong/.intermediates/bionic/libc/libc/android_x86_64_shared_apex10000/libc.so out/soong/.intermediates/bionic/libc/libc/android_x86_64_shared_current/libc.so out/soong/.intermediates/bionic/libc/libc/android_x86_64_static/libc.a out/soong/.intermediates/bionic/libc/libc/android_x86_64_static_apex10000/libc.a out/soong/.intermediates/bionic/libc/libc/android_x86_x86_64_shared/libc.so out/soong/.intermediates/bionic/libc/libc/android_x86_x86_64_shared_apex10000/libc.so out/soong/.intermediates/bionic/libc/libc/android_x86_x86_64_shared_current/libc.so out/soong/.intermediates/bionic/libc/libstdc++/android_x86_64_shared/libstdc++.so out/soong/.intermediates/bionic/libc/libstdc++/android_x86_x86_64_shared/libstdc++.so out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_21/libc.so out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_29/libc.so out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_30/libc.so out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_current/libc.so out/soong/.intermediates/bionic/libc/libstdc++.ndk/android_x86_64_sdk_shared_21/libstdc++.so out/soong/.intermediates/bionic/libc/libstdc++.ndk/android_x86_64_sdk_shared_29/libstdc++.so out/soong/.intermediates/bionic/libc/libstdc++.ndk/android_x86_64_sdk_shared_current/libstdc++.so out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_21/libdl.so out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_29/libdl.so out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_30/libdl.so out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_current/libdl.so out/soong/.intermediates/bionic/libm/libm/android_recovery_x86_64_shared/libm.so out/soong/.intermediates/bionic/libm/libm/android_vendor.31_x86_64_shared/libm.so out/soong/.intermediates/bionic/libm/libm/android_vendor.31_x86_x86_64_shared/libm.so out/soong/.intermediates/bionic/libm/libm/android_x86_64_shared/libm.so out/soong/.intermediates/bionic/libm/libm/android_x86_64_shared_apex10000/libm.so out/soong/.intermediates/bionic/libm/libm/android_x86_64_shared_current/libm.so out/soong/.intermediates/bionic/libm/libm/android_x86_64_static/libm.a out/soong/.intermediates/bionic/libm/libm/android_x86_64_static_apex10000/libm.a out/soong/.intermediates/bionic/libm/libm/android_x86_x86_64_shared/libm.so out/soong/.intermediates/bionic/libm/libm/android_x86_x86_64_shared_apex10000/libm.so out/soong/.intermediates/bionic/libm/libm/android_x86_x86_64_shared_current/libm.so out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_21/libm.so out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_29/libm.so out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_30/libm.so out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_current/libm.so)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target bionic-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_recovery_x86_64/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_recovery_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_recovery_x86_64/crtbegin_so.o prebuiltlibs/bionic/android_recovery_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_vendor.31_x86_64/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_vendor.31_x86_64/crtbegin_so.o prebuiltlibs/bionic/android_vendor.31_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_vendor.31_x86_x86_64/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_vendor.31_x86_x86_64/crtbegin_so.o prebuiltlibs/bionic/android_vendor.31_x86_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64/crtbegin_so.o prebuiltlibs/bionic/android_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex10000/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex10000/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex10000/crtbegin_so.o prebuiltlibs/bionic/android_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex29/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex29/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex29/crtbegin_so.o prebuiltlibs/bionic/android_x86_64_apex29/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex30/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex30/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex30/crtbegin_so.o prebuiltlibs/bionic/android_x86_64_apex30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex31/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex31/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_apex31/crtbegin_so.o prebuiltlibs/bionic/android_x86_64_apex31/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_29/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_29/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_29/crtbegin_so.o prebuiltlibs/bionic/android_x86_64_sdk_29/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_29_apex30/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_29_apex30/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_29_apex30/crtbegin_so.o prebuiltlibs/bionic/android_x86_64_sdk_29_apex30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_30/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_30/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_30/crtbegin_so.o prebuiltlibs/bionic/android_x86_64_sdk_30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_30_apex30/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_30_apex30/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_30_apex30/crtbegin_so.o prebuiltlibs/bionic/android_x86_64_sdk_30_apex30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_current/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_current/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_64_sdk_current/crtbegin_so.o prebuiltlibs/bionic/android_x86_64_sdk_current/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64/crtbegin_so.o prebuiltlibs/bionic/android_x86_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex10000/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex10000/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex10000/crtbegin_so.o prebuiltlibs/bionic/android_x86_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex29/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex29/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex29/crtbegin_so.o prebuiltlibs/bionic/android_x86_x86_64_apex29/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex30/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex30/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex30/crtbegin_so.o prebuiltlibs/bionic/android_x86_x86_64_apex30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex31/crtbegin_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex31/ && cp out/soong/.intermediates/bionic/libc/crtbegin_so/android_x86_x86_64_apex31/crtbegin_so.o prebuiltlibs/bionic/android_x86_x86_64_apex31/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_recovery_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_recovery_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_recovery_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_recovery_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_vendor.31_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_vendor.31_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_vendor.31_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_vendor.31_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_vendor.31_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_vendor.31_x86_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex10000/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex29/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_64_apex29/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex30/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_64_apex30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex31/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_64_apex31/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_29/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_29/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_29/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_64_sdk_29/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_29_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_29_apex30/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_29_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_64_sdk_29_apex30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_30/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_30/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_30/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_64_sdk_30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_30_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_30_apex30/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_30_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_64_sdk_30_apex30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_current/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_current/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_64_sdk_current/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_64_sdk_current/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex10000/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex29/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_x86_64_apex29/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex30/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex30/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_x86_64_apex30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend_so.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex31/ && cp out/soong/.intermediates/bionic/libc/crtend_so/android_x86_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend_so.o prebuiltlibs/bionic/android_x86_x86_64_apex31/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_static/android_x86_64/crtbegin_static.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_static/android_x86_64/crtbegin_static.o prebuiltlibs/bionic/android_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_static/android_x86_64_apex10000/crtbegin_static.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex10000/ && cp out/soong/.intermediates/bionic/libc/crtbegin_static/android_x86_64_apex10000/crtbegin_static.o prebuiltlibs/bionic/android_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_recovery_x86_64/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_recovery_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_recovery_x86_64/crtbegin_dynamic.o prebuiltlibs/bionic/android_recovery_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_vendor.31_x86_64/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_vendor.31_x86_64/crtbegin_dynamic.o prebuiltlibs/bionic/android_vendor.31_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_vendor.31_x86_x86_64/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_vendor.31_x86_x86_64/crtbegin_dynamic.o prebuiltlibs/bionic/android_vendor.31_x86_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64/crtbegin_dynamic.o prebuiltlibs/bionic/android_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex10000/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex10000/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex10000/crtbegin_dynamic.o prebuiltlibs/bionic/android_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex29/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex29/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex29/crtbegin_dynamic.o prebuiltlibs/bionic/android_x86_64_apex29/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex30/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex30/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex30/crtbegin_dynamic.o prebuiltlibs/bionic/android_x86_64_apex30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex31/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex31/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_64_apex31/crtbegin_dynamic.o prebuiltlibs/bionic/android_x86_64_apex31/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64/crtbegin_dynamic.o prebuiltlibs/bionic/android_x86_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64_apex10000/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex10000/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64_apex10000/crtbegin_dynamic.o prebuiltlibs/bionic/android_x86_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64_apex29/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex29/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64_apex29/crtbegin_dynamic.o prebuiltlibs/bionic/android_x86_x86_64_apex29/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64_apex31/crtbegin_dynamic.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex31/ && cp out/soong/.intermediates/bionic/libc/crtbegin_dynamic/android_x86_x86_64_apex31/crtbegin_dynamic.o prebuiltlibs/bionic/android_x86_x86_64_apex31/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_recovery_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_recovery_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_recovery_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_recovery_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_vendor.31_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_vendor.31_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_vendor.31_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_vendor.31_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_vendor.31_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_vendor.31_x86_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex10000/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex29/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_x86_64_apex29/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex30/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex30/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex30/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_x86_64_apex30/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_x86_64_apex31/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_x86_64_apex31/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_x86_x86_64/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex10000/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64_apex10000/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_x86_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex29/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64_apex29/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_x86_x86_64_apex29/ || true
        [ -e out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend.o ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_apex31/ && cp out/soong/.intermediates/bionic/libc/crtend_android/android_x86_x86_64_apex31/obj/bionic/libc/arch-common/bionic/crtend.o prebuiltlibs/bionic/android_x86_x86_64_apex31/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_recovery_x86_64_static/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_recovery_x86_64_static/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_recovery_x86_64_static/libasync_safe.a prebuiltlibs/bionic/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_vendor.31_x86_64_static/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_vendor.31_x86_64_static/libasync_safe.a prebuiltlibs/bionic/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_vendor.31_x86_x86_64_static/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_vendor.31_x86_x86_64_static/libasync_safe.a prebuiltlibs/bionic/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_x86_64_static/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static/libasync_safe.a prebuiltlibs/bionic/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static_apex10000/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static_apex10000/libasync_safe.a prebuiltlibs/bionic/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static_apex31/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_x86_64_static_apex31/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static_apex31/libasync_safe.a prebuiltlibs/bionic/android_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static_lto-thin/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_x86_64_static_lto-thin/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_64_static_lto-thin/libasync_safe.a prebuiltlibs/bionic/android_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_static/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static/libasync_safe.a prebuiltlibs/bionic/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static_apex10000/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static_apex10000/libasync_safe.a prebuiltlibs/bionic/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static_apex31/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_static_apex31/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static_apex31/libasync_safe.a prebuiltlibs/bionic/android_x86_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static_lto-thin/libasync_safe.a ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_static_lto-thin/ && cp out/soong/.intermediates/bionic/libc/async_safe/libasync_safe/android_x86_x86_64_static_lto-thin/libasync_safe.a prebuiltlibs/bionic/android_x86_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl_android/android_x86_64_shared/libdl_android.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared/ && cp out/soong/.intermediates/bionic/libdl/libdl_android/android_x86_64_shared/libdl_android.so prebuiltlibs/bionic/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl_android/android_x86_x86_64_shared/libdl_android.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared/ && cp out/soong/.intermediates/bionic/libdl/libdl_android/android_x86_x86_64_shared/libdl_android.so prebuiltlibs/bionic/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl/android_recovery_x86_64_shared/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/bionic/libdl/libdl/android_recovery_x86_64_shared/libdl.so prebuiltlibs/bionic/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl/android_vendor.31_x86_64_shared/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/bionic/libdl/libdl/android_vendor.31_x86_64_shared/libdl.so prebuiltlibs/bionic/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl/android_vendor.31_x86_x86_64_shared/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/bionic/libdl/libdl/android_vendor.31_x86_x86_64_shared/libdl.so prebuiltlibs/bionic/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_shared/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared/ && cp out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_shared/libdl.so prebuiltlibs/bionic/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_shared_apex10000/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_shared_apex10000/libdl.so prebuiltlibs/bionic/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_shared_current/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared_current/ && cp out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_shared_current/libdl.so prebuiltlibs/bionic/android_x86_64_shared_current/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_static/libdl.a ] && mkdir -p prebuiltlibs/bionic/android_x86_64_static/ && cp out/soong/.intermediates/bionic/libdl/libdl/android_x86_64_static/libdl.a prebuiltlibs/bionic/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl/android_x86_x86_64_shared/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared/ && cp out/soong/.intermediates/bionic/libdl/libdl/android_x86_x86_64_shared/libdl.so prebuiltlibs/bionic/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl/android_x86_x86_64_shared_apex10000/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/bionic/libdl/libdl/android_x86_x86_64_shared_apex10000/libdl.so prebuiltlibs/bionic/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl/android_x86_x86_64_shared_current/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared_current/ && cp out/soong/.intermediates/bionic/libdl/libdl/android_x86_x86_64_shared_current/libdl.so prebuiltlibs/bionic/android_x86_x86_64_shared_current/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_recovery_x86_64_shared/libc.so ] && mkdir -p prebuiltlibs/bionic/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/bionic/libc/libc/android_recovery_x86_64_shared/libc.so prebuiltlibs/bionic/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_vendor.31_x86_64_shared/libc.so ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/bionic/libc/libc/android_vendor.31_x86_64_shared/libc.so prebuiltlibs/bionic/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_vendor.31_x86_x86_64_shared/libc.so ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/bionic/libc/libc/android_vendor.31_x86_x86_64_shared/libc.so prebuiltlibs/bionic/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_x86_64_shared/libc.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared/ && cp out/soong/.intermediates/bionic/libc/libc/android_x86_64_shared/libc.so prebuiltlibs/bionic/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_x86_64_shared_apex10000/libc.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/bionic/libc/libc/android_x86_64_shared_apex10000/libc.so prebuiltlibs/bionic/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_x86_64_shared_current/libc.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared_current/ && cp out/soong/.intermediates/bionic/libc/libc/android_x86_64_shared_current/libc.so prebuiltlibs/bionic/android_x86_64_shared_current/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_x86_64_static/libc.a ] && mkdir -p prebuiltlibs/bionic/android_x86_64_static/ && cp out/soong/.intermediates/bionic/libc/libc/android_x86_64_static/libc.a prebuiltlibs/bionic/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_x86_64_static_apex10000/libc.a ] && mkdir -p prebuiltlibs/bionic/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/bionic/libc/libc/android_x86_64_static_apex10000/libc.a prebuiltlibs/bionic/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_x86_x86_64_shared/libc.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared/ && cp out/soong/.intermediates/bionic/libc/libc/android_x86_x86_64_shared/libc.so prebuiltlibs/bionic/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_x86_x86_64_shared_apex10000/libc.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/bionic/libc/libc/android_x86_x86_64_shared_apex10000/libc.so prebuiltlibs/bionic/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc/android_x86_x86_64_shared_current/libc.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared_current/ && cp out/soong/.intermediates/bionic/libc/libc/android_x86_x86_64_shared_current/libc.so prebuiltlibs/bionic/android_x86_x86_64_shared_current/ || true
        [ -e out/soong/.intermediates/bionic/libc/libstdc++/android_x86_64_shared/libstdc++.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared/ && cp out/soong/.intermediates/bionic/libc/libstdc++/android_x86_64_shared/libstdc++.so prebuiltlibs/bionic/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libc/libstdc++/android_x86_x86_64_shared/libstdc++.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared/ && cp out/soong/.intermediates/bionic/libc/libstdc++/android_x86_x86_64_shared/libstdc++.so prebuiltlibs/bionic/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_21/libc.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_21/ && cp out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_21/libc.so prebuiltlibs/bionic/android_x86_64_sdk_shared_21/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_29/libc.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_29/ && cp out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_29/libc.so prebuiltlibs/bionic/android_x86_64_sdk_shared_29/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_30/libc.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_30/ && cp out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_30/libc.so prebuiltlibs/bionic/android_x86_64_sdk_shared_30/ || true
        [ -e out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_current/libc.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_current/ && cp out/soong/.intermediates/bionic/libc/libc.ndk/android_x86_64_sdk_shared_current/libc.so prebuiltlibs/bionic/android_x86_64_sdk_shared_current/ || true
        [ -e out/soong/.intermediates/bionic/libc/libstdc++.ndk/android_x86_64_sdk_shared_21/libstdc++.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_21/ && cp out/soong/.intermediates/bionic/libc/libstdc++.ndk/android_x86_64_sdk_shared_21/libstdc++.so prebuiltlibs/bionic/android_x86_64_sdk_shared_21/ || true
        [ -e out/soong/.intermediates/bionic/libc/libstdc++.ndk/android_x86_64_sdk_shared_29/libstdc++.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_29/ && cp out/soong/.intermediates/bionic/libc/libstdc++.ndk/android_x86_64_sdk_shared_29/libstdc++.so prebuiltlibs/bionic/android_x86_64_sdk_shared_29/ || true
        [ -e out/soong/.intermediates/bionic/libc/libstdc++.ndk/android_x86_64_sdk_shared_current/libstdc++.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_current/ && cp out/soong/.intermediates/bionic/libc/libstdc++.ndk/android_x86_64_sdk_shared_current/libstdc++.so prebuiltlibs/bionic/android_x86_64_sdk_shared_current/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_21/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_21/ && cp out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_21/libdl.so prebuiltlibs/bionic/android_x86_64_sdk_shared_21/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_29/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_29/ && cp out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_29/libdl.so prebuiltlibs/bionic/android_x86_64_sdk_shared_29/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_30/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_30/ && cp out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_30/libdl.so prebuiltlibs/bionic/android_x86_64_sdk_shared_30/ || true
        [ -e out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_current/libdl.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_current/ && cp out/soong/.intermediates/bionic/libdl/libdl.ndk/android_x86_64_sdk_shared_current/libdl.so prebuiltlibs/bionic/android_x86_64_sdk_shared_current/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_recovery_x86_64_shared/libm.so ] && mkdir -p prebuiltlibs/bionic/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/bionic/libm/libm/android_recovery_x86_64_shared/libm.so prebuiltlibs/bionic/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_vendor.31_x86_64_shared/libm.so ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/bionic/libm/libm/android_vendor.31_x86_64_shared/libm.so prebuiltlibs/bionic/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_vendor.31_x86_x86_64_shared/libm.so ] && mkdir -p prebuiltlibs/bionic/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/bionic/libm/libm/android_vendor.31_x86_x86_64_shared/libm.so prebuiltlibs/bionic/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_x86_64_shared/libm.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared/ && cp out/soong/.intermediates/bionic/libm/libm/android_x86_64_shared/libm.so prebuiltlibs/bionic/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_x86_64_shared_apex10000/libm.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/bionic/libm/libm/android_x86_64_shared_apex10000/libm.so prebuiltlibs/bionic/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_x86_64_shared_current/libm.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_shared_current/ && cp out/soong/.intermediates/bionic/libm/libm/android_x86_64_shared_current/libm.so prebuiltlibs/bionic/android_x86_64_shared_current/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_x86_64_static/libm.a ] && mkdir -p prebuiltlibs/bionic/android_x86_64_static/ && cp out/soong/.intermediates/bionic/libm/libm/android_x86_64_static/libm.a prebuiltlibs/bionic/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_x86_64_static_apex10000/libm.a ] && mkdir -p prebuiltlibs/bionic/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/bionic/libm/libm/android_x86_64_static_apex10000/libm.a prebuiltlibs/bionic/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_x86_x86_64_shared/libm.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared/ && cp out/soong/.intermediates/bionic/libm/libm/android_x86_x86_64_shared/libm.so prebuiltlibs/bionic/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_x86_x86_64_shared_apex10000/libm.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/bionic/libm/libm/android_x86_x86_64_shared_apex10000/libm.so prebuiltlibs/bionic/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm/android_x86_x86_64_shared_current/libm.so ] && mkdir -p prebuiltlibs/bionic/android_x86_x86_64_shared_current/ && cp out/soong/.intermediates/bionic/libm/libm/android_x86_x86_64_shared_current/libm.so prebuiltlibs/bionic/android_x86_x86_64_shared_current/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_21/libm.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_21/ && cp out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_21/libm.so prebuiltlibs/bionic/android_x86_64_sdk_shared_21/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_29/libm.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_29/ && cp out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_29/libm.so prebuiltlibs/bionic/android_x86_64_sdk_shared_29/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_30/libm.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_30/ && cp out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_30/libm.so prebuiltlibs/bionic/android_x86_64_sdk_shared_30/ || true
        [ -e out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_current/libm.so ] && mkdir -p prebuiltlibs/bionic/android_x86_64_sdk_shared_current/ && cp out/soong/.intermediates/bionic/libm/libm.ndk/android_x86_64_sdk_shared_current/libm.so prebuiltlibs/bionic/android_x86_64_sdk_shared_current/ || true
        mkdir -p prebuiltlibs/bionic/libc/async_safe/include && cp -r bionic/libc/async_safe/include/* prebuiltlibs/bionic/libc/async_safe/include
        cp -r out/soong/ninja/bionic prebuiltlibs/bionic/bionic-0
        grep '|bionic' out/soong/module-info.txt >> prebuiltlibs/bionic/MODULES
        du -ad1 bionic | sort -rnk1 > prebuiltlibs/bionic/.SIZE
        popd
    - name: write Android.bp bionic-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_object {\n\tname: \"crtbegin_so\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64: \"android_recovery_x86_64/crtbegin_so.o\",\n\tandroid_vendor_31_x86_64: \"android_vendor.31_x86_64/crtbegin_so.o\",\n\tandroid_vendor_31_x86_x86_64: \"android_vendor.31_x86_x86_64/crtbegin_so.o\",\n\tandroid_x86_64: \"android_x86_64/crtbegin_so.o\",\n\tandroid_x86_64_apex10000: \"android_x86_64_apex10000/crtbegin_so.o\",\n\tandroid_x86_64_apex29: \"android_x86_64_apex29/crtbegin_so.o\",\n\tandroid_x86_64_apex30: \"android_x86_64_apex30/crtbegin_so.o\",\n\tandroid_x86_64_apex31: \"android_x86_64_apex31/crtbegin_so.o\",\n\tandroid_x86_64_sdk_29: \"android_x86_64_sdk_29/crtbegin_so.o\",\n\tandroid_x86_64_sdk_29_apex30: \"android_x86_64_sdk_29_apex30/crtbegin_so.o\",\n\tandroid_x86_64_sdk_30: \"android_x86_64_sdk_30/crtbegin_so.o\",\n\tandroid_x86_64_sdk_30_apex30: \"android_x86_64_sdk_30_apex30/crtbegin_so.o\",\n\tandroid_x86_64_sdk_current: \"android_x86_64_sdk_current/crtbegin_so.o\",\n\tandroid_x86_x86_64: \"android_x86_x86_64/crtbegin_so.o\",\n\tandroid_x86_x86_64_apex10000: \"android_x86_x86_64_apex10000/crtbegin_so.o\",\n\tandroid_x86_x86_64_apex29: \"android_x86_x86_64_apex29/crtbegin_so.o\",\n\tandroid_x86_x86_64_apex30: \"android_x86_x86_64_apex30/crtbegin_so.o\",\n\tandroid_x86_x86_64_apex31: \"android_x86_x86_64_apex31/crtbegin_so.o\",\n\tsrcs: [\"android_recovery_x86_64/crtbegin_so.o\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [],\n\tmin_sdk_version: \"16\", stl: \"none\", apex_available: [\"//apex_available:platform\",\"//apex_available:anyapex\",], \n\tprefer: true,\n}\ncc_prebuilt_object {\n\tname: \"crtend_so\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64: \"android_recovery_x86_64/crtend_so.o\",\n\tandroid_vendor_31_x86_64: \"android_vendor.31_x86_64/crtend_so.o\",\n\tandroid_vendor_31_x86_x86_64: \"android_vendor.31_x86_x86_64/crtend_so.o\",\n\tandroid_x86_64: \"android_x86_64/crtend_so.o\",\n\tandroid_x86_64_apex10000: \"android_x86_64_apex10000/crtend_so.o\",\n\tandroid_x86_64_apex29: \"android_x86_64_apex29/crtend_so.o\",\n\tandroid_x86_64_apex30: \"android_x86_64_apex30/crtend_so.o\",\n\tandroid_x86_64_apex31: \"android_x86_64_apex31/crtend_so.o\",\n\tandroid_x86_64_sdk_29: \"android_x86_64_sdk_29/crtend_so.o\",\n\tandroid_x86_64_sdk_29_apex30: \"android_x86_64_sdk_29_apex30/crtend_so.o\",\n\tandroid_x86_64_sdk_30: \"android_x86_64_sdk_30/crtend_so.o\",\n\tandroid_x86_64_sdk_30_apex30: \"android_x86_64_sdk_30_apex30/crtend_so.o\",\n\tandroid_x86_64_sdk_current: \"android_x86_64_sdk_current/crtend_so.o\",\n\tandroid_x86_x86_64: \"android_x86_x86_64/crtend_so.o\",\n\tandroid_x86_x86_64_apex10000: \"android_x86_x86_64_apex10000/crtend_so.o\",\n\tandroid_x86_x86_64_apex29: \"android_x86_x86_64_apex29/crtend_so.o\",\n\tandroid_x86_x86_64_apex30: \"android_x86_x86_64_apex30/crtend_so.o\",\n\tandroid_x86_x86_64_apex31: \"android_x86_x86_64_apex31/crtend_so.o\",\n\tsrcs: [\"android_recovery_x86_64/crtend_so.o\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [],\n\tmin_sdk_version: \"16\", stl: \"none\", apex_available: [\"//apex_available:platform\",\"//apex_available:anyapex\",], \n\tprefer: true,\n}\ncc_prebuilt_object {\n\tname: \"crtbegin_static\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/crtbegin_static.o\",\n\tandroid_x86_64_apex10000: \"android_x86_64_apex10000/crtbegin_static.o\",\n\tsrcs: [\"android_x86_64/crtbegin_static.o\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tmin_sdk_version: \"current\", stl: \"none\", apex_available: [\"//apex_available:platform\",\"//apex_available:anyapex\",], \n\tprefer: true,\n}\ncc_prebuilt_object {\n\tname: \"crtbegin_dynamic\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64: \"android_recovery_x86_64/crtbegin_dynamic.o\",\n\tandroid_vendor_31_x86_64: \"android_vendor.31_x86_64/crtbegin_dynamic.o\",\n\tandroid_vendor_31_x86_x86_64: \"android_vendor.31_x86_x86_64/crtbegin_dynamic.o\",\n\tandroid_x86_64: \"android_x86_64/crtbegin_dynamic.o\",\n\tandroid_x86_64_apex10000: \"android_x86_64_apex10000/crtbegin_dynamic.o\",\n\tandroid_x86_64_apex29: \"android_x86_64_apex29/crtbegin_dynamic.o\",\n\tandroid_x86_64_apex30: \"android_x86_64_apex30/crtbegin_dynamic.o\",\n\tandroid_x86_64_apex31: \"android_x86_64_apex31/crtbegin_dynamic.o\",\n\tandroid_x86_x86_64: \"android_x86_x86_64/crtbegin_dynamic.o\",\n\tandroid_x86_x86_64_apex10000: \"android_x86_x86_64_apex10000/crtbegin_dynamic.o\",\n\tandroid_x86_x86_64_apex29: \"android_x86_x86_64_apex29/crtbegin_dynamic.o\",\n\tandroid_x86_x86_64_apex31: \"android_x86_x86_64_apex31/crtbegin_dynamic.o\",\n\tsrcs: [\"android_recovery_x86_64/crtbegin_dynamic.o\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [],\n\tmin_sdk_version: \"16\", stl: \"none\", apex_available: [\"//apex_available:platform\",\"//apex_available:anyapex\",], \n\tprefer: true,\n}\ncc_prebuilt_object {\n\tname: \"crtend_android\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64: \"android_recovery_x86_64/crtend_android.o\",\n\tandroid_vendor_31_x86_64: \"android_vendor.31_x86_64/crtend_android.o\",\n\tandroid_vendor_31_x86_x86_64: \"android_vendor.31_x86_x86_64/crtend_android.o\",\n\tandroid_x86_64: \"android_x86_64/crtend_android.o\",\n\tandroid_x86_64_apex10000: \"android_x86_64_apex10000/crtend_android.o\",\n\tandroid_x86_64_apex29: \"android_x86_64_apex29/crtend_android.o\",\n\tandroid_x86_64_apex30: \"android_x86_64_apex30/crtend_android.o\",\n\tandroid_x86_64_apex31: \"android_x86_64_apex31/crtend_android.o\",\n\tandroid_x86_x86_64: \"android_x86_x86_64/crtend_android.o\",\n\tandroid_x86_x86_64_apex10000: \"android_x86_x86_64_apex10000/crtend_android.o\",\n\tandroid_x86_x86_64_apex29: \"android_x86_x86_64_apex29/crtend_android.o\",\n\tandroid_x86_x86_64_apex31: \"android_x86_x86_64_apex31/crtend_android.o\",\n\tsrcs: [\"android_recovery_x86_64/crtend_android.o\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [],\n\tmin_sdk_version: \"16\", stl: \"none\", apex_available: [\"//apex_available:platform\",\"//apex_available:anyapex\",], \n\tprefer: true,\n}\ncc_prebuilt_library_static {\n\tname: \"libasync_safe\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libasync_safe.a\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libasync_safe.a\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libasync_safe.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libasync_safe.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libasync_safe.a\",\n\tandroid_x86_64_static_apex31: \"android_x86_64_static_apex31/libasync_safe.a\",\n\tandroid_x86_64_static_lto_thin: \"android_x86_64_static_lto-thin/libasync_safe.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libasync_safe.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libasync_safe.a\",\n\tandroid_x86_x86_64_static_apex31: \"android_x86_x86_64_static_apex31/libasync_safe.a\",\n\tandroid_x86_x86_64_static_lto_thin: \"android_x86_x86_64_static_lto-thin/libasync_safe.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libasync_safe.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [],\n\tmin_sdk_version: \"apex_inherit\", system_shared_libs: [\"\",], stl: \"none\", apex_available: [\"//apex_available:platform\",\"com.android.runtime\",\"com.android.art\",\"com.android.art.debug\",\"com.android.media\",\"com.android.media.swcodec\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libc/async_safe/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libdl_android\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_shared: \"android_x86_64_shared/libdl_android.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libdl_android.so\",\n\tsrcs: [\"android_x86_64_shared/libdl_android.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"ld-android\"],\n\tsystem_shared_libs: [\"\",], stubs: { versions: [\"current\",], }, stl: \"none\", apex_available: [\"//apex_available:platform\",\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libdl\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libdl.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libdl.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libdl.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libdl.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libdl.so\",\n\tandroid_x86_64_shared_current: \"android_x86_64_shared_current/libdl.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libdl.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libdl.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/libdl.so\",\n\tandroid_x86_x86_64_shared_current: \"android_x86_x86_64_shared_current/libdl.so\",\n\tsrcs: [\"android_x86_64_shared/libdl.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"ld-android\"],\n\tsystem_shared_libs: [\"\",], stubs: { versions: [\"29\",\"current\",], }, stl: \"none\", apex_available: [\"//apex_available:platform\",\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libc\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libc.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libc.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libc.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libc.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libc.so\",\n\tandroid_x86_64_shared_current: \"android_x86_64_shared_current/libc.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libc.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libc.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libc.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/libc.so\",\n\tandroid_x86_x86_64_shared_current: \"android_x86_x86_64_shared_current/libc.so\",\n\tsrcs: [\"android_x86_64_shared/libc.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"ld-android\",\"libdl\"],\n\tsystem_shared_libs: [\"\",], stubs: { versions: [\"29\",\"30\",\"current\",], }, stl: \"none\", apex_available: [\"//apex_available:platform\",\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libstdc++\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_shared: \"android_x86_64_shared/libstdc++.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libstdc++.so\",\n\tsrcs: [\"android_x86_64_shared/libstdc++.so\"],\n\tstatic: { system_shared_libs: [], }, shared: { system_shared_libs: [\"libc\"], },\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\"],\n\tsystem_shared_libs: [\"libc\",], stl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_shared {\n\tname: \"libc.ndk\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tsdk_version: \"minimum\",\n\tsdk_variant_only: true,\n\tandroid_x86_64_sdk_shared_21: \"android_x86_64_sdk_shared_21/libc.ndk.so\",\n\tandroid_x86_64_sdk_shared_29: \"android_x86_64_sdk_shared_29/libc.ndk.so\",\n\tandroid_x86_64_sdk_shared_30: \"android_x86_64_sdk_shared_30/libc.ndk.so\",\n\tandroid_x86_64_sdk_shared_current: \"android_x86_64_sdk_shared_current/libc.ndk.so\",\n\tsrcs: [\"android_x86_64_sdk_shared_21/libc.ndk.so\"],\n\tshared: { system_shared_libs: [], },\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstubs: { versions: [\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"REL\",\"current\",], }, \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_shared {\n\tname: \"libstdc++.ndk\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tsdk_version: \"minimum\",\n\tsdk_variant_only: true,\n\tandroid_x86_64_sdk_shared_21: \"android_x86_64_sdk_shared_21/libstdc++.ndk.so\",\n\tandroid_x86_64_sdk_shared_29: \"android_x86_64_sdk_shared_29/libstdc++.ndk.so\",\n\tandroid_x86_64_sdk_shared_current: \"android_x86_64_sdk_shared_current/libstdc++.ndk.so\",\n\tsrcs: [\"android_x86_64_sdk_shared_21/libstdc++.ndk.so\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstubs: { versions: [\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"REL\",\"current\",], }, \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_shared {\n\tname: \"libdl.ndk\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tsdk_version: \"minimum\",\n\tsdk_variant_only: true,\n\tandroid_x86_64_sdk_shared_21: \"android_x86_64_sdk_shared_21/libdl.ndk.so\",\n\tandroid_x86_64_sdk_shared_29: \"android_x86_64_sdk_shared_29/libdl.ndk.so\",\n\tandroid_x86_64_sdk_shared_30: \"android_x86_64_sdk_shared_30/libdl.ndk.so\",\n\tandroid_x86_64_sdk_shared_current: \"android_x86_64_sdk_shared_current/libdl.ndk.so\",\n\tsrcs: [\"android_x86_64_sdk_shared_21/libdl.ndk.so\"],\n\tshared: { system_shared_libs: [], },\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstubs: { versions: [\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"REL\",\"current\",], }, \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libm\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libm.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libm.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libm.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libm.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libm.so\",\n\tandroid_x86_64_shared_current: \"android_x86_64_shared_current/libm.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libm.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libm.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libm.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/libm.so\",\n\tandroid_x86_x86_64_shared_current: \"android_x86_x86_64_shared_current/libm.so\",\n\tsrcs: [\"android_x86_64_shared/libm.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\"],\n\tsystem_shared_libs: [\"libc\",], stubs: { versions: [\"29\",\"current\",], }, stl: \"none\", apex_available: [\"//apex_available:platform\",\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_shared {\n\tname: \"libm.ndk\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tsdk_version: \"minimum\",\n\tsdk_variant_only: true,\n\tandroid_x86_64_sdk_shared_21: \"android_x86_64_sdk_shared_21/libm.ndk.so\",\n\tandroid_x86_64_sdk_shared_29: \"android_x86_64_sdk_shared_29/libm.ndk.so\",\n\tandroid_x86_64_sdk_shared_30: \"android_x86_64_sdk_shared_30/libm.ndk.so\",\n\tandroid_x86_64_sdk_shared_current: \"android_x86_64_sdk_shared_current/libm.ndk.so\",\n\tsrcs: [\"android_x86_64_sdk_shared_21/libm.ndk.so\"],\n\tshared: { system_shared_libs: [\"libc\"], },\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstubs: { versions: [\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"REL\",\"current\",], }, \n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/bionic/Android.bp
        printf "\n" >> prebuiltlibs/bionic/Android.bp
        popd
    - name: Archive bionic-0
      uses: actions/upload-artifact@v3
      with:
        name: bionic-0
        path: aosp/prebuiltlibs/bionic
  external_libcxxabi-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_libcxxabi-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/libcxxabi/libc++demangle/android_recovery_x86_64_static/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_recovery_x86_64_static_lto-thin/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_64_static/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_64_static_lto-thin/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_x86_64_static/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_x86_64_static_lto-thin/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex10000/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex29/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex30/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex31/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin_apex29/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin_apex30/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin_apex31/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex10000/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex29/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex30/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex31/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_lto-thin/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_lto-thin_apex30/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_lto-thin_apex31/libc++demangle.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_recovery_x86_64_static/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_recovery_x86_64_static_lto-thin/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_64_static/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_64_static_lto-thin/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_x86_64_static/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_x86_64_static_lto-thin/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex10000/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex29/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex30/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex31/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin_apex29/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin_apex30/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin_apex31/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex10000/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex29/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex30/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex31/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_lto-thin/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_lto-thin_apex30/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_lto-thin_apex31/libc++abi.a out/soong/.intermediates/external/libcxxabi/libc++abi/linux_glibc_x86_64_static/libc++abi.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_libcxxabi-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_recovery_x86_64_static/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_recovery_x86_64_static/libc++demangle.a prebuiltlibs/external/libcxxabi/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_recovery_x86_64_static_lto-thin/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_recovery_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_recovery_x86_64_static_lto-thin/libc++demangle.a prebuiltlibs/external/libcxxabi/android_recovery_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_64_static/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_64_static/libc++demangle.a prebuiltlibs/external/libcxxabi/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_64_static_lto-thin/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_vendor.31_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_64_static_lto-thin/libc++demangle.a prebuiltlibs/external/libcxxabi/android_vendor.31_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_x86_64_static/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_x86_64_static/libc++demangle.a prebuiltlibs/external/libcxxabi/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_x86_64_static_lto-thin/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_vendor.31_x86_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_vendor.31_x86_x86_64_static_lto-thin/libc++demangle.a prebuiltlibs/external/libcxxabi/android_vendor.31_x86_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex10000/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex10000/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex29/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_apex29/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex29/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex30/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_apex30/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex30/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex31/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_apex31/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_apex31/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin_apex29/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex29/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin_apex29/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin_apex30/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex30/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin_apex30/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin_apex31/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex31/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_64_static_lto-thin_apex31/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex10000/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex10000/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex29/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex29/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex29/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex30/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex30/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex30/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex31/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex31/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_apex31/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_lto-thin/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_lto-thin/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_lto-thin_apex30/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin_apex30/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_lto-thin_apex30/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_lto-thin_apex31/libc++demangle.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin_apex31/ && cp out/soong/.intermediates/external/libcxxabi/libc++demangle/android_x86_x86_64_static_lto-thin_apex31/libc++demangle.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_recovery_x86_64_static/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_recovery_x86_64_static/libc++abi.a prebuiltlibs/external/libcxxabi/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_recovery_x86_64_static_lto-thin/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_recovery_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_recovery_x86_64_static_lto-thin/libc++abi.a prebuiltlibs/external/libcxxabi/android_recovery_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_64_static/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_64_static/libc++abi.a prebuiltlibs/external/libcxxabi/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_64_static_lto-thin/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_vendor.31_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_64_static_lto-thin/libc++abi.a prebuiltlibs/external/libcxxabi/android_vendor.31_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_x86_64_static/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_x86_64_static/libc++abi.a prebuiltlibs/external/libcxxabi/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_x86_64_static_lto-thin/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_vendor.31_x86_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_vendor.31_x86_x86_64_static_lto-thin/libc++abi.a prebuiltlibs/external/libcxxabi/android_vendor.31_x86_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex10000/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex10000/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex29/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_apex29/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex29/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex30/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_apex30/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex30/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex31/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_apex31/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_apex31/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin_apex29/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex29/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin_apex29/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin_apex30/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex30/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin_apex30/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin_apex31/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex31/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_64_static_lto-thin_apex31/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_64_static_lto-thin_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex10000/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex10000/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex29/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex29/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex29/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex30/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex30/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex30/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex31/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex31/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_apex31/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_lto-thin/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_lto-thin/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_lto-thin_apex30/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin_apex30/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_lto-thin_apex30/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_lto-thin_apex31/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin_apex31/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/android_x86_x86_64_static_lto-thin_apex31/libc++abi.a prebuiltlibs/external/libcxxabi/android_x86_x86_64_static_lto-thin_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxxabi/libc++abi/linux_glibc_x86_64_static/libc++abi.a ] && mkdir -p prebuiltlibs/external/libcxxabi/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/libcxxabi/libc++abi/linux_glibc_x86_64_static/libc++abi.a prebuiltlibs/external/libcxxabi/linux_glibc_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/libcxxabi/include && cp -r external/libcxxabi/include/* prebuiltlibs/external/libcxxabi/include
        cp -r out/soong/ninja/external/libcxxabi prebuiltlibs/external/libcxxabi/external_libcxxabi-0
        grep '|external/libcxxabi' out/soong/module-info.txt >> prebuiltlibs/external/libcxxabi/MODULES
        du -ad1 external/libcxxabi | sort -rnk1 > prebuiltlibs/external/libcxxabi/.SIZE
        popd
    - name: write Android.bp external_libcxxabi-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_static {\n\tname: \"libc++demangle\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libc++demangle.a\",\n\tandroid_recovery_x86_64_static_lto_thin: \"android_recovery_x86_64_static_lto-thin/libc++demangle.a\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libc++demangle.a\",\n\tandroid_vendor_31_x86_64_static_lto_thin: \"android_vendor.31_x86_64_static_lto-thin/libc++demangle.a\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libc++demangle.a\",\n\tandroid_vendor_31_x86_x86_64_static_lto_thin: \"android_vendor.31_x86_x86_64_static_lto-thin/libc++demangle.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libc++demangle.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libc++demangle.a\",\n\tandroid_x86_64_static_apex29: \"android_x86_64_static_apex29/libc++demangle.a\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libc++demangle.a\",\n\tandroid_x86_64_static_apex31: \"android_x86_64_static_apex31/libc++demangle.a\",\n\tandroid_x86_64_static_lto_thin: \"android_x86_64_static_lto-thin/libc++demangle.a\",\n\tandroid_x86_64_static_lto_thin_apex29: \"android_x86_64_static_lto-thin_apex29/libc++demangle.a\",\n\tandroid_x86_64_static_lto_thin_apex30: \"android_x86_64_static_lto-thin_apex30/libc++demangle.a\",\n\tandroid_x86_64_static_lto_thin_apex31: \"android_x86_64_static_lto-thin_apex31/libc++demangle.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libc++demangle.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libc++demangle.a\",\n\tandroid_x86_x86_64_static_apex29: \"android_x86_x86_64_static_apex29/libc++demangle.a\",\n\tandroid_x86_x86_64_static_apex30: \"android_x86_x86_64_static_apex30/libc++demangle.a\",\n\tandroid_x86_x86_64_static_apex31: \"android_x86_x86_64_static_apex31/libc++demangle.a\",\n\tandroid_x86_x86_64_static_lto_thin: \"android_x86_x86_64_static_lto-thin/libc++demangle.a\",\n\tandroid_x86_x86_64_static_lto_thin_apex30: \"android_x86_x86_64_static_lto-thin_apex30/libc++demangle.a\",\n\tandroid_x86_x86_64_static_lto_thin_apex31: \"android_x86_x86_64_static_lto-thin_apex31/libc++demangle.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libc++demangle.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"apex_inherit\", stl: \"none\", apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}\ncc_prebuilt_library_static {\n\tname: \"libc++abi\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libc++abi.a\",\n\tandroid_recovery_x86_64_static_lto_thin: \"android_recovery_x86_64_static_lto-thin/libc++abi.a\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libc++abi.a\",\n\tandroid_vendor_31_x86_64_static_lto_thin: \"android_vendor.31_x86_64_static_lto-thin/libc++abi.a\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libc++abi.a\",\n\tandroid_vendor_31_x86_x86_64_static_lto_thin: \"android_vendor.31_x86_x86_64_static_lto-thin/libc++abi.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libc++abi.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libc++abi.a\",\n\tandroid_x86_64_static_apex29: \"android_x86_64_static_apex29/libc++abi.a\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libc++abi.a\",\n\tandroid_x86_64_static_apex31: \"android_x86_64_static_apex31/libc++abi.a\",\n\tandroid_x86_64_static_lto_thin: \"android_x86_64_static_lto-thin/libc++abi.a\",\n\tandroid_x86_64_static_lto_thin_apex29: \"android_x86_64_static_lto-thin_apex29/libc++abi.a\",\n\tandroid_x86_64_static_lto_thin_apex30: \"android_x86_64_static_lto-thin_apex30/libc++abi.a\",\n\tandroid_x86_64_static_lto_thin_apex31: \"android_x86_64_static_lto-thin_apex31/libc++abi.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libc++abi.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libc++abi.a\",\n\tandroid_x86_x86_64_static_apex29: \"android_x86_x86_64_static_apex29/libc++abi.a\",\n\tandroid_x86_x86_64_static_apex30: \"android_x86_x86_64_static_apex30/libc++abi.a\",\n\tandroid_x86_x86_64_static_apex31: \"android_x86_x86_64_static_apex31/libc++abi.a\",\n\tandroid_x86_x86_64_static_lto_thin: \"android_x86_x86_64_static_lto-thin/libc++abi.a\",\n\tandroid_x86_x86_64_static_lto_thin_apex30: \"android_x86_x86_64_static_lto-thin_apex30/libc++abi.a\",\n\tandroid_x86_x86_64_static_lto_thin_apex31: \"android_x86_x86_64_static_lto-thin_apex31/libc++abi.a\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libc++abi.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libc++abi.a\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"apex_inherit\", stl: \"none\", apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}" >> prebuiltlibs/external/libcxxabi/Android.bp
        printf "\n" >> prebuiltlibs/external/libcxxabi/Android.bp
        popd
    - name: Archive external_libcxxabi-0
      uses: actions/upload-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi
  external_libcxx-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_libcxx-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/libcxx/libc++/android_recovery_x86_64_shared/libc++.so out/soong/.intermediates/external/libcxx/libc++/android_vendor.31_x86_64_shared/libc++.so out/soong/.intermediates/external/libcxx/libc++/android_vendor.31_x86_x86_64_shared/libc++.so out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared/libc++.so out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared_apex10000/libc++.so out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared_apex29/libc++.so out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared_apex31/libc++.so out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared/libc++.so out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared_apex10000/libc++.so out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared_apex29/libc++.so out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared_apex31/libc++.so out/soong/.intermediates/external/libcxx/libc++/linux_glibc_x86_64_shared/libc++.so out/soong/.intermediates/external/libcxx/libc++fs/android_recovery_x86_64_static/libc++fs.a out/soong/.intermediates/external/libcxx/libc++fs/android_x86_64_static/libc++fs.a out/soong/.intermediates/external/libcxx/libc++fs/android_x86_x86_64_static/libc++fs.a out/soong/.intermediates/external/libcxx/libc++fs/linux_glibc_x86_64_static/libc++fs.a out/soong/.intermediates/external/libcxx/libc++_static/android_recovery_x86_64_static/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_recovery_x86_64_static_lto-thin/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_64_static/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_64_static_lto-thin/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_x86_64_static/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_x86_64_static_cfi/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_x86_64_static_lto-thin/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex10000/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex29/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex30/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex31/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi_apex29/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi_lto-thin/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi_lto-thin_apex29/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin_apex29/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin_apex30/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin_apex31/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex10000/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex29/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex30/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex31/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_cfi/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_lto-thin/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_lto-thin_apex30/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_lto-thin_apex31/libc++_static.a out/soong/.intermediates/external/libcxx/libc++_static/linux_glibc_x86_64_static/libc++_static.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_libcxx-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_recovery_x86_64_shared/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/libcxx/libc++/android_recovery_x86_64_shared/libc++.so prebuiltlibs/external/libcxx/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_vendor.31_x86_64_shared/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/libcxx/libc++/android_vendor.31_x86_64_shared/libc++.so prebuiltlibs/external/libcxx/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_vendor.31_x86_x86_64_shared/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libcxx/libc++/android_vendor.31_x86_x86_64_shared/libc++.so prebuiltlibs/external/libcxx/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_shared/ && cp out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared/libc++.so prebuiltlibs/external/libcxx/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared_apex10000/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared_apex10000/libc++.so prebuiltlibs/external/libcxx/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared_apex29/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_shared_apex29/ && cp out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared_apex29/libc++.so prebuiltlibs/external/libcxx/android_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared_apex31/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_shared_apex31/ && cp out/soong/.intermediates/external/libcxx/libc++/android_x86_64_shared_apex31/libc++.so prebuiltlibs/external/libcxx/android_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared/libc++.so prebuiltlibs/external/libcxx/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared_apex10000/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared_apex10000/libc++.so prebuiltlibs/external/libcxx/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared_apex29/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_shared_apex29/ && cp out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared_apex29/libc++.so prebuiltlibs/external/libcxx/android_x86_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared_apex31/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_shared_apex31/ && cp out/soong/.intermediates/external/libcxx/libc++/android_x86_x86_64_shared_apex31/libc++.so prebuiltlibs/external/libcxx/android_x86_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++/linux_glibc_x86_64_shared/libc++.so ] && mkdir -p prebuiltlibs/external/libcxx/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/external/libcxx/libc++/linux_glibc_x86_64_shared/libc++.so prebuiltlibs/external/libcxx/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++fs/android_recovery_x86_64_static/libc++fs.a ] && mkdir -p prebuiltlibs/external/libcxx/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/libcxx/libc++fs/android_recovery_x86_64_static/libc++fs.a prebuiltlibs/external/libcxx/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++fs/android_x86_64_static/libc++fs.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static/ && cp out/soong/.intermediates/external/libcxx/libc++fs/android_x86_64_static/libc++fs.a prebuiltlibs/external/libcxx/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++fs/android_x86_x86_64_static/libc++fs.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/libcxx/libc++fs/android_x86_x86_64_static/libc++fs.a prebuiltlibs/external/libcxx/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++fs/linux_glibc_x86_64_static/libc++fs.a ] && mkdir -p prebuiltlibs/external/libcxx/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/libcxx/libc++fs/linux_glibc_x86_64_static/libc++fs.a prebuiltlibs/external/libcxx/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_recovery_x86_64_static/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_recovery_x86_64_static/libc++_static.a prebuiltlibs/external/libcxx/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_recovery_x86_64_static_lto-thin/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_recovery_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_recovery_x86_64_static_lto-thin/libc++_static.a prebuiltlibs/external/libcxx/android_recovery_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_64_static/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_64_static/libc++_static.a prebuiltlibs/external/libcxx/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_64_static_lto-thin/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_vendor.31_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_64_static_lto-thin/libc++_static.a prebuiltlibs/external/libcxx/android_vendor.31_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_x86_64_static/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_x86_64_static/libc++_static.a prebuiltlibs/external/libcxx/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_x86_64_static_cfi/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_vendor.31_x86_x86_64_static_cfi/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_x86_64_static_cfi/libc++_static.a prebuiltlibs/external/libcxx/android_vendor.31_x86_x86_64_static_cfi/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_x86_64_static_lto-thin/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_vendor.31_x86_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_vendor.31_x86_x86_64_static_lto-thin/libc++_static.a prebuiltlibs/external/libcxx/android_vendor.31_x86_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex10000/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex10000/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex29/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_apex29/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex29/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex30/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_apex30/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex30/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex31/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_apex31/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_apex31/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_cfi/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_cfi/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi_apex29/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_cfi_apex29/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi_apex29/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_cfi_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi_lto-thin/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_cfi_lto-thin/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi_lto-thin/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_cfi_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi_lto-thin_apex29/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_cfi_lto-thin_apex29/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_cfi_lto-thin_apex29/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_cfi_lto-thin_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin_apex29/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_lto-thin_apex29/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin_apex29/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_lto-thin_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin_apex30/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_lto-thin_apex30/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin_apex30/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_lto-thin_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin_apex31/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_64_static_lto-thin_apex31/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_64_static_lto-thin_apex31/libc++_static.a prebuiltlibs/external/libcxx/android_x86_64_static_lto-thin_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static/libc++_static.a prebuiltlibs/external/libcxx/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex10000/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex10000/libc++_static.a prebuiltlibs/external/libcxx/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex29/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_static_apex29/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex29/libc++_static.a prebuiltlibs/external/libcxx/android_x86_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex30/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_static_apex30/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex30/libc++_static.a prebuiltlibs/external/libcxx/android_x86_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex31/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_static_apex31/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_apex31/libc++_static.a prebuiltlibs/external/libcxx/android_x86_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_cfi/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_static_cfi/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_cfi/libc++_static.a prebuiltlibs/external/libcxx/android_x86_x86_64_static_cfi/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_lto-thin/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_static_lto-thin/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_lto-thin/libc++_static.a prebuiltlibs/external/libcxx/android_x86_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_lto-thin_apex30/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_static_lto-thin_apex30/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_lto-thin_apex30/libc++_static.a prebuiltlibs/external/libcxx/android_x86_x86_64_static_lto-thin_apex30/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_lto-thin_apex31/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/android_x86_x86_64_static_lto-thin_apex31/ && cp out/soong/.intermediates/external/libcxx/libc++_static/android_x86_x86_64_static_lto-thin_apex31/libc++_static.a prebuiltlibs/external/libcxx/android_x86_x86_64_static_lto-thin_apex31/ || true
        [ -e out/soong/.intermediates/external/libcxx/libc++_static/linux_glibc_x86_64_static/libc++_static.a ] && mkdir -p prebuiltlibs/external/libcxx/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/libcxx/libc++_static/linux_glibc_x86_64_static/libc++_static.a prebuiltlibs/external/libcxx/linux_glibc_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/libcxx/include && cp -r external/libcxx/include/* prebuiltlibs/external/libcxx/include
        cp -r out/soong/ninja/external/libcxx prebuiltlibs/external/libcxx/external_libcxx-0
        grep '|external/libcxx' out/soong/module-info.txt >> prebuiltlibs/external/libcxx/MODULES
        du -ad1 external/libcxx | sort -rnk1 > prebuiltlibs/external/libcxx/.SIZE
        popd
    - name: write Android.bp external_libcxx-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_shared {\n\tname: \"libc++\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libc++.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libc++.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libc++.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libc++.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libc++.so\",\n\tandroid_x86_64_shared_apex29: \"android_x86_64_shared_apex29/libc++.so\",\n\tandroid_x86_64_shared_apex31: \"android_x86_64_shared_apex31/libc++.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libc++.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/libc++.so\",\n\tandroid_x86_x86_64_shared_apex29: \"android_x86_x86_64_shared_apex29/libc++.so\",\n\tandroid_x86_x86_64_shared_apex31: \"android_x86_x86_64_shared_apex31/libc++.so\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libc++.so\",\n\tsrcs: [\"android_x86_64_shared/libc++.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"apex_inherit\", stl: \"none\", vndk: { enabled: true, }, apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_static {\n\tname: \"libc++fs\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libc++fs.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libc++fs.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libc++fs.a\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libc++fs.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libc++fs.a\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tstl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}\ncc_prebuilt_library_static {\n\tname: \"libc++_static\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libc++_static.a\",\n\tandroid_recovery_x86_64_static_lto_thin: \"android_recovery_x86_64_static_lto-thin/libc++_static.a\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libc++_static.a\",\n\tandroid_vendor_31_x86_64_static_lto_thin: \"android_vendor.31_x86_64_static_lto-thin/libc++_static.a\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libc++_static.a\",\n\tandroid_vendor_31_x86_x86_64_static_cfi: \"android_vendor.31_x86_x86_64_static_cfi/libc++_static.a\",\n\tandroid_vendor_31_x86_x86_64_static_lto_thin: \"android_vendor.31_x86_x86_64_static_lto-thin/libc++_static.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libc++_static.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libc++_static.a\",\n\tandroid_x86_64_static_apex29: \"android_x86_64_static_apex29/libc++_static.a\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libc++_static.a\",\n\tandroid_x86_64_static_apex31: \"android_x86_64_static_apex31/libc++_static.a\",\n\tandroid_x86_64_static_cfi: \"android_x86_64_static_cfi/libc++_static.a\",\n\tandroid_x86_64_static_cfi_apex29: \"android_x86_64_static_cfi_apex29/libc++_static.a\",\n\tandroid_x86_64_static_cfi_lto_thin: \"android_x86_64_static_cfi_lto-thin/libc++_static.a\",\n\tandroid_x86_64_static_cfi_lto_thin_apex29: \"android_x86_64_static_cfi_lto-thin_apex29/libc++_static.a\",\n\tandroid_x86_64_static_lto_thin: \"android_x86_64_static_lto-thin/libc++_static.a\",\n\tandroid_x86_64_static_lto_thin_apex29: \"android_x86_64_static_lto-thin_apex29/libc++_static.a\",\n\tandroid_x86_64_static_lto_thin_apex30: \"android_x86_64_static_lto-thin_apex30/libc++_static.a\",\n\tandroid_x86_64_static_lto_thin_apex31: \"android_x86_64_static_lto-thin_apex31/libc++_static.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libc++_static.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libc++_static.a\",\n\tandroid_x86_x86_64_static_apex29: \"android_x86_x86_64_static_apex29/libc++_static.a\",\n\tandroid_x86_x86_64_static_apex30: \"android_x86_x86_64_static_apex30/libc++_static.a\",\n\tandroid_x86_x86_64_static_apex31: \"android_x86_x86_64_static_apex31/libc++_static.a\",\n\tandroid_x86_x86_64_static_cfi: \"android_x86_x86_64_static_cfi/libc++_static.a\",\n\tandroid_x86_x86_64_static_lto_thin: \"android_x86_x86_64_static_lto-thin/libc++_static.a\",\n\tandroid_x86_x86_64_static_lto_thin_apex30: \"android_x86_x86_64_static_lto-thin_apex30/libc++_static.a\",\n\tandroid_x86_x86_64_static_lto_thin_apex31: \"android_x86_x86_64_static_lto-thin_apex31/libc++_static.a\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libc++_static.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libc++_static.a\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"apex_inherit\", stl: \"none\", apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}" >> prebuiltlibs/external/libcxx/Android.bp
        printf "\n" >> prebuiltlibs/external/libcxx/Android.bp
        popd
    - name: Archive external_libcxx-0
      uses: actions/upload-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx
  external_gwp_asan-1:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_gwp_asan-1
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_recovery_x86_64_static/gwp_asan_crash_handler.a out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_64_static/gwp_asan_crash_handler.a out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_64_static_apex10000/gwp_asan_crash_handler.a out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_x86_64_static/gwp_asan_crash_handler.a out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_x86_64_static_apex10000/gwp_asan_crash_handler.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_gwp_asan-1
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_recovery_x86_64_static/gwp_asan_crash_handler.a ] && mkdir -p prebuiltlibs/external/gwp_asan/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_recovery_x86_64_static/gwp_asan_crash_handler.a prebuiltlibs/external/gwp_asan/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_64_static/gwp_asan_crash_handler.a ] && mkdir -p prebuiltlibs/external/gwp_asan/android_x86_64_static/ && cp out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_64_static/gwp_asan_crash_handler.a prebuiltlibs/external/gwp_asan/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_64_static_apex10000/gwp_asan_crash_handler.a ] && mkdir -p prebuiltlibs/external/gwp_asan/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_64_static_apex10000/gwp_asan_crash_handler.a prebuiltlibs/external/gwp_asan/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_x86_64_static/gwp_asan_crash_handler.a ] && mkdir -p prebuiltlibs/external/gwp_asan/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_x86_64_static/gwp_asan_crash_handler.a prebuiltlibs/external/gwp_asan/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_x86_64_static_apex10000/gwp_asan_crash_handler.a ] && mkdir -p prebuiltlibs/external/gwp_asan/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/gwp_asan/gwp_asan_crash_handler/android_x86_x86_64_static_apex10000/gwp_asan_crash_handler.a prebuiltlibs/external/gwp_asan/android_x86_x86_64_static_apex10000/ || true
        cp -r out/soong/ninja/external/gwp_asan prebuiltlibs/external/gwp_asan/external_gwp_asan-1
        grep '|external/gwp_asan' out/soong/module-info.txt >> prebuiltlibs/external/gwp_asan/MODULES
        du -ad1 external/gwp_asan | sort -rnk1 > prebuiltlibs/external/gwp_asan/.SIZE
        popd
    - name: write Android.bp external_gwp_asan-1
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"gwp_asan_crash_handler\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/gwp_asan_crash_handler.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/gwp_asan_crash_handler.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/gwp_asan_crash_handler.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/gwp_asan_crash_handler.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/gwp_asan_crash_handler.a\",\n\tsrcs: [\"android_recovery_x86_64_static/gwp_asan_crash_handler.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"S\", apex_available: [\"//apex_available:platform\",\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/gwp_asan/Android.bp
        printf "\n" >> prebuiltlibs/external/gwp_asan/Android.bp
        popd
    - name: Archive external_gwp_asan-1
      uses: actions/upload-artifact@v3
      with:
        name: external_gwp_asan-1
        path: aosp/prebuiltlibs/external/gwp_asan
  external_rust_crates_either-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/either
      id: external_rust_crates_either
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/either"
        key: "external_rust_crates_either@$BRANCH"
        restore-keys: "external_rust_crates_either@$BRANCH"
    - name: Clone project external/rust/crates/either
      if: steps.external_rust_crates_either.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/either
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_either-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/either/libeither/linux_glibc_x86_64_rlib_rlib-std/libeither.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_either-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/either/libeither/linux_glibc_x86_64_rlib_rlib-std/libeither.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/either/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/either/libeither/linux_glibc_x86_64_rlib_rlib-std/libeither.rlib prebuiltlibs/external/rust/crates/either/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/either prebuiltlibs/external/rust/crates/either/external_rust_crates_either-0
        grep '|external/rust/crates/either' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/either/MODULES
        du -ad1 external/rust/crates/either | sort -rnk1 > prebuiltlibs/external/rust/crates/either/.SIZE
        popd
    - name: write Android.bp external_rust_crates_either-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"libeither\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/libeither.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/libeither.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/either/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/either/Android.bp
        popd
    - name: Archive external_rust_crates_either-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_either-0
        path: aosp/prebuiltlibs/external/rust/crates/either
  external_rust_crates_glob-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/glob
      id: external_rust_crates_glob
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/glob"
        key: "external_rust_crates_glob@$BRANCH"
        restore-keys: "external_rust_crates_glob@$BRANCH"
    - name: Clone project external/rust/crates/glob
      if: steps.external_rust_crates_glob.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/glob
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_glob-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/glob/libglob/linux_glibc_x86_64_rlib_rlib-std/libglob.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_glob-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/glob/libglob/linux_glibc_x86_64_rlib_rlib-std/libglob.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/glob/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/glob/libglob/linux_glibc_x86_64_rlib_rlib-std/libglob.rlib prebuiltlibs/external/rust/crates/glob/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/glob prebuiltlibs/external/rust/crates/glob/external_rust_crates_glob-0
        grep '|external/rust/crates/glob' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/glob/MODULES
        du -ad1 external/rust/crates/glob | sort -rnk1 > prebuiltlibs/external/rust/crates/glob/.SIZE
        popd
    - name: write Android.bp external_rust_crates_glob-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"libglob\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/libglob.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/libglob.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/glob/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/glob/Android.bp
        popd
    - name: Archive external_rust_crates_glob-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_glob-0
        path: aosp/prebuiltlibs/external/rust/crates/glob
  external_rust_crates_lazycell-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/lazycell
      id: external_rust_crates_lazycell
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/lazycell"
        key: "external_rust_crates_lazycell@$BRANCH"
        restore-keys: "external_rust_crates_lazycell@$BRANCH"
    - name: Clone project external/rust/crates/lazycell
      if: steps.external_rust_crates_lazycell.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/lazycell
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_lazycell-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/lazycell/liblazycell/linux_glibc_x86_64_rlib_rlib-std/liblazycell.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_lazycell-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/lazycell/liblazycell/linux_glibc_x86_64_rlib_rlib-std/liblazycell.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/lazycell/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/lazycell/liblazycell/linux_glibc_x86_64_rlib_rlib-std/liblazycell.rlib prebuiltlibs/external/rust/crates/lazycell/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/lazycell prebuiltlibs/external/rust/crates/lazycell/external_rust_crates_lazycell-0
        grep '|external/rust/crates/lazycell' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/lazycell/MODULES
        du -ad1 external/rust/crates/lazycell | sort -rnk1 > prebuiltlibs/external/rust/crates/lazycell/.SIZE
        popd
    - name: write Android.bp external_rust_crates_lazycell-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"liblazycell\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/liblazycell.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/liblazycell.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/lazycell/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/lazycell/Android.bp
        popd
    - name: Archive external_rust_crates_lazycell-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_lazycell-0
        path: aosp/prebuiltlibs/external/rust/crates/lazycell
  external_rust_crates_paste-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/paste
      id: external_rust_crates_paste
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/paste"
        key: "external_rust_crates_paste@$BRANCH"
        restore-keys: "external_rust_crates_paste@$BRANCH"
    - name: Clone project external/rust/crates/paste
      if: steps.external_rust_crates_paste.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/paste
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_paste-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/paste/libpaste/linux_glibc_x86_64/libpaste.so)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_paste-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/paste/libpaste/linux_glibc_x86_64/libpaste.so ] && mkdir -p prebuiltlibs/external/rust/crates/paste/linux_glibc_x86_64/ && cp out/soong/.intermediates/external/rust/crates/paste/libpaste/linux_glibc_x86_64/libpaste.so prebuiltlibs/external/rust/crates/paste/linux_glibc_x86_64/ || true
        cp -r out/soong/ninja/external/rust/crates/paste prebuiltlibs/external/rust/crates/paste/external_rust_crates_paste-0
        grep '|external/rust/crates/paste' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/paste/MODULES
        du -ad1 external/rust/crates/paste | sort -rnk1 > prebuiltlibs/external/rust/crates/paste/.SIZE
        popd
    - name: write Android.bp external_rust_crates_paste-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_proc_macro {\n\tname: \"libpaste\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64: \"linux_glibc_x86_64/libpaste.so\",\n\tsrcs: [\"linux_glibc_x86_64/libpaste.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/paste/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/paste/Android.bp
        popd
    - name: Archive external_rust_crates_paste-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_paste-0
        path: aosp/prebuiltlibs/external/rust/crates/paste
  external_rust_crates_peeking_take_while-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/peeking_take_while
      id: external_rust_crates_peeking_take_while
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/peeking_take_while"
        key: "external_rust_crates_peeking_take_while@$BRANCH"
        restore-keys: "external_rust_crates_peeking_take_while@$BRANCH"
    - name: Clone project external/rust/crates/peeking_take_while
      if: steps.external_rust_crates_peeking_take_while.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/peeking_take_while
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_peeking_take_while-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/peeking_take_while/libpeeking_take_while/linux_glibc_x86_64_rlib_rlib-std/libpeeking_take_while.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_peeking_take_while-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/peeking_take_while/libpeeking_take_while/linux_glibc_x86_64_rlib_rlib-std/libpeeking_take_while.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/peeking_take_while/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/peeking_take_while/libpeeking_take_while/linux_glibc_x86_64_rlib_rlib-std/libpeeking_take_while.rlib prebuiltlibs/external/rust/crates/peeking_take_while/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/peeking_take_while prebuiltlibs/external/rust/crates/peeking_take_while/external_rust_crates_peeking_take_while-0
        grep '|external/rust/crates/peeking_take_while' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/peeking_take_while/MODULES
        du -ad1 external/rust/crates/peeking_take_while | sort -rnk1 > prebuiltlibs/external/rust/crates/peeking_take_while/.SIZE
        popd
    - name: write Android.bp external_rust_crates_peeking_take_while-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"libpeeking_take_while\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/libpeeking_take_while.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/libpeeking_take_while.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/peeking_take_while/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/peeking_take_while/Android.bp
        popd
    - name: Archive external_rust_crates_peeking_take_while-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_peeking_take_while-0
        path: aosp/prebuiltlibs/external/rust/crates/peeking_take_while
  external_rust_crates_proc-macro-hack-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/proc-macro-hack
      id: external_rust_crates_proc-macro-hack
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/proc-macro-hack"
        key: "external_rust_crates_proc-macro-hack@$BRANCH"
        restore-keys: "external_rust_crates_proc-macro-hack@$BRANCH"
    - name: Clone project external/rust/crates/proc-macro-hack
      if: steps.external_rust_crates_proc-macro-hack.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/proc-macro-hack
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_proc-macro-hack-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/proc-macro-hack/libproc_macro_hack/linux_glibc_x86_64/libproc_macro_hack.so)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_proc-macro-hack-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/proc-macro-hack/libproc_macro_hack/linux_glibc_x86_64/libproc_macro_hack.so ] && mkdir -p prebuiltlibs/external/rust/crates/proc-macro-hack/linux_glibc_x86_64/ && cp out/soong/.intermediates/external/rust/crates/proc-macro-hack/libproc_macro_hack/linux_glibc_x86_64/libproc_macro_hack.so prebuiltlibs/external/rust/crates/proc-macro-hack/linux_glibc_x86_64/ || true
        cp -r out/soong/ninja/external/rust/crates/proc-macro-hack prebuiltlibs/external/rust/crates/proc-macro-hack/external_rust_crates_proc-macro-hack-0
        grep '|external/rust/crates/proc-macro-hack' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/proc-macro-hack/MODULES
        du -ad1 external/rust/crates/proc-macro-hack | sort -rnk1 > prebuiltlibs/external/rust/crates/proc-macro-hack/.SIZE
        popd
    - name: write Android.bp external_rust_crates_proc-macro-hack-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_proc_macro {\n\tname: \"libproc_macro_hack\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64: \"linux_glibc_x86_64/libproc_macro_hack.so\",\n\tsrcs: [\"linux_glibc_x86_64/libproc_macro_hack.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/proc-macro-hack/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/proc-macro-hack/Android.bp
        popd
    - name: Archive external_rust_crates_proc-macro-hack-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_proc-macro-hack-0
        path: aosp/prebuiltlibs/external/rust/crates/proc-macro-hack
  external_rust_crates_regex-syntax-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/regex-syntax
      id: external_rust_crates_regex-syntax
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/regex-syntax"
        key: "external_rust_crates_regex-syntax@$BRANCH"
        restore-keys: "external_rust_crates_regex-syntax@$BRANCH"
    - name: Clone project external/rust/crates/regex-syntax
      if: steps.external_rust_crates_regex-syntax.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/regex-syntax
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_regex-syntax-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/regex-syntax/libregex_syntax/linux_glibc_x86_64_rlib_rlib-std/libregex_syntax.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_regex-syntax-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/regex-syntax/libregex_syntax/linux_glibc_x86_64_rlib_rlib-std/libregex_syntax.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/regex-syntax/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/regex-syntax/libregex_syntax/linux_glibc_x86_64_rlib_rlib-std/libregex_syntax.rlib prebuiltlibs/external/rust/crates/regex-syntax/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/regex-syntax prebuiltlibs/external/rust/crates/regex-syntax/external_rust_crates_regex-syntax-0
        grep '|external/rust/crates/regex-syntax' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/regex-syntax/MODULES
        du -ad1 external/rust/crates/regex-syntax | sort -rnk1 > prebuiltlibs/external/rust/crates/regex-syntax/.SIZE
        popd
    - name: write Android.bp external_rust_crates_regex-syntax-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"libregex_syntax\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/libregex_syntax.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/libregex_syntax.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/regex-syntax/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/regex-syntax/Android.bp
        popd
    - name: Archive external_rust_crates_regex-syntax-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_regex-syntax-0
        path: aosp/prebuiltlibs/external/rust/crates/regex-syntax
  external_rust_crates_rustc-hash-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/rustc-hash
      id: external_rust_crates_rustc-hash
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/rustc-hash"
        key: "external_rust_crates_rustc-hash@$BRANCH"
        restore-keys: "external_rust_crates_rustc-hash@$BRANCH"
    - name: Clone project external/rust/crates/rustc-hash
      if: steps.external_rust_crates_rustc-hash.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/rustc-hash
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_rustc-hash-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/rustc-hash/librustc_hash/linux_glibc_x86_64_rlib_rlib-std/librustc_hash.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_rustc-hash-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/rustc-hash/librustc_hash/linux_glibc_x86_64_rlib_rlib-std/librustc_hash.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/rustc-hash/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/rustc-hash/librustc_hash/linux_glibc_x86_64_rlib_rlib-std/librustc_hash.rlib prebuiltlibs/external/rust/crates/rustc-hash/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/rustc-hash prebuiltlibs/external/rust/crates/rustc-hash/external_rust_crates_rustc-hash-0
        grep '|external/rust/crates/rustc-hash' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/rustc-hash/MODULES
        du -ad1 external/rust/crates/rustc-hash | sort -rnk1 > prebuiltlibs/external/rust/crates/rustc-hash/.SIZE
        popd
    - name: write Android.bp external_rust_crates_rustc-hash-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"librustc_hash\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/librustc_hash.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/librustc_hash.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/rustc-hash/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/rustc-hash/Android.bp
        popd
    - name: Archive external_rust_crates_rustc-hash-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_rustc-hash-0
        path: aosp/prebuiltlibs/external/rust/crates/rustc-hash
  external_rust_crates_shlex-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/shlex
      id: external_rust_crates_shlex
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/shlex"
        key: "external_rust_crates_shlex@$BRANCH"
        restore-keys: "external_rust_crates_shlex@$BRANCH"
    - name: Clone project external/rust/crates/shlex
      if: steps.external_rust_crates_shlex.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/shlex
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_shlex-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/shlex/libshlex/linux_glibc_x86_64_rlib_rlib-std/libshlex.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_shlex-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/shlex/libshlex/linux_glibc_x86_64_rlib_rlib-std/libshlex.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/shlex/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/shlex/libshlex/linux_glibc_x86_64_rlib_rlib-std/libshlex.rlib prebuiltlibs/external/rust/crates/shlex/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/shlex prebuiltlibs/external/rust/crates/shlex/external_rust_crates_shlex-0
        grep '|external/rust/crates/shlex' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/shlex/MODULES
        du -ad1 external/rust/crates/shlex | sort -rnk1 > prebuiltlibs/external/rust/crates/shlex/.SIZE
        popd
    - name: write Android.bp external_rust_crates_shlex-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"libshlex\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/libshlex.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/libshlex.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/shlex/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/shlex/Android.bp
        popd
    - name: Archive external_rust_crates_shlex-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_shlex-0
        path: aosp/prebuiltlibs/external/rust/crates/shlex
  external_rust_crates_termcolor-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/termcolor
      id: external_rust_crates_termcolor
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/termcolor"
        key: "external_rust_crates_termcolor@$BRANCH"
        restore-keys: "external_rust_crates_termcolor@$BRANCH"
    - name: Clone project external/rust/crates/termcolor
      if: steps.external_rust_crates_termcolor.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/termcolor
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_termcolor-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/termcolor/libtermcolor/linux_glibc_x86_64_rlib_rlib-std/libtermcolor.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_termcolor-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/termcolor/libtermcolor/linux_glibc_x86_64_rlib_rlib-std/libtermcolor.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/termcolor/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/termcolor/libtermcolor/linux_glibc_x86_64_rlib_rlib-std/libtermcolor.rlib prebuiltlibs/external/rust/crates/termcolor/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/termcolor prebuiltlibs/external/rust/crates/termcolor/external_rust_crates_termcolor-0
        grep '|external/rust/crates/termcolor' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/termcolor/MODULES
        du -ad1 external/rust/crates/termcolor | sort -rnk1 > prebuiltlibs/external/rust/crates/termcolor/.SIZE
        popd
    - name: write Android.bp external_rust_crates_termcolor-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"libtermcolor\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/libtermcolor.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/libtermcolor.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/termcolor/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/termcolor/Android.bp
        popd
    - name: Archive external_rust_crates_termcolor-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_termcolor-0
        path: aosp/prebuiltlibs/external/rust/crates/termcolor
  external_rust_crates_textwrap-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/textwrap
      id: external_rust_crates_textwrap
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/textwrap"
        key: "external_rust_crates_textwrap@$BRANCH"
        restore-keys: "external_rust_crates_textwrap@$BRANCH"
    - name: Clone project external/rust/crates/textwrap
      if: steps.external_rust_crates_textwrap.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/textwrap
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_textwrap-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/textwrap/libtextwrap/linux_glibc_x86_64_rlib_rlib-std/libtextwrap.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_textwrap-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/textwrap/libtextwrap/linux_glibc_x86_64_rlib_rlib-std/libtextwrap.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/textwrap/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/textwrap/libtextwrap/linux_glibc_x86_64_rlib_rlib-std/libtextwrap.rlib prebuiltlibs/external/rust/crates/textwrap/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/textwrap prebuiltlibs/external/rust/crates/textwrap/external_rust_crates_textwrap-0
        grep '|external/rust/crates/textwrap' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/textwrap/MODULES
        du -ad1 external/rust/crates/textwrap | sort -rnk1 > prebuiltlibs/external/rust/crates/textwrap/.SIZE
        popd
    - name: write Android.bp external_rust_crates_textwrap-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"libtextwrap\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/libtextwrap.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/libtextwrap.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tapex_available: [\"//apex_available:platform\",\"com.android.virt\",], \n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/textwrap/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/textwrap/Android.bp
        popd
    - name: Archive external_rust_crates_textwrap-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_textwrap-0
        path: aosp/prebuiltlibs/external/rust/crates/textwrap
  external_rust_crates_unicode-width-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/unicode-width
      id: external_rust_crates_unicode-width
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/unicode-width"
        key: "external_rust_crates_unicode-width@$BRANCH"
        restore-keys: "external_rust_crates_unicode-width@$BRANCH"
    - name: Clone project external/rust/crates/unicode-width
      if: steps.external_rust_crates_unicode-width.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/unicode-width
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_unicode-width-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/unicode-width/libunicode_width/linux_glibc_x86_64_rlib_rlib-std/libunicode_width.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_unicode-width-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/unicode-width/libunicode_width/linux_glibc_x86_64_rlib_rlib-std/libunicode_width.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/unicode-width/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/unicode-width/libunicode_width/linux_glibc_x86_64_rlib_rlib-std/libunicode_width.rlib prebuiltlibs/external/rust/crates/unicode-width/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/unicode-width prebuiltlibs/external/rust/crates/unicode-width/external_rust_crates_unicode-width-0
        grep '|external/rust/crates/unicode-width' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/unicode-width/MODULES
        du -ad1 external/rust/crates/unicode-width | sort -rnk1 > prebuiltlibs/external/rust/crates/unicode-width/.SIZE
        popd
    - name: write Android.bp external_rust_crates_unicode-width-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"libunicode_width\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/libunicode_width.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/libunicode_width.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/unicode-width/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/unicode-width/Android.bp
        popd
    - name: Archive external_rust_crates_unicode-width-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_unicode-width-0
        path: aosp/prebuiltlibs/external/rust/crates/unicode-width
  external_rust_crates_unicode-xid-0:
    runs-on: ubuntu-latest
    needs: [clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Restore Cache external/rust/crates/unicode-xid
      id: external_rust_crates_unicode-xid
      uses: actions/cache@v3
      with:
        path: "aosp/external/rust/crates/unicode-xid"
        key: "external_rust_crates_unicode-xid@$BRANCH"
        restore-keys: "external_rust_crates_unicode-xid@$BRANCH"
    - name: Clone project external/rust/crates/unicode-xid
      if: steps.external_rust_crates_unicode-xid.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/rust/crates/unicode-xid
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_rust_crates_unicode-xid-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/rust/crates/unicode-xid/libunicode_xid/linux_glibc_x86_64_rlib_rlib-std/libunicode_xid.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_rust_crates_unicode-xid-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/rust/crates/unicode-xid/libunicode_xid/linux_glibc_x86_64_rlib_rlib-std/libunicode_xid.rlib ] && mkdir -p prebuiltlibs/external/rust/crates/unicode-xid/linux_glibc_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/rust/crates/unicode-xid/libunicode_xid/linux_glibc_x86_64_rlib_rlib-std/libunicode_xid.rlib prebuiltlibs/external/rust/crates/unicode-xid/linux_glibc_x86_64_rlib_rlib-std/ || true
        cp -r out/soong/ninja/external/rust/crates/unicode-xid prebuiltlibs/external/rust/crates/unicode-xid/external_rust_crates_unicode-xid-0
        grep '|external/rust/crates/unicode-xid' out/soong/module-info.txt >> prebuiltlibs/external/rust/crates/unicode-xid/MODULES
        du -ad1 external/rust/crates/unicode-xid | sort -rnk1 > prebuiltlibs/external/rust/crates/unicode-xid/.SIZE
        popd
    - name: write Android.bp external_rust_crates_unicode-xid-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"libunicode_xid\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_rlib_rlib_std: \"linux_glibc_x86_64_rlib_rlib-std/libunicode_xid.rlib\",\n\tsrcs: [\"linux_glibc_x86_64_rlib_rlib-std/libunicode_xid.rlib\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/rust/crates/unicode-xid/Android.bp
        printf "\n" >> prebuiltlibs/external/rust/crates/unicode-xid/Android.bp
        popd
    - name: Archive external_rust_crates_unicode-xid-0
      uses: actions/upload-artifact@v3
      with:
        name: external_rust_crates_unicode-xid-0
        path: aosp/prebuiltlibs/external/rust/crates/unicode-xid
  system_logging-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target system_logging-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/system/logging/liblog/liblog/android_recovery_x86_64_shared/liblog.so out/soong/.intermediates/system/logging/liblog/liblog/android_recovery_x86_64_static/liblog.a out/soong/.intermediates/system/logging/liblog/liblog/android_vendor.31_x86_64_shared/liblog.so out/soong/.intermediates/system/logging/liblog/liblog/android_vendor.31_x86_x86_64_shared/liblog.so out/soong/.intermediates/system/logging/liblog/liblog/android_x86_64_shared/liblog.so out/soong/.intermediates/system/logging/liblog/liblog/android_x86_64_static/liblog.a out/soong/.intermediates/system/logging/liblog/liblog/android_x86_64_static_apex10000/liblog.a out/soong/.intermediates/system/logging/liblog/liblog/android_x86_x86_64_shared/liblog.so out/soong/.intermediates/system/logging/liblog/liblog/android_x86_x86_64_static/liblog.a out/soong/.intermediates/system/logging/liblog/liblog/android_x86_x86_64_static_apex10000/liblog.a out/soong/.intermediates/system/logging/liblog/liblog/linux_glibc_x86_64_shared/liblog.so out/soong/.intermediates/system/logging/liblog/liblog/linux_glibc_x86_64_static/liblog.a out/soong/.intermediates/system/logging/liblog/liblog.ndk/android_x86_64_sdk_shared_21/liblog.so out/soong/.intermediates/system/logging/liblog/liblog.ndk/android_x86_64_sdk_shared_29/liblog.so out/soong/.intermediates/system/logging/liblog/liblog.ndk/android_x86_64_sdk_shared_current/liblog.so)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target system_logging-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/android_recovery_x86_64_shared/liblog.so ] && mkdir -p prebuiltlibs/system/logging/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/logging/liblog/liblog/android_recovery_x86_64_shared/liblog.so prebuiltlibs/system/logging/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/android_recovery_x86_64_static/liblog.a ] && mkdir -p prebuiltlibs/system/logging/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/logging/liblog/liblog/android_recovery_x86_64_static/liblog.a prebuiltlibs/system/logging/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/android_vendor.31_x86_64_shared/liblog.so ] && mkdir -p prebuiltlibs/system/logging/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/logging/liblog/liblog/android_vendor.31_x86_64_shared/liblog.so prebuiltlibs/system/logging/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/android_vendor.31_x86_x86_64_shared/liblog.so ] && mkdir -p prebuiltlibs/system/logging/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/logging/liblog/liblog/android_vendor.31_x86_x86_64_shared/liblog.so prebuiltlibs/system/logging/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/android_x86_64_shared/liblog.so ] && mkdir -p prebuiltlibs/system/logging/android_x86_64_shared/ && cp out/soong/.intermediates/system/logging/liblog/liblog/android_x86_64_shared/liblog.so prebuiltlibs/system/logging/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/android_x86_64_static/liblog.a ] && mkdir -p prebuiltlibs/system/logging/android_x86_64_static/ && cp out/soong/.intermediates/system/logging/liblog/liblog/android_x86_64_static/liblog.a prebuiltlibs/system/logging/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/android_x86_64_static_apex10000/liblog.a ] && mkdir -p prebuiltlibs/system/logging/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/logging/liblog/liblog/android_x86_64_static_apex10000/liblog.a prebuiltlibs/system/logging/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/android_x86_x86_64_shared/liblog.so ] && mkdir -p prebuiltlibs/system/logging/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/logging/liblog/liblog/android_x86_x86_64_shared/liblog.so prebuiltlibs/system/logging/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/android_x86_x86_64_static/liblog.a ] && mkdir -p prebuiltlibs/system/logging/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/logging/liblog/liblog/android_x86_x86_64_static/liblog.a prebuiltlibs/system/logging/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/android_x86_x86_64_static_apex10000/liblog.a ] && mkdir -p prebuiltlibs/system/logging/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/logging/liblog/liblog/android_x86_x86_64_static_apex10000/liblog.a prebuiltlibs/system/logging/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/linux_glibc_x86_64_shared/liblog.so ] && mkdir -p prebuiltlibs/system/logging/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/system/logging/liblog/liblog/linux_glibc_x86_64_shared/liblog.so prebuiltlibs/system/logging/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog/linux_glibc_x86_64_static/liblog.a ] && mkdir -p prebuiltlibs/system/logging/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/system/logging/liblog/liblog/linux_glibc_x86_64_static/liblog.a prebuiltlibs/system/logging/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog.ndk/android_x86_64_sdk_shared_21/liblog.so ] && mkdir -p prebuiltlibs/system/logging/android_x86_64_sdk_shared_21/ && cp out/soong/.intermediates/system/logging/liblog/liblog.ndk/android_x86_64_sdk_shared_21/liblog.so prebuiltlibs/system/logging/android_x86_64_sdk_shared_21/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog.ndk/android_x86_64_sdk_shared_29/liblog.so ] && mkdir -p prebuiltlibs/system/logging/android_x86_64_sdk_shared_29/ && cp out/soong/.intermediates/system/logging/liblog/liblog.ndk/android_x86_64_sdk_shared_29/liblog.so prebuiltlibs/system/logging/android_x86_64_sdk_shared_29/ || true
        [ -e out/soong/.intermediates/system/logging/liblog/liblog.ndk/android_x86_64_sdk_shared_current/liblog.so ] && mkdir -p prebuiltlibs/system/logging/android_x86_64_sdk_shared_current/ && cp out/soong/.intermediates/system/logging/liblog/liblog.ndk/android_x86_64_sdk_shared_current/liblog.so prebuiltlibs/system/logging/android_x86_64_sdk_shared_current/ || true
        cp -r out/soong/ninja/system/logging prebuiltlibs/system/logging/system_logging-0
        grep '|system/logging' out/soong/module-info.txt >> prebuiltlibs/system/logging/MODULES
        du -ad1 system/logging | sort -rnk1 > prebuiltlibs/system/logging/.SIZE
        popd
    - name: write Android.bp system_logging-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"liblog\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/liblog.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/liblog.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/liblog.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/liblog.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/liblog.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/liblog.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/liblog.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/liblog.so\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/liblog.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/liblog.a\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/liblog.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/liblog.a\",\n\tsrcs: [\"android_x86_64_shared/liblog.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tstubs: { versions: [\"29\",\"30\",\"current\",], }, apex_available: [\"//apex_available:platform\",\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_shared {\n\tname: \"liblog.ndk\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tsdk_version: \"minimum\",\n\tsdk_variant_only: true,\n\tandroid_x86_64_sdk_shared_21: \"android_x86_64_sdk_shared_21/liblog.ndk.so\",\n\tandroid_x86_64_sdk_shared_29: \"android_x86_64_sdk_shared_29/liblog.ndk.so\",\n\tandroid_x86_64_sdk_shared_current: \"android_x86_64_sdk_shared_current/liblog.ndk.so\",\n\tsrcs: [\"android_x86_64_sdk_shared_21/liblog.ndk.so\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstubs: { versions: [\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"REL\",\"current\",], }, \n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/system/logging/Android.bp
        printf "\n" >> prebuiltlibs/system/logging/Android.bp
        popd
    - name: Archive system_logging-0
      uses: actions/upload-artifact@v3
      with:
        name: system_logging-0
        path: aosp/prebuiltlibs/system/logging
  external_e2fsprogs-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/e2fsprogs
      id: external_e2fsprogs
      uses: actions/cache@v3
      with:
        path: "aosp/external/e2fsprogs"
        key: "external_e2fsprogs@$BRANCH"
        restore-keys: "external_e2fsprogs@$BRANCH"
    - name: Clone project external/e2fsprogs
      if: steps.external_e2fsprogs.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/e2fsprogs
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_e2fsprogs-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/e2fsprogs/e2fsck/e2fsck/android_x86_64/e2fsck out/soong/.intermediates/external/e2fsprogs/misc/tune2fs/android_x86_64/tune2fs out/soong/.intermediates/external/e2fsprogs/misc/badblocks/android_x86_64/badblocks out/soong/.intermediates/external/e2fsprogs/misc/blkid/android_x86_64/blkid out/soong/.intermediates/external/e2fsprogs/misc/e2freefrag/android_x86_64/e2freefrag out/soong/.intermediates/external/e2fsprogs/resize/resize2fs/android_x86_64/resize2fs out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_recovery_x86_64_shared/libext2_uuid.so out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_recovery_x86_64_static/libext2_uuid.a out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_x86_64_shared/libext2_uuid.so out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_x86_64_static/libext2_uuid.a out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_x86_x86_64_static/libext2_uuid.a out/soong/.intermediates/external/e2fsprogs/misc/mke2fs/android_recovery_x86_64/mke2fs out/soong/.intermediates/external/e2fsprogs/misc/mke2fs/android_x86_64/mke2fs)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_e2fsprogs-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/e2fsprogs/e2fsck/e2fsck/android_x86_64/e2fsck ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_x86_64/ && cp out/soong/.intermediates/external/e2fsprogs/e2fsck/e2fsck/android_x86_64/e2fsck prebuiltlibs/external/e2fsprogs/android_x86_64/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/misc/tune2fs/android_x86_64/tune2fs ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_x86_64/ && cp out/soong/.intermediates/external/e2fsprogs/misc/tune2fs/android_x86_64/tune2fs prebuiltlibs/external/e2fsprogs/android_x86_64/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/misc/badblocks/android_x86_64/badblocks ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_x86_64/ && cp out/soong/.intermediates/external/e2fsprogs/misc/badblocks/android_x86_64/badblocks prebuiltlibs/external/e2fsprogs/android_x86_64/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/misc/blkid/android_x86_64/blkid ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_x86_64/ && cp out/soong/.intermediates/external/e2fsprogs/misc/blkid/android_x86_64/blkid prebuiltlibs/external/e2fsprogs/android_x86_64/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/misc/e2freefrag/android_x86_64/e2freefrag ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_x86_64/ && cp out/soong/.intermediates/external/e2fsprogs/misc/e2freefrag/android_x86_64/e2freefrag prebuiltlibs/external/e2fsprogs/android_x86_64/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/resize/resize2fs/android_x86_64/resize2fs ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_x86_64/ && cp out/soong/.intermediates/external/e2fsprogs/resize/resize2fs/android_x86_64/resize2fs prebuiltlibs/external/e2fsprogs/android_x86_64/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_recovery_x86_64_shared/libext2_uuid.so ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_recovery_x86_64_shared/libext2_uuid.so prebuiltlibs/external/e2fsprogs/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_recovery_x86_64_static/libext2_uuid.a ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_recovery_x86_64_static/libext2_uuid.a prebuiltlibs/external/e2fsprogs/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_x86_64_shared/libext2_uuid.so ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_x86_64_shared/ && cp out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_x86_64_shared/libext2_uuid.so prebuiltlibs/external/e2fsprogs/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_x86_64_static/libext2_uuid.a ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_x86_64_static/ && cp out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_x86_64_static/libext2_uuid.a prebuiltlibs/external/e2fsprogs/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_x86_x86_64_static/libext2_uuid.a ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/e2fsprogs/lib/uuid/libext2_uuid/android_x86_x86_64_static/libext2_uuid.a prebuiltlibs/external/e2fsprogs/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/misc/mke2fs/android_recovery_x86_64/mke2fs ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_recovery_x86_64/ && cp out/soong/.intermediates/external/e2fsprogs/misc/mke2fs/android_recovery_x86_64/mke2fs prebuiltlibs/external/e2fsprogs/android_recovery_x86_64/ || true
        [ -e out/soong/.intermediates/external/e2fsprogs/misc/mke2fs/android_x86_64/mke2fs ] && mkdir -p prebuiltlibs/external/e2fsprogs/android_x86_64/ && cp out/soong/.intermediates/external/e2fsprogs/misc/mke2fs/android_x86_64/mke2fs prebuiltlibs/external/e2fsprogs/android_x86_64/ || true
        mkdir -p prebuiltlibs/external/e2fsprogs/lib/uuid/. && cp -r external/e2fsprogs/lib/uuid/./* prebuiltlibs/external/e2fsprogs/lib/uuid/.
        cp -r out/soong/ninja/external/e2fsprogs prebuiltlibs/external/e2fsprogs/external_e2fsprogs-0
        grep '|external/e2fsprogs' out/soong/module-info.txt >> prebuiltlibs/external/e2fsprogs/MODULES
        du -ad1 external/e2fsprogs | sort -rnk1 > prebuiltlibs/external/e2fsprogs/.SIZE
        popd
    - name: write Android.bp external_e2fsprogs-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_binary {\n\tname: \"e2fsck\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/e2fsck\",\n\tsrcs: [\"android_x86_64/e2fsck\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libext2_blkid\",\"libext2_com_err\",\"libext2_e2p\",\"libext2_quota\",\"libext2_uuid\",\"libext2fs\"],\n\tsystem_shared_libs: [\"libc\",\"libdl\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"tune2fs\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/tune2fs\",\n\tsrcs: [\"android_x86_64/tune2fs\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libext2_blkid\",\"libext2_com_err\",\"libext2_e2p\",\"libext2_quota\",\"libext2_uuid\",\"libext2fs\"],\n\tsystem_shared_libs: [\"libc\",\"libdl\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"badblocks\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/badblocks\",\n\tsrcs: [\"android_x86_64/badblocks\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libext2_blkid\",\"libext2_com_err\",\"libext2_e2p\",\"libext2_uuid\",\"libext2fs\"],\n\tsystem_shared_libs: [\"libc\",\"libdl\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"blkid\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/blkid\",\n\tsrcs: [\"android_x86_64/blkid\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libext2_blkid\",\"libext2_com_err\",\"libext2_e2p\",\"libext2fs\"],\n\tsystem_shared_libs: [\"libc\",\"libdl\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"e2freefrag\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/e2freefrag\",\n\tsrcs: [\"android_x86_64/e2freefrag\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libext2_com_err\",\"libext2fs\"],\n\tsystem_shared_libs: [\"libc\",\"libdl\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"resize2fs\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/resize2fs\",\n\tsrcs: [\"android_x86_64/resize2fs\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libext2_blkid\",\"libext2_com_err\",\"libext2_e2p\",\"libext2_uuid\",\"libext2fs\"],\n\tsystem_shared_libs: [\"libc\",\"libdl\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libext2_uuid\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libext2_uuid.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libext2_uuid.a\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libext2_uuid.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libext2_uuid.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libext2_uuid.a\",\n\tsrcs: [\"android_x86_64_shared/libext2_uuid.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tapex_available: [\"//apex_available:platform\",\"com.android.virt\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"lib/uuid/.\"],\n}\ncc_prebuilt_binary {\n\tname: \"mke2fs\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64: \"android_recovery_x86_64/mke2fs\",\n\tandroid_x86_64: \"android_x86_64/mke2fs\",\n\tsrcs: [\"android_recovery_x86_64/mke2fs\"],\n\ttarget: { android: { compile_multilib: \"64\", symlinks: [\"mkfs.ext2\",\"mkfs.ext3\",\"mkfs.ext4\",], }, },\n\trequired: [\"libc\",\"libdl\",\"libext2_blkid\",\"libext2_com_err\",\"libext2_e2p\",\"libext2_misc\",\"libext2_quota\",\"libext2_uuid\",\"libext2fs\",\"libm\"],\n\tstl: \"libc++_static\", \n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/e2fsprogs/Android.bp
        printf "\n" >> prebuiltlibs/external/e2fsprogs/Android.bp
        popd
    - name: Archive external_e2fsprogs-0
      uses: actions/upload-artifact@v3
      with:
        name: external_e2fsprogs-0
        path: aosp/prebuiltlibs/external/e2fsprogs
  external_boringssl-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Clone project prebuilts/ndk
      if: steps.prebuilts_ndk.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/ndk
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/boringssl
      id: external_boringssl
      uses: actions/cache@v3
      with:
        path: "aosp/external/boringssl"
        key: "external_boringssl@$BRANCH"
        restore-keys: "external_boringssl@$BRANCH"
    - name: Clone project external/boringssl
      if: steps.external_boringssl.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/boringssl
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_boringssl-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_64/boringssl_self_test64 out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_64_apex29/boringssl_self_test64 out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_x86_64/boringssl_self_test32 out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_x86_64_apex29/boringssl_self_test32 out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test_vendor/android_vendor.31_x86_64/boringssl_self_test64 out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test_vendor/android_vendor.31_x86_x86_64/boringssl_self_test32 out/soong/.intermediates/external/boringssl/libcrypto/android_recovery_x86_64_shared/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_vendor.31_x86_64_shared/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_vendor.31_x86_x86_64_shared/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_sdk_shared/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared_apex10000/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared_apex29/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared_apex31/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared_apex10000/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared_apex29/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared_apex31/libcrypto.so out/soong/.intermediates/external/boringssl/libcrypto/linux_glibc_x86_64_shared/libcrypto-host.so out/soong/.intermediates/external/boringssl/libcrypto/linux_glibc_x86_64_static/libcrypto.a out/soong/.intermediates/external/boringssl/libcrypto_static/android_x86_64_static/libcrypto_static.a out/soong/.intermediates/external/boringssl/libcrypto_static/android_x86_64_static_apex30/libcrypto_static.a out/soong/.intermediates/external/boringssl/libcrypto_static/android_x86_x86_64_static_apex30/libcrypto_static.a out/soong/.intermediates/external/boringssl/libcrypto_static/linux_glibc_x86_64_static/libcrypto_static.a out/soong/.intermediates/external/boringssl/libssl/android_recovery_x86_64_shared/libssl.so out/soong/.intermediates/external/boringssl/libssl/android_recovery_x86_64_static/libssl.a out/soong/.intermediates/external/boringssl/libssl/android_vendor.31_x86_64_shared/libssl.so out/soong/.intermediates/external/boringssl/libssl/android_vendor.31_x86_x86_64_shared/libssl.so out/soong/.intermediates/external/boringssl/libssl/android_x86_64_sdk_shared/libssl.so out/soong/.intermediates/external/boringssl/libssl/android_x86_64_shared/libssl.so out/soong/.intermediates/external/boringssl/libssl/android_x86_64_shared_apex29/libssl.so out/soong/.intermediates/external/boringssl/libssl/android_x86_64_static/libssl.a out/soong/.intermediates/external/boringssl/libssl/android_x86_64_static_apex10000/libssl.a out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_shared/libssl.so out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_shared_apex29/libssl.so out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_static/libssl.a out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_static_apex10000/libssl.a out/soong/.intermediates/external/boringssl/libssl/linux_glibc_x86_64_shared/libssl-host.so out/soong/.intermediates/external/boringssl/libssl/linux_glibc_x86_64_static/libssl.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_boringssl-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_64/boringssl_self_test64 ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64/ && cp out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_64/boringssl_self_test64 prebuiltlibs/external/boringssl/android_x86_64/ || true
        [ -e out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_64_apex29/boringssl_self_test64 ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_apex29/ && cp out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_64_apex29/boringssl_self_test64 prebuiltlibs/external/boringssl/android_x86_64_apex29/ || true
        [ -e out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_x86_64/boringssl_self_test32 ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64/ && cp out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_x86_64/boringssl_self_test32 prebuiltlibs/external/boringssl/android_x86_x86_64/ || true
        [ -e out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_x86_64_apex29/boringssl_self_test32 ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64_apex29/ && cp out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test/android_x86_x86_64_apex29/boringssl_self_test32 prebuiltlibs/external/boringssl/android_x86_x86_64_apex29/ || true
        [ -e out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test_vendor/android_vendor.31_x86_64/boringssl_self_test64 ] && mkdir -p prebuiltlibs/external/boringssl/android_vendor.31_x86_64/ && cp out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test_vendor/android_vendor.31_x86_64/boringssl_self_test64 prebuiltlibs/external/boringssl/android_vendor.31_x86_64/ || true
        [ -e out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test_vendor/android_vendor.31_x86_x86_64/boringssl_self_test32 ] && mkdir -p prebuiltlibs/external/boringssl/android_vendor.31_x86_x86_64/ && cp out/soong/.intermediates/external/boringssl/selftest/boringssl_self_test_vendor/android_vendor.31_x86_x86_64/boringssl_self_test32 prebuiltlibs/external/boringssl/android_vendor.31_x86_x86_64/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_recovery_x86_64_shared/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_recovery_x86_64_shared/libcrypto.so prebuiltlibs/external/boringssl/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_vendor.31_x86_64_shared/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_vendor.31_x86_64_shared/libcrypto.so prebuiltlibs/external/boringssl/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_vendor.31_x86_x86_64_shared/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_vendor.31_x86_x86_64_shared/libcrypto.so prebuiltlibs/external/boringssl/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_sdk_shared/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_sdk_shared/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_sdk_shared/libcrypto.so prebuiltlibs/external/boringssl/android_x86_64_sdk_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared/libcrypto.so prebuiltlibs/external/boringssl/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared_apex10000/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared_apex10000/libcrypto.so prebuiltlibs/external/boringssl/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared_apex29/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_shared_apex29/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared_apex29/libcrypto.so prebuiltlibs/external/boringssl/android_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared_apex31/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_shared_apex31/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_x86_64_shared_apex31/libcrypto.so prebuiltlibs/external/boringssl/android_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared/libcrypto.so prebuiltlibs/external/boringssl/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared_apex10000/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared_apex10000/libcrypto.so prebuiltlibs/external/boringssl/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared_apex29/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64_shared_apex29/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared_apex29/libcrypto.so prebuiltlibs/external/boringssl/android_x86_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared_apex31/libcrypto.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64_shared_apex31/ && cp out/soong/.intermediates/external/boringssl/libcrypto/android_x86_x86_64_shared_apex31/libcrypto.so prebuiltlibs/external/boringssl/android_x86_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/linux_glibc_x86_64_shared/libcrypto-host.so ] && mkdir -p prebuiltlibs/external/boringssl/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libcrypto/linux_glibc_x86_64_shared/libcrypto-host.so prebuiltlibs/external/boringssl/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto/linux_glibc_x86_64_static/libcrypto.a ] && mkdir -p prebuiltlibs/external/boringssl/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/boringssl/libcrypto/linux_glibc_x86_64_static/libcrypto.a prebuiltlibs/external/boringssl/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto_static/android_x86_64_static/libcrypto_static.a ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_static/ && cp out/soong/.intermediates/external/boringssl/libcrypto_static/android_x86_64_static/libcrypto_static.a prebuiltlibs/external/boringssl/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto_static/android_x86_64_static_apex30/libcrypto_static.a ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_static_apex30/ && cp out/soong/.intermediates/external/boringssl/libcrypto_static/android_x86_64_static_apex30/libcrypto_static.a prebuiltlibs/external/boringssl/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto_static/android_x86_x86_64_static_apex30/libcrypto_static.a ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64_static_apex30/ && cp out/soong/.intermediates/external/boringssl/libcrypto_static/android_x86_x86_64_static_apex30/libcrypto_static.a prebuiltlibs/external/boringssl/android_x86_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/boringssl/libcrypto_static/linux_glibc_x86_64_static/libcrypto_static.a ] && mkdir -p prebuiltlibs/external/boringssl/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/boringssl/libcrypto_static/linux_glibc_x86_64_static/libcrypto_static.a prebuiltlibs/external/boringssl/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_recovery_x86_64_shared/libssl.so ] && mkdir -p prebuiltlibs/external/boringssl/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libssl/android_recovery_x86_64_shared/libssl.so prebuiltlibs/external/boringssl/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_recovery_x86_64_static/libssl.a ] && mkdir -p prebuiltlibs/external/boringssl/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/boringssl/libssl/android_recovery_x86_64_static/libssl.a prebuiltlibs/external/boringssl/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_vendor.31_x86_64_shared/libssl.so ] && mkdir -p prebuiltlibs/external/boringssl/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libssl/android_vendor.31_x86_64_shared/libssl.so prebuiltlibs/external/boringssl/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_vendor.31_x86_x86_64_shared/libssl.so ] && mkdir -p prebuiltlibs/external/boringssl/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libssl/android_vendor.31_x86_x86_64_shared/libssl.so prebuiltlibs/external/boringssl/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_x86_64_sdk_shared/libssl.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_sdk_shared/ && cp out/soong/.intermediates/external/boringssl/libssl/android_x86_64_sdk_shared/libssl.so prebuiltlibs/external/boringssl/android_x86_64_sdk_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_x86_64_shared/libssl.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libssl/android_x86_64_shared/libssl.so prebuiltlibs/external/boringssl/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_x86_64_shared_apex29/libssl.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_shared_apex29/ && cp out/soong/.intermediates/external/boringssl/libssl/android_x86_64_shared_apex29/libssl.so prebuiltlibs/external/boringssl/android_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_x86_64_static/libssl.a ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_static/ && cp out/soong/.intermediates/external/boringssl/libssl/android_x86_64_static/libssl.a prebuiltlibs/external/boringssl/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_x86_64_static_apex10000/libssl.a ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/boringssl/libssl/android_x86_64_static_apex10000/libssl.a prebuiltlibs/external/boringssl/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_shared/libssl.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_shared/libssl.so prebuiltlibs/external/boringssl/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_shared_apex29/libssl.so ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64_shared_apex29/ && cp out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_shared_apex29/libssl.so prebuiltlibs/external/boringssl/android_x86_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_static/libssl.a ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_static/libssl.a prebuiltlibs/external/boringssl/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_static_apex10000/libssl.a ] && mkdir -p prebuiltlibs/external/boringssl/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/boringssl/libssl/android_x86_x86_64_static_apex10000/libssl.a prebuiltlibs/external/boringssl/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/linux_glibc_x86_64_shared/libssl-host.so ] && mkdir -p prebuiltlibs/external/boringssl/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/external/boringssl/libssl/linux_glibc_x86_64_shared/libssl-host.so prebuiltlibs/external/boringssl/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/boringssl/libssl/linux_glibc_x86_64_static/libssl.a ] && mkdir -p prebuiltlibs/external/boringssl/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/boringssl/libssl/linux_glibc_x86_64_static/libssl.a prebuiltlibs/external/boringssl/linux_glibc_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/boringssl/src/include && cp -r external/boringssl/src/include/* prebuiltlibs/external/boringssl/src/include
        cp -r out/soong/ninja/external/boringssl prebuiltlibs/external/boringssl/external_boringssl-0
        grep '|external/boringssl' out/soong/module-info.txt >> prebuiltlibs/external/boringssl/MODULES
        du -ad1 external/boringssl | sort -rnk1 > prebuiltlibs/external/boringssl/.SIZE
        popd
    - name: write Android.bp external_boringssl-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_binary {\n\tname: \"boringssl_self_test\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/boringssl_self_test\",\n\tandroid_x86_64_apex29: \"android_x86_64_apex29/boringssl_self_test\",\n\tandroid_x86_x86_64: \"android_x86_x86_64/boringssl_self_test\",\n\tandroid_x86_x86_64_apex29: \"android_x86_x86_64_apex29/boringssl_self_test\",\n\tsrcs: [\"android_x86_64/boringssl_self_test\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\tmultilib: { lib64: { suffix: \"64\", }, lib32: { suffix: \"32\", }, },\n\trequired: [\"libc\",\"libc++\",\"libcrypto\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"29\", apex_available: [\"//apex_available:platform\",\"com.android.conscrypt\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"boringssl_self_test_vendor\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tandroid_vendor_31_x86_64: \"android_vendor.31_x86_64/boringssl_self_test_vendor\",\n\tandroid_vendor_31_x86_x86_64: \"android_vendor.31_x86_x86_64/boringssl_self_test_vendor\",\n\tsrcs: [\"android_vendor.31_x86_64/boringssl_self_test_vendor\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\tmultilib: { lib64: { suffix: \"64\", }, lib32: { suffix: \"32\", }, },\n\trequired: [\"libc\",\"libc++\",\"libcrypto\",\"libdl\",\"libm\"],\n\tstem: \"boringssl_self_test\", soc_specific: true, \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libcrypto\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libcrypto.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libcrypto.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libcrypto.so\",\n\tandroid_x86_64_sdk_shared: \"android_x86_64_sdk_shared/libcrypto.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libcrypto.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libcrypto.so\",\n\tandroid_x86_64_shared_apex29: \"android_x86_64_shared_apex29/libcrypto.so\",\n\tandroid_x86_64_shared_apex31: \"android_x86_64_shared_apex31/libcrypto.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libcrypto.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/libcrypto.so\",\n\tandroid_x86_x86_64_shared_apex29: \"android_x86_x86_64_shared_apex29/libcrypto.so\",\n\tandroid_x86_x86_64_shared_apex31: \"android_x86_x86_64_shared_apex31/libcrypto.so\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libcrypto.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libcrypto.a\",\n\tsrcs: [\"android_x86_64_shared/libcrypto.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\",\"libc.ndk\",\"libdl.ndk\",\"libm.ndk\",\"libc++\"],\n\tmin_sdk_version: \"29\", stl: \"libc++_static\", vndk: { enabled: true, }, apex_available: [\"//apex_available:platform\",\"com.android.adbd\",\"com.android.art\",\"com.android.art.debug\",\"com.android.art.testing\",\"com.android.bluetooth.updatable\",\"com.android.conscrypt\",\"com.android.media\",\"com.android.resolv\",\"com.android.virt\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"src/include\"],\n}\ncc_prebuilt_library_static {\n\tname: \"libcrypto_static\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: false,\n\tandroid_x86_64_static: \"android_x86_64_static/libcrypto_static.a\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libcrypto_static.a\",\n\tandroid_x86_x86_64_static_apex30: \"android_x86_x86_64_static_apex30/libcrypto_static.a\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libcrypto_static.a\",\n\tsrcs: [\"android_x86_64_static/libcrypto_static.a\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tstl: \"libc++_static\", apex_available: [\"//apex_available:platform\",\"com.android.neuralnetworks\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"src/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libssl\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libssl.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libssl.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libssl.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libssl.so\",\n\tandroid_x86_64_sdk_shared: \"android_x86_64_sdk_shared/libssl.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libssl.so\",\n\tandroid_x86_64_shared_apex29: \"android_x86_64_shared_apex29/libssl.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libssl.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libssl.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libssl.so\",\n\tandroid_x86_x86_64_shared_apex29: \"android_x86_x86_64_shared_apex29/libssl.so\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libssl.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libssl.a\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libssl.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libssl.a\",\n\tsrcs: [\"android_x86_64_shared/libssl.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libcrypto\",\"libdl\",\"libm\",\"libc.ndk\",\"libdl.ndk\",\"libm.ndk\",\"libc++\"],\n\tmin_sdk_version: \"29\", stl: \"libc++_static\", vndk: { enabled: true, }, apex_available: [\"//apex_available:platform\",\"com.android.adbd\",\"com.android.conscrypt\",\"com.android.resolv\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"src/include\"],\n}" >> prebuiltlibs/external/boringssl/Android.bp
        printf "\n" >> prebuiltlibs/external/boringssl/Android.bp
        popd
    - name: Archive external_boringssl-0
      uses: actions/upload-artifact@v3
      with:
        name: external_boringssl-0
        path: aosp/prebuiltlibs/external/boringssl
  prebuilts_rust-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,system_logging-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact system_logging-0
      uses: actions/download-artifact@v3
      with:
        name: system_logging-0
        path: aosp/prebuiltlibs/system/logging/
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target prebuilts_rust-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/prebuilts/rust/libstd/android_x86_64_dylib/libstd.dylib.so out/soong/.intermediates/prebuilts/rust/libstd/android_x86_64_rlib/libstd.rlib out/soong/.intermediates/prebuilts/rust/libstd/android_x86_x86_64_dylib/libstd.dylib.so out/soong/.intermediates/prebuilts/rust/libstd/android_x86_x86_64_rlib/libstd.rlib out/soong/.intermediates/prebuilts/rust/libtest/android_x86_64_dylib/libtest.dylib.so out/soong/.intermediates/prebuilts/rust/libtest/android_x86_64_rlib/libtest.rlib out/soong/.intermediates/prebuilts/rust/libtest/android_x86_x86_64_dylib/libtest.dylib.so out/soong/.intermediates/prebuilts/rust/libtest/android_x86_x86_64_rlib/libtest.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target prebuilts_rust-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/prebuilts/rust/libstd/android_x86_64_dylib/libstd.dylib.so ] && mkdir -p prebuiltlibs/prebuilts/rust/android_x86_64_dylib/ && cp out/soong/.intermediates/prebuilts/rust/libstd/android_x86_64_dylib/libstd.dylib.so prebuiltlibs/prebuilts/rust/android_x86_64_dylib/ || true
        [ -e out/soong/.intermediates/prebuilts/rust/libstd/android_x86_64_rlib/libstd.rlib ] && mkdir -p prebuiltlibs/prebuilts/rust/android_x86_64_rlib/ && cp out/soong/.intermediates/prebuilts/rust/libstd/android_x86_64_rlib/libstd.rlib prebuiltlibs/prebuilts/rust/android_x86_64_rlib/ || true
        [ -e out/soong/.intermediates/prebuilts/rust/libstd/android_x86_x86_64_dylib/libstd.dylib.so ] && mkdir -p prebuiltlibs/prebuilts/rust/android_x86_x86_64_dylib/ && cp out/soong/.intermediates/prebuilts/rust/libstd/android_x86_x86_64_dylib/libstd.dylib.so prebuiltlibs/prebuilts/rust/android_x86_x86_64_dylib/ || true
        [ -e out/soong/.intermediates/prebuilts/rust/libstd/android_x86_x86_64_rlib/libstd.rlib ] && mkdir -p prebuiltlibs/prebuilts/rust/android_x86_x86_64_rlib/ && cp out/soong/.intermediates/prebuilts/rust/libstd/android_x86_x86_64_rlib/libstd.rlib prebuiltlibs/prebuilts/rust/android_x86_x86_64_rlib/ || true
        [ -e out/soong/.intermediates/prebuilts/rust/libtest/android_x86_64_dylib/libtest.dylib.so ] && mkdir -p prebuiltlibs/prebuilts/rust/android_x86_64_dylib/ && cp out/soong/.intermediates/prebuilts/rust/libtest/android_x86_64_dylib/libtest.dylib.so prebuiltlibs/prebuilts/rust/android_x86_64_dylib/ || true
        [ -e out/soong/.intermediates/prebuilts/rust/libtest/android_x86_64_rlib/libtest.rlib ] && mkdir -p prebuiltlibs/prebuilts/rust/android_x86_64_rlib/ && cp out/soong/.intermediates/prebuilts/rust/libtest/android_x86_64_rlib/libtest.rlib prebuiltlibs/prebuilts/rust/android_x86_64_rlib/ || true
        [ -e out/soong/.intermediates/prebuilts/rust/libtest/android_x86_x86_64_dylib/libtest.dylib.so ] && mkdir -p prebuiltlibs/prebuilts/rust/android_x86_x86_64_dylib/ && cp out/soong/.intermediates/prebuilts/rust/libtest/android_x86_x86_64_dylib/libtest.dylib.so prebuiltlibs/prebuilts/rust/android_x86_x86_64_dylib/ || true
        [ -e out/soong/.intermediates/prebuilts/rust/libtest/android_x86_x86_64_rlib/libtest.rlib ] && mkdir -p prebuiltlibs/prebuilts/rust/android_x86_x86_64_rlib/ && cp out/soong/.intermediates/prebuilts/rust/libtest/android_x86_x86_64_rlib/libtest.rlib prebuiltlibs/prebuilts/rust/android_x86_x86_64_rlib/ || true
        cp -r out/soong/ninja/prebuilts/rust prebuiltlibs/prebuilts/rust/prebuilts_rust-0
        grep '|prebuilts/rust' out/soong/module-info.txt >> prebuiltlibs/prebuilts/rust/MODULES
        du -ad1 prebuilts/rust | sort -rnk1 > prebuiltlibs/prebuilts/rust/.SIZE
        popd
    - name: write Android.bp prebuilts_rust-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "rust_prebuilt_library {\n\tname: \"libstd\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_dylib: \"android_x86_64_dylib/libstd.dylib.so\",\n\tandroid_x86_64_rlib: \"android_x86_64_rlib/libstd.rlib\",\n\tandroid_x86_x86_64_dylib: \"android_x86_x86_64_dylib/libstd.dylib.so\",\n\tandroid_x86_x86_64_rlib: \"android_x86_x86_64_rlib/libstd.rlib\",\n\tsrcs: [\"android_x86_64_dylib/libstd.dylib.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"liblog\",\"libm\"],\n\tmin_sdk_version: \"29\", apex_available: [\"//apex_available:platform\",\"//apex_available:anyapex\",], \n\tstrip: { none: true, },\n}\nrust_prebuilt_library {\n\tname: \"libtest\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_dylib: \"android_x86_64_dylib/libtest.dylib.so\",\n\tandroid_x86_64_rlib: \"android_x86_64_rlib/libtest.rlib\",\n\tandroid_x86_x86_64_dylib: \"android_x86_x86_64_dylib/libtest.dylib.so\",\n\tandroid_x86_x86_64_rlib: \"android_x86_x86_64_rlib/libtest.rlib\",\n\tsrcs: [\"android_x86_64_dylib/libtest.dylib.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"liblog\",\"libm\"],\n\tmin_sdk_version: \"29\", apex_available: [\"//apex_available:platform\",\"//apex_available:anyapex\",], \n\tstrip: { none: true, },\n}" >> prebuiltlibs/prebuilts/rust/Android.bp
        printf "\n" >> prebuiltlibs/prebuilts/rust/Android.bp
        popd
    - name: Archive prebuilts_rust-0
      uses: actions/upload-artifact@v3
      with:
        name: prebuilts_rust-0
        path: aosp/prebuiltlibs/prebuilts/rust
  external_fmtlib-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Clone project prebuilts/ndk
      if: steps.prebuilts_ndk.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/ndk
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/fmtlib
      id: external_fmtlib
      uses: actions/cache@v3
      with:
        path: "aosp/external/fmtlib"
        key: "external_fmtlib@$BRANCH"
        restore-keys: "external_fmtlib@$BRANCH"
    - name: Clone project external/fmtlib
      if: steps.external_fmtlib.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/fmtlib
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_fmtlib-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/fmtlib/fmtlib/android_recovery_x86_64_static/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_vendor.31_x86_64_static/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_vendor.31_x86_x86_64_static/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex10000/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex29/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex30/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex31/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_cfi/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_cfi_apex29/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex10000/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex29/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex30/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex31/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib/linux_glibc_x86_64_static/fmtlib.a out/soong/.intermediates/external/fmtlib/fmtlib_ndk/android_x86_64_sdk_static/fmtlib_ndk.a out/soong/.intermediates/external/fmtlib/fmtlib_ndk/android_x86_64_sdk_static_apex30/fmtlib_ndk.a out/soong/.intermediates/external/fmtlib/fmtlib_ndk/android_x86_64_static/fmtlib_ndk.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_fmtlib-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_recovery_x86_64_static/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_recovery_x86_64_static/fmtlib.a prebuiltlibs/external/fmtlib/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_vendor.31_x86_64_static/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_vendor.31_x86_64_static/fmtlib.a prebuiltlibs/external/fmtlib/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_vendor.31_x86_x86_64_static/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_vendor.31_x86_x86_64_static/fmtlib.a prebuiltlibs/external/fmtlib/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_64_static/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex10000/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex10000/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex29/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_64_static_apex29/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex29/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex30/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_64_static_apex30/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex30/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex31/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_64_static_apex31/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_apex31/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_cfi/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_64_static_cfi/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_cfi/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_64_static_cfi/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_cfi_apex29/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_64_static_cfi_apex29/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_64_static_cfi_apex29/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_64_static_cfi_apex29/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex10000/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex10000/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex29/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_x86_64_static_apex29/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex29/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex30/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_x86_64_static_apex30/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex30/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex31/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_x86_64_static_apex31/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/android_x86_x86_64_static_apex31/fmtlib.a prebuiltlibs/external/fmtlib/android_x86_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib/linux_glibc_x86_64_static/fmtlib.a ] && mkdir -p prebuiltlibs/external/fmtlib/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/fmtlib/fmtlib/linux_glibc_x86_64_static/fmtlib.a prebuiltlibs/external/fmtlib/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib_ndk/android_x86_64_sdk_static/fmtlib_ndk.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_64_sdk_static/ && cp out/soong/.intermediates/external/fmtlib/fmtlib_ndk/android_x86_64_sdk_static/fmtlib_ndk.a prebuiltlibs/external/fmtlib/android_x86_64_sdk_static/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib_ndk/android_x86_64_sdk_static_apex30/fmtlib_ndk.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_64_sdk_static_apex30/ && cp out/soong/.intermediates/external/fmtlib/fmtlib_ndk/android_x86_64_sdk_static_apex30/fmtlib_ndk.a prebuiltlibs/external/fmtlib/android_x86_64_sdk_static_apex30/ || true
        [ -e out/soong/.intermediates/external/fmtlib/fmtlib_ndk/android_x86_64_static/fmtlib_ndk.a ] && mkdir -p prebuiltlibs/external/fmtlib/android_x86_64_static/ && cp out/soong/.intermediates/external/fmtlib/fmtlib_ndk/android_x86_64_static/fmtlib_ndk.a prebuiltlibs/external/fmtlib/android_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/fmtlib/include && cp -r external/fmtlib/include/* prebuiltlibs/external/fmtlib/include
        cp -r out/soong/ninja/external/fmtlib prebuiltlibs/external/fmtlib/external_fmtlib-0
        grep '|external/fmtlib' out/soong/module-info.txt >> prebuiltlibs/external/fmtlib/MODULES
        du -ad1 external/fmtlib | sort -rnk1 > prebuiltlibs/external/fmtlib/.SIZE
        popd
    - name: write Android.bp external_fmtlib-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_static {\n\tname: \"fmtlib\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/fmtlib.a\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/fmtlib.a\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/fmtlib.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/fmtlib.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/fmtlib.a\",\n\tandroid_x86_64_static_apex29: \"android_x86_64_static_apex29/fmtlib.a\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/fmtlib.a\",\n\tandroid_x86_64_static_apex31: \"android_x86_64_static_apex31/fmtlib.a\",\n\tandroid_x86_64_static_cfi: \"android_x86_64_static_cfi/fmtlib.a\",\n\tandroid_x86_64_static_cfi_apex29: \"android_x86_64_static_cfi_apex29/fmtlib.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/fmtlib.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/fmtlib.a\",\n\tandroid_x86_x86_64_static_apex29: \"android_x86_x86_64_static_apex29/fmtlib.a\",\n\tandroid_x86_x86_64_static_apex30: \"android_x86_x86_64_static_apex30/fmtlib.a\",\n\tandroid_x86_x86_64_static_apex31: \"android_x86_x86_64_static_apex31/fmtlib.a\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/fmtlib.a\",\n\tsrcs: [\"android_recovery_x86_64_static/fmtlib.a\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"29\", apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}\ncc_prebuilt_library_static {\n\tname: \"fmtlib_ndk\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_sdk_static: \"android_x86_64_sdk_static/fmtlib_ndk.a\",\n\tandroid_x86_64_sdk_static_apex30: \"android_x86_64_sdk_static_apex30/fmtlib_ndk.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/fmtlib_ndk.a\",\n\tsrcs: [\"android_x86_64_static/fmtlib_ndk.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc.ndk\",\"libdl.ndk\",\"libm.ndk\",\"libc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"29\", sdk_version: \"current\", stl: \"c++_static\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}" >> prebuiltlibs/external/fmtlib/Android.bp
        printf "\n" >> prebuiltlibs/external/fmtlib/Android.bp
        popd
    - name: Archive external_fmtlib-0
      uses: actions/upload-artifact@v3
      with:
        name: external_fmtlib-0
        path: aosp/prebuiltlibs/external/fmtlib
  system_libbase-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_fmtlib-0,external_libcxx-0,external_libcxxabi-0,system_logging-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Clone project prebuilts/ndk
      if: steps.prebuilts_ndk.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/ndk
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Restore Cache external/fmtlib
      id: external_fmtlib
      uses: actions/cache@v3
      with:
        path: "aosp/external/fmtlib"
        key: "external_fmtlib@$BRANCH"
        restore-keys: "external_fmtlib@$BRANCH"
    - name: Clone project external/fmtlib
      if: steps.external_fmtlib.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/fmtlib
    - name: Download artifact external_fmtlib-0
      uses: actions/download-artifact@v3
      with:
        name: external_fmtlib-0
        path: aosp/prebuiltlibs/external/fmtlib/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Download artifact system_logging-0
      uses: actions/download-artifact@v3
      with:
        name: system_logging-0
        path: aosp/prebuiltlibs/system/logging/
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target system_libbase-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/system/libbase/libbase/android_recovery_x86_64_shared/libbase.so out/soong/.intermediates/system/libbase/libbase/android_recovery_x86_64_static/libbase.a out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_64_shared/libbase.so out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_64_static/libbase.a out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_x86_64_shared/libbase.so out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_x86_64_static/libbase.a out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared/libbase.so out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared_apex10000/libbase.so out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared_apex29/libbase.so out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared_apex31/libbase.so out/soong/.intermediates/system/libbase/libbase/android_x86_64_static/libbase.a out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_apex10000/libbase.a out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_apex29/libbase.a out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_apex30/libbase.a out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_cfi/libbase.a out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_cfi_apex29/libbase.a out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared/libbase.so out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared_apex10000/libbase.so out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared_apex29/libbase.so out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared_apex31/libbase.so out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static/libbase.a out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static_apex10000/libbase.a out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static_apex29/libbase.a out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static_apex30/libbase.a out/soong/.intermediates/system/libbase/libbase/linux_glibc_x86_64_shared/libbase.so out/soong/.intermediates/system/libbase/libbase/linux_glibc_x86_64_static/libbase.a out/soong/.intermediates/system/libbase/libbase_ndk/android_x86_64_sdk_static/libbase_ndk.a out/soong/.intermediates/system/libbase/libbase_ndk/android_x86_64_sdk_static_apex30/libbase_ndk.a out/soong/.intermediates/system/libbase/libbase_ndk/android_x86_64_static/libbase_ndk.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target system_libbase-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/system/libbase/libbase/android_recovery_x86_64_shared/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/libbase/libbase/android_recovery_x86_64_shared/libbase.so prebuiltlibs/system/libbase/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_recovery_x86_64_static/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/libbase/libbase/android_recovery_x86_64_static/libbase.a prebuiltlibs/system/libbase/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_64_shared/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_64_shared/libbase.so prebuiltlibs/system/libbase/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_64_static/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_64_static/libbase.a prebuiltlibs/system/libbase/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_x86_64_shared/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_x86_64_shared/libbase.so prebuiltlibs/system/libbase/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_x86_64_static/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/system/libbase/libbase/android_vendor.31_x86_x86_64_static/libbase.a prebuiltlibs/system/libbase/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_shared/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared/libbase.so prebuiltlibs/system/libbase/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared_apex10000/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared_apex10000/libbase.so prebuiltlibs/system/libbase/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared_apex29/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_shared_apex29/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared_apex29/libbase.so prebuiltlibs/system/libbase/android_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared_apex31/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_shared_apex31/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_64_shared_apex31/libbase.so prebuiltlibs/system/libbase/android_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_64_static/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_static/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_64_static/libbase.a prebuiltlibs/system/libbase/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_apex10000/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_apex10000/libbase.a prebuiltlibs/system/libbase/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_apex29/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_static_apex29/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_apex29/libbase.a prebuiltlibs/system/libbase/android_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_apex30/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_static_apex30/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_apex30/libbase.a prebuiltlibs/system/libbase/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_cfi/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_static_cfi/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_cfi/libbase.a prebuiltlibs/system/libbase/android_x86_64_static_cfi/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_cfi_apex29/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_static_cfi_apex29/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_64_static_cfi_apex29/libbase.a prebuiltlibs/system/libbase/android_x86_64_static_cfi_apex29/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared/libbase.so prebuiltlibs/system/libbase/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared_apex10000/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared_apex10000/libbase.so prebuiltlibs/system/libbase/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared_apex29/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_x86_x86_64_shared_apex29/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared_apex29/libbase.so prebuiltlibs/system/libbase/android_x86_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared_apex31/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/android_x86_x86_64_shared_apex31/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_shared_apex31/libbase.so prebuiltlibs/system/libbase/android_x86_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static/libbase.a prebuiltlibs/system/libbase/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static_apex10000/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static_apex10000/libbase.a prebuiltlibs/system/libbase/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static_apex29/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_x86_64_static_apex29/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static_apex29/libbase.a prebuiltlibs/system/libbase/android_x86_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static_apex30/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_x86_64_static_apex30/ && cp out/soong/.intermediates/system/libbase/libbase/android_x86_x86_64_static_apex30/libbase.a prebuiltlibs/system/libbase/android_x86_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/linux_glibc_x86_64_shared/libbase.so ] && mkdir -p prebuiltlibs/system/libbase/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/system/libbase/libbase/linux_glibc_x86_64_shared/libbase.so prebuiltlibs/system/libbase/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase/linux_glibc_x86_64_static/libbase.a ] && mkdir -p prebuiltlibs/system/libbase/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/system/libbase/libbase/linux_glibc_x86_64_static/libbase.a prebuiltlibs/system/libbase/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase_ndk/android_x86_64_sdk_static/libbase_ndk.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_sdk_static/ && cp out/soong/.intermediates/system/libbase/libbase_ndk/android_x86_64_sdk_static/libbase_ndk.a prebuiltlibs/system/libbase/android_x86_64_sdk_static/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase_ndk/android_x86_64_sdk_static_apex30/libbase_ndk.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_sdk_static_apex30/ && cp out/soong/.intermediates/system/libbase/libbase_ndk/android_x86_64_sdk_static_apex30/libbase_ndk.a prebuiltlibs/system/libbase/android_x86_64_sdk_static_apex30/ || true
        [ -e out/soong/.intermediates/system/libbase/libbase_ndk/android_x86_64_static/libbase_ndk.a ] && mkdir -p prebuiltlibs/system/libbase/android_x86_64_static/ && cp out/soong/.intermediates/system/libbase/libbase_ndk/android_x86_64_static/libbase_ndk.a prebuiltlibs/system/libbase/android_x86_64_static/ || true
        mkdir -p prebuiltlibs/system/libbase/include && cp -r system/libbase/include/* prebuiltlibs/system/libbase/include
        cp -r out/soong/ninja/system/libbase prebuiltlibs/system/libbase/system_libbase-0
        grep '|system/libbase' out/soong/module-info.txt >> prebuiltlibs/system/libbase/MODULES
        du -ad1 system/libbase | sort -rnk1 > prebuiltlibs/system/libbase/.SIZE
        popd
    - name: write Android.bp system_libbase-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libbase\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libbase.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libbase.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libbase.so\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libbase.a\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libbase.so\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libbase.a\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libbase.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libbase.so\",\n\tandroid_x86_64_shared_apex29: \"android_x86_64_shared_apex29/libbase.so\",\n\tandroid_x86_64_shared_apex31: \"android_x86_64_shared_apex31/libbase.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libbase.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libbase.a\",\n\tandroid_x86_64_static_apex29: \"android_x86_64_static_apex29/libbase.a\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libbase.a\",\n\tandroid_x86_64_static_cfi: \"android_x86_64_static_cfi/libbase.a\",\n\tandroid_x86_64_static_cfi_apex29: \"android_x86_64_static_cfi_apex29/libbase.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libbase.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/libbase.so\",\n\tandroid_x86_x86_64_shared_apex29: \"android_x86_x86_64_shared_apex29/libbase.so\",\n\tandroid_x86_x86_64_shared_apex31: \"android_x86_x86_64_shared_apex31/libbase.so\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libbase.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libbase.a\",\n\tandroid_x86_x86_64_static_apex29: \"android_x86_x86_64_static_apex29/libbase.a\",\n\tandroid_x86_x86_64_static_apex30: \"android_x86_x86_64_static_apex30/libbase.a\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libbase.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libbase.a\",\n\tsrcs: [\"android_x86_64_shared/libbase.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\"],\n\tmin_sdk_version: \"29\", vndk: { enabled: true, }, apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_static {\n\tname: \"libbase_ndk\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_sdk_static: \"android_x86_64_sdk_static/libbase_ndk.a\",\n\tandroid_x86_64_sdk_static_apex30: \"android_x86_64_sdk_static_apex30/libbase_ndk.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libbase_ndk.a\",\n\tsrcs: [\"android_x86_64_static/libbase_ndk.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc.ndk\",\"libdl.ndk\",\"liblog.ndk\",\"libm.ndk\",\"libc\",\"libdl\",\"liblog\",\"libm\"],\n\tmin_sdk_version: \"29\", sdk_version: \"current\", stl: \"c++_static\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}" >> prebuiltlibs/system/libbase/Android.bp
        printf "\n" >> prebuiltlibs/system/libbase/Android.bp
        popd
    - name: Archive system_libbase-0
      uses: actions/upload-artifact@v3
      with:
        name: system_libbase-0
        path: aosp/prebuiltlibs/system/libbase
  external_lzma-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Restore Cache external/lzma
      id: external_lzma
      uses: actions/cache@v3
      with:
        path: "aosp/external/lzma"
        key: "external_lzma@$BRANCH"
        restore-keys: "external_lzma@$BRANCH"
    - name: Clone project external/lzma
      if: steps.external_lzma.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/lzma
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_lzma-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/lzma/C/liblzma/android_recovery_x86_64_shared/liblzma.so out/soong/.intermediates/external/lzma/C/liblzma/android_recovery_x86_64_static/liblzma.a out/soong/.intermediates/external/lzma/C/liblzma/android_vendor.31_x86_64_shared/liblzma.so out/soong/.intermediates/external/lzma/C/liblzma/android_vendor.31_x86_x86_64_shared/liblzma.so out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_shared/liblzma.so out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_shared_apex10000/liblzma.so out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_shared_apex31/liblzma.so out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_static/liblzma.a out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_static_apex10000/liblzma.a out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_shared/liblzma.so out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_shared_apex10000/liblzma.so out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_shared_apex31/liblzma.so out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_static/liblzma.a out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_static_apex10000/liblzma.a out/soong/.intermediates/external/lzma/C/liblzma/linux_glibc_x86_64_shared/liblzma.so out/soong/.intermediates/external/lzma/C/liblzma/linux_glibc_x86_64_static/liblzma.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_lzma-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_recovery_x86_64_shared/liblzma.so ] && mkdir -p prebuiltlibs/external/lzma/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_recovery_x86_64_shared/liblzma.so prebuiltlibs/external/lzma/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_recovery_x86_64_static/liblzma.a ] && mkdir -p prebuiltlibs/external/lzma/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_recovery_x86_64_static/liblzma.a prebuiltlibs/external/lzma/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_vendor.31_x86_64_shared/liblzma.so ] && mkdir -p prebuiltlibs/external/lzma/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_vendor.31_x86_64_shared/liblzma.so prebuiltlibs/external/lzma/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_vendor.31_x86_x86_64_shared/liblzma.so ] && mkdir -p prebuiltlibs/external/lzma/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_vendor.31_x86_x86_64_shared/liblzma.so prebuiltlibs/external/lzma/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_shared/liblzma.so ] && mkdir -p prebuiltlibs/external/lzma/android_x86_64_shared/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_shared/liblzma.so prebuiltlibs/external/lzma/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_shared_apex10000/liblzma.so ] && mkdir -p prebuiltlibs/external/lzma/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_shared_apex10000/liblzma.so prebuiltlibs/external/lzma/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_shared_apex31/liblzma.so ] && mkdir -p prebuiltlibs/external/lzma/android_x86_64_shared_apex31/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_shared_apex31/liblzma.so prebuiltlibs/external/lzma/android_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_static/liblzma.a ] && mkdir -p prebuiltlibs/external/lzma/android_x86_64_static/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_static/liblzma.a prebuiltlibs/external/lzma/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_static_apex10000/liblzma.a ] && mkdir -p prebuiltlibs/external/lzma/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_x86_64_static_apex10000/liblzma.a prebuiltlibs/external/lzma/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_shared/liblzma.so ] && mkdir -p prebuiltlibs/external/lzma/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_shared/liblzma.so prebuiltlibs/external/lzma/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_shared_apex10000/liblzma.so ] && mkdir -p prebuiltlibs/external/lzma/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_shared_apex10000/liblzma.so prebuiltlibs/external/lzma/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_shared_apex31/liblzma.so ] && mkdir -p prebuiltlibs/external/lzma/android_x86_x86_64_shared_apex31/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_shared_apex31/liblzma.so prebuiltlibs/external/lzma/android_x86_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_static/liblzma.a ] && mkdir -p prebuiltlibs/external/lzma/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_static/liblzma.a prebuiltlibs/external/lzma/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_static_apex10000/liblzma.a ] && mkdir -p prebuiltlibs/external/lzma/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/lzma/C/liblzma/android_x86_x86_64_static_apex10000/liblzma.a prebuiltlibs/external/lzma/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/linux_glibc_x86_64_shared/liblzma.so ] && mkdir -p prebuiltlibs/external/lzma/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/external/lzma/C/liblzma/linux_glibc_x86_64_shared/liblzma.so prebuiltlibs/external/lzma/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/lzma/C/liblzma/linux_glibc_x86_64_static/liblzma.a ] && mkdir -p prebuiltlibs/external/lzma/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/lzma/C/liblzma/linux_glibc_x86_64_static/liblzma.a prebuiltlibs/external/lzma/linux_glibc_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/lzma/C/. && cp -r external/lzma/C/./* prebuiltlibs/external/lzma/C/.
        cp -r out/soong/ninja/external/lzma prebuiltlibs/external/lzma/external_lzma-0
        grep '|external/lzma' out/soong/module-info.txt >> prebuiltlibs/external/lzma/MODULES
        du -ad1 external/lzma | sort -rnk1 > prebuiltlibs/external/lzma/.SIZE
        popd
    - name: write Android.bp external_lzma-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"liblzma\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/liblzma.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/liblzma.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/liblzma.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/liblzma.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/liblzma.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/liblzma.so\",\n\tandroid_x86_64_shared_apex31: \"android_x86_64_shared_apex31/liblzma.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/liblzma.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/liblzma.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/liblzma.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/liblzma.so\",\n\tandroid_x86_x86_64_shared_apex31: \"android_x86_x86_64_shared_apex31/liblzma.so\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/liblzma.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/liblzma.a\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/liblzma.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/liblzma.a\",\n\tsrcs: [\"android_x86_64_shared/liblzma.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"apex_inherit\", stl: \"none\", vndk: { enabled: true, }, apex_available: [\"//apex_available:platform\",\"com.android.art\",\"com.android.art.debug\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"C/.\"],\n}" >> prebuiltlibs/external/lzma/Android.bp
        printf "\n" >> prebuiltlibs/external/lzma/Android.bp
        popd
    - name: Archive external_lzma-0
      uses: actions/upload-artifact@v3
      with:
        name: external_lzma-0
        path: aosp/prebuiltlibs/external/lzma
  system_libprocinfo-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0,system_libbase-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact system_libbase-0
      uses: actions/download-artifact@v3
      with:
        name: system_libbase-0
        path: aosp/prebuiltlibs/system/libbase/
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache system/libprocinfo
      id: system_libprocinfo
      uses: actions/cache@v3
      with:
        path: "aosp/system/libprocinfo"
        key: "system_libprocinfo@$BRANCH"
        restore-keys: "system_libprocinfo@$BRANCH"
    - name: Clone project system/libprocinfo
      if: steps.system_libprocinfo.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/libprocinfo
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target system_libprocinfo-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/system/libprocinfo/libprocinfo/android_recovery_x86_64_static/libprocinfo.a out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_64_shared/libprocinfo.so out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_64_static/libprocinfo.a out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_x86_64_shared/libprocinfo.so out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_x86_64_static/libprocinfo.a out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_shared/libprocinfo.so out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_shared_apex10000/libprocinfo.so out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_static/libprocinfo.a out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_static_apex10000/libprocinfo.a out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_static_apex31/libprocinfo.a out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_shared/libprocinfo.so out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_shared_apex10000/libprocinfo.so out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_static/libprocinfo.a out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_static_apex10000/libprocinfo.a out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_static_apex31/libprocinfo.a out/soong/.intermediates/system/libprocinfo/libprocinfo/linux_glibc_x86_64_static/libprocinfo.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target system_libprocinfo-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_recovery_x86_64_static/libprocinfo.a ] && mkdir -p prebuiltlibs/system/libprocinfo/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_recovery_x86_64_static/libprocinfo.a prebuiltlibs/system/libprocinfo/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_64_shared/libprocinfo.so ] && mkdir -p prebuiltlibs/system/libprocinfo/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_64_shared/libprocinfo.so prebuiltlibs/system/libprocinfo/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_64_static/libprocinfo.a ] && mkdir -p prebuiltlibs/system/libprocinfo/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_64_static/libprocinfo.a prebuiltlibs/system/libprocinfo/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_x86_64_shared/libprocinfo.so ] && mkdir -p prebuiltlibs/system/libprocinfo/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_x86_64_shared/libprocinfo.so prebuiltlibs/system/libprocinfo/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_x86_64_static/libprocinfo.a ] && mkdir -p prebuiltlibs/system/libprocinfo/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_vendor.31_x86_x86_64_static/libprocinfo.a prebuiltlibs/system/libprocinfo/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_shared/libprocinfo.so ] && mkdir -p prebuiltlibs/system/libprocinfo/android_x86_64_shared/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_shared/libprocinfo.so prebuiltlibs/system/libprocinfo/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_shared_apex10000/libprocinfo.so ] && mkdir -p prebuiltlibs/system/libprocinfo/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_shared_apex10000/libprocinfo.so prebuiltlibs/system/libprocinfo/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_static/libprocinfo.a ] && mkdir -p prebuiltlibs/system/libprocinfo/android_x86_64_static/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_static/libprocinfo.a prebuiltlibs/system/libprocinfo/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_static_apex10000/libprocinfo.a ] && mkdir -p prebuiltlibs/system/libprocinfo/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_static_apex10000/libprocinfo.a prebuiltlibs/system/libprocinfo/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_static_apex31/libprocinfo.a ] && mkdir -p prebuiltlibs/system/libprocinfo/android_x86_64_static_apex31/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_64_static_apex31/libprocinfo.a prebuiltlibs/system/libprocinfo/android_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_shared/libprocinfo.so ] && mkdir -p prebuiltlibs/system/libprocinfo/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_shared/libprocinfo.so prebuiltlibs/system/libprocinfo/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_shared_apex10000/libprocinfo.so ] && mkdir -p prebuiltlibs/system/libprocinfo/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_shared_apex10000/libprocinfo.so prebuiltlibs/system/libprocinfo/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_static/libprocinfo.a ] && mkdir -p prebuiltlibs/system/libprocinfo/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_static/libprocinfo.a prebuiltlibs/system/libprocinfo/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_static_apex10000/libprocinfo.a ] && mkdir -p prebuiltlibs/system/libprocinfo/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_static_apex10000/libprocinfo.a prebuiltlibs/system/libprocinfo/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_static_apex31/libprocinfo.a ] && mkdir -p prebuiltlibs/system/libprocinfo/android_x86_x86_64_static_apex31/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/android_x86_x86_64_static_apex31/libprocinfo.a prebuiltlibs/system/libprocinfo/android_x86_x86_64_static_apex31/ || true
        [ -e out/soong/.intermediates/system/libprocinfo/libprocinfo/linux_glibc_x86_64_static/libprocinfo.a ] && mkdir -p prebuiltlibs/system/libprocinfo/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/system/libprocinfo/libprocinfo/linux_glibc_x86_64_static/libprocinfo.a prebuiltlibs/system/libprocinfo/linux_glibc_x86_64_static/ || true
        mkdir -p prebuiltlibs/system/libprocinfo/include && cp -r system/libprocinfo/include/* prebuiltlibs/system/libprocinfo/include
        cp -r out/soong/ninja/system/libprocinfo prebuiltlibs/system/libprocinfo/system_libprocinfo-0
        grep '|system/libprocinfo' out/soong/module-info.txt >> prebuiltlibs/system/libprocinfo/MODULES
        du -ad1 system/libprocinfo | sort -rnk1 > prebuiltlibs/system/libprocinfo/.SIZE
        popd
    - name: write Android.bp system_libprocinfo-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libprocinfo\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libprocinfo.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libprocinfo.so\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libprocinfo.a\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libprocinfo.so\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libprocinfo.a\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libprocinfo.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libprocinfo.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libprocinfo.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libprocinfo.a\",\n\tandroid_x86_64_static_apex31: \"android_x86_64_static_apex31/libprocinfo.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libprocinfo.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/libprocinfo.so\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libprocinfo.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libprocinfo.a\",\n\tandroid_x86_x86_64_static_apex31: \"android_x86_x86_64_static_apex31/libprocinfo.a\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libprocinfo.a\",\n\tsrcs: [\"android_x86_64_shared/libprocinfo.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libdl\",\"libm\",\"libc++\"],\n\tmin_sdk_version: \"apex_inherit\", vndk: { enabled: true, }, apex_available: [\"//apex_available:platform\",\"com.android.art\",\"com.android.art.debug\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}" >> prebuiltlibs/system/libprocinfo/Android.bp
        printf "\n" >> prebuiltlibs/system/libprocinfo/Android.bp
        popd
    - name: Archive system_libprocinfo-0
      uses: actions/upload-artifact@v3
      with:
        name: system_libprocinfo-0
        path: aosp/prebuiltlibs/system/libprocinfo
  system_unwinding-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0,external_lzma-0,system_libbase-0,system_libprocinfo-0,system_logging-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache art
      id: art
      uses: actions/cache@v3
      with:
        path: "aosp/art"
        key: "art@$BRANCH"
        restore-keys: "art@$BRANCH"
    - name: Clone project art
      if: steps.art.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform art
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact system_libbase-0
      uses: actions/download-artifact@v3
      with:
        name: system_libbase-0
        path: aosp/prebuiltlibs/system/libbase/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Download artifact system_logging-0
      uses: actions/download-artifact@v3
      with:
        name: system_logging-0
        path: aosp/prebuiltlibs/system/logging/
    - name: Restore Cache system/libprocinfo
      id: system_libprocinfo
      uses: actions/cache@v3
      with:
        path: "aosp/system/libprocinfo"
        key: "system_libprocinfo@$BRANCH"
        restore-keys: "system_libprocinfo@$BRANCH"
    - name: Clone project system/libprocinfo
      if: steps.system_libprocinfo.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/libprocinfo
    - name: Download artifact system_libprocinfo-0
      uses: actions/download-artifact@v3
      with:
        name: system_libprocinfo-0
        path: aosp/prebuiltlibs/system/libprocinfo/
    - name: Restore Cache external/lzma
      id: external_lzma
      uses: actions/cache@v3
      with:
        path: "aosp/external/lzma"
        key: "external_lzma@$BRANCH"
        restore-keys: "external_lzma@$BRANCH"
    - name: Clone project external/lzma
      if: steps.external_lzma.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/lzma
    - name: Download artifact external_lzma-0
      uses: actions/download-artifact@v3
      with:
        name: external_lzma-0
        path: aosp/prebuiltlibs/external/lzma/
    - name: Restore Cache system/unwinding
      id: system_unwinding
      uses: actions/cache@v3
      with:
        path: "aosp/system/unwinding"
        key: "system_unwinding@$BRANCH"
        restore-keys: "system_unwinding@$BRANCH"
    - name: Clone project system/unwinding
      if: steps.system_unwinding.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/unwinding
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target system_unwinding-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_recovery_x86_64_shared/libbacktrace.so out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_vendor.31_x86_64_shared/libbacktrace.so out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_vendor.31_x86_x86_64_shared/libbacktrace.so out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_64_shared/libbacktrace.so out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_64_shared_apex31/libbacktrace.so out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_x86_64_shared/libbacktrace.so out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_x86_64_shared_apex31/libbacktrace.so out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/linux_glibc_x86_64_shared/libbacktrace.so out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/linux_glibc_x86_64_static/libbacktrace.a out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace_no_dex/android_x86_64_static/libbacktrace_no_dex.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_recovery_x86_64_static/libunwindstack.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_vendor.31_x86_64_shared/libunwindstack.so out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_vendor.31_x86_x86_64_shared/libunwindstack.so out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_shared/libunwindstack.so out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_shared_apex10000/libunwindstack.so out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_shared_apex31/libunwindstack.so out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_static/libunwindstack.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_static_apex10000/libunwindstack.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_shared/libunwindstack.so out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_shared_apex10000/libunwindstack.so out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_shared_apex31/libunwindstack.so out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_static/libunwindstack.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_static_apex10000/libunwindstack.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/linux_glibc_x86_64_shared/libunwindstack.so out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/linux_glibc_x86_64_static/libunwindstack.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_recovery_x86_64_static/libunwindstack_no_dex.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_64_static/libunwindstack_no_dex.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_64_static_apex10000/libunwindstack_no_dex.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_x86_64_static/libunwindstack_no_dex.a out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_x86_64_static_apex10000/libunwindstack_no_dex.a out/soong/.intermediates/system/unwinding/libunwindstack/unwind_info/android_x86_64/unwind_info out/soong/.intermediates/system/unwinding/libunwindstack/unwind_symbols/android_x86_64/unwind_symbols out/soong/.intermediates/system/unwinding/libunwindstack/unwind_reg_info/android_x86_64/unwind_reg_info)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target system_unwinding-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_recovery_x86_64_shared/libbacktrace.so ] && mkdir -p prebuiltlibs/system/unwinding/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_recovery_x86_64_shared/libbacktrace.so prebuiltlibs/system/unwinding/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_vendor.31_x86_64_shared/libbacktrace.so ] && mkdir -p prebuiltlibs/system/unwinding/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_vendor.31_x86_64_shared/libbacktrace.so prebuiltlibs/system/unwinding/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_vendor.31_x86_x86_64_shared/libbacktrace.so ] && mkdir -p prebuiltlibs/system/unwinding/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_vendor.31_x86_x86_64_shared/libbacktrace.so prebuiltlibs/system/unwinding/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_64_shared/libbacktrace.so ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_64_shared/libbacktrace.so prebuiltlibs/system/unwinding/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_64_shared_apex31/libbacktrace.so ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64_shared_apex31/ && cp out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_64_shared_apex31/libbacktrace.so prebuiltlibs/system/unwinding/android_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_x86_64_shared/libbacktrace.so ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_x86_64_shared/libbacktrace.so prebuiltlibs/system/unwinding/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_x86_64_shared_apex31/libbacktrace.so ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_x86_64_shared_apex31/ && cp out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/android_x86_x86_64_shared_apex31/libbacktrace.so prebuiltlibs/system/unwinding/android_x86_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/linux_glibc_x86_64_shared/libbacktrace.so ] && mkdir -p prebuiltlibs/system/unwinding/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/linux_glibc_x86_64_shared/libbacktrace.so prebuiltlibs/system/unwinding/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/linux_glibc_x86_64_static/libbacktrace.a ] && mkdir -p prebuiltlibs/system/unwinding/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace/linux_glibc_x86_64_static/libbacktrace.a prebuiltlibs/system/unwinding/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace_no_dex/android_x86_64_static/libbacktrace_no_dex.a ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64_static/ && cp out/soong/.intermediates/system/unwinding/libbacktrace/libbacktrace_no_dex/android_x86_64_static/libbacktrace_no_dex.a prebuiltlibs/system/unwinding/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_recovery_x86_64_static/libunwindstack.a ] && mkdir -p prebuiltlibs/system/unwinding/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_recovery_x86_64_static/libunwindstack.a prebuiltlibs/system/unwinding/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_vendor.31_x86_64_shared/libunwindstack.so ] && mkdir -p prebuiltlibs/system/unwinding/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_vendor.31_x86_64_shared/libunwindstack.so prebuiltlibs/system/unwinding/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_vendor.31_x86_x86_64_shared/libunwindstack.so ] && mkdir -p prebuiltlibs/system/unwinding/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_vendor.31_x86_x86_64_shared/libunwindstack.so prebuiltlibs/system/unwinding/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_shared/libunwindstack.so ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_shared/libunwindstack.so prebuiltlibs/system/unwinding/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_shared_apex10000/libunwindstack.so ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_shared_apex10000/libunwindstack.so prebuiltlibs/system/unwinding/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_shared_apex31/libunwindstack.so ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64_shared_apex31/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_shared_apex31/libunwindstack.so prebuiltlibs/system/unwinding/android_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_static/libunwindstack.a ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64_static/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_static/libunwindstack.a prebuiltlibs/system/unwinding/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_static_apex10000/libunwindstack.a ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_64_static_apex10000/libunwindstack.a prebuiltlibs/system/unwinding/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_shared/libunwindstack.so ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_shared/libunwindstack.so prebuiltlibs/system/unwinding/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_shared_apex10000/libunwindstack.so ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_shared_apex10000/libunwindstack.so prebuiltlibs/system/unwinding/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_shared_apex31/libunwindstack.so ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_x86_64_shared_apex31/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_shared_apex31/libunwindstack.so prebuiltlibs/system/unwinding/android_x86_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_static/libunwindstack.a ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_static/libunwindstack.a prebuiltlibs/system/unwinding/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_static_apex10000/libunwindstack.a ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/android_x86_x86_64_static_apex10000/libunwindstack.a prebuiltlibs/system/unwinding/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/linux_glibc_x86_64_shared/libunwindstack.so ] && mkdir -p prebuiltlibs/system/unwinding/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/linux_glibc_x86_64_shared/libunwindstack.so prebuiltlibs/system/unwinding/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/linux_glibc_x86_64_static/libunwindstack.a ] && mkdir -p prebuiltlibs/system/unwinding/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack/linux_glibc_x86_64_static/libunwindstack.a prebuiltlibs/system/unwinding/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_recovery_x86_64_static/libunwindstack_no_dex.a ] && mkdir -p prebuiltlibs/system/unwinding/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_recovery_x86_64_static/libunwindstack_no_dex.a prebuiltlibs/system/unwinding/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_64_static/libunwindstack_no_dex.a ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64_static/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_64_static/libunwindstack_no_dex.a prebuiltlibs/system/unwinding/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_64_static_apex10000/libunwindstack_no_dex.a ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_64_static_apex10000/libunwindstack_no_dex.a prebuiltlibs/system/unwinding/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_x86_64_static/libunwindstack_no_dex.a ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_x86_64_static/libunwindstack_no_dex.a prebuiltlibs/system/unwinding/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_x86_64_static_apex10000/libunwindstack_no_dex.a ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/libunwindstack_no_dex/android_x86_x86_64_static_apex10000/libunwindstack_no_dex.a prebuiltlibs/system/unwinding/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/unwind_info/android_x86_64/unwind_info ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/unwind_info/android_x86_64/unwind_info prebuiltlibs/system/unwinding/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/unwind_symbols/android_x86_64/unwind_symbols ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/unwind_symbols/android_x86_64/unwind_symbols prebuiltlibs/system/unwinding/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/unwinding/libunwindstack/unwind_reg_info/android_x86_64/unwind_reg_info ] && mkdir -p prebuiltlibs/system/unwinding/android_x86_64/ && cp out/soong/.intermediates/system/unwinding/libunwindstack/unwind_reg_info/android_x86_64/unwind_reg_info prebuiltlibs/system/unwinding/android_x86_64/ || true
        mkdir -p prebuiltlibs/system/unwinding/libbacktrace/include && cp -r system/unwinding/libbacktrace/include/* prebuiltlibs/system/unwinding/libbacktrace/include
        mkdir -p prebuiltlibs/system/unwinding/libunwindstack/include && cp -r system/unwinding/libunwindstack/include/* prebuiltlibs/system/unwinding/libunwindstack/include
        cp -r out/soong/ninja/system/unwinding prebuiltlibs/system/unwinding/system_unwinding-0
        grep '|system/unwinding' out/soong/module-info.txt >> prebuiltlibs/system/unwinding/MODULES
        du -ad1 system/unwinding | sort -rnk1 > prebuiltlibs/system/unwinding/.SIZE
        popd
    - name: write Android.bp system_unwinding-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libbacktrace\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libbacktrace.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libbacktrace.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libbacktrace.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libbacktrace.so\",\n\tandroid_x86_64_shared_apex31: \"android_x86_64_shared_apex31/libbacktrace.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libbacktrace.so\",\n\tandroid_x86_x86_64_shared_apex31: \"android_x86_x86_64_shared_apex31/libbacktrace.so\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libbacktrace.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libbacktrace.a\",\n\tsrcs: [\"android_x86_64_shared/libbacktrace.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\",\"libunwindstack\"],\n\tmin_sdk_version: \"apex_inherit\", vndk: { enabled: true, }, apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libbacktrace/include\"],\n}\ncc_prebuilt_library_static {\n\tname: \"libbacktrace_no_dex\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_static: \"android_x86_64_static/libbacktrace_no_dex.a\",\n\tsrcs: [\"android_x86_64_static/libbacktrace_no_dex.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libdl\",\"liblog\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libbacktrace/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libunwindstack\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libunwindstack.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libunwindstack.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libunwindstack.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libunwindstack.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libunwindstack.so\",\n\tandroid_x86_64_shared_apex31: \"android_x86_64_shared_apex31/libunwindstack.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libunwindstack.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libunwindstack.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libunwindstack.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/libunwindstack.so\",\n\tandroid_x86_x86_64_shared_apex31: \"android_x86_x86_64_shared_apex31/libunwindstack.so\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libunwindstack.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libunwindstack.a\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libunwindstack.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libunwindstack.a\",\n\tsrcs: [\"android_x86_64_shared/libunwindstack.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libdl\",\"liblog\",\"liblzma\",\"libm\",\"libc++\"],\n\tmin_sdk_version: \"29\", vndk: { enabled: true, }, apex_available: [\"//apex_available:platform\",\"com.android.art\",\"com.android.art.debug\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libunwindstack/include\"],\n}\ncc_prebuilt_library_static {\n\tname: \"libunwindstack_no_dex\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libunwindstack_no_dex.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libunwindstack_no_dex.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libunwindstack_no_dex.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libunwindstack_no_dex.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libunwindstack_no_dex.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libunwindstack_no_dex.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libdl\",\"liblog\",\"liblzma\",\"libm\"],\n\tapex_available: [\"//apex_available:platform\",\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libunwindstack/include\"],\n}\ncc_prebuilt_binary {\n\tname: \"unwind_info\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/unwind_info\",\n\tsrcs: [\"android_x86_64/unwind_info\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"liblzma\",\"libm\",\"libunwindstack\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"unwind_symbols\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/unwind_symbols\",\n\tsrcs: [\"android_x86_64/unwind_symbols\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"liblzma\",\"libm\",\"libunwindstack\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"unwind_reg_info\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/unwind_reg_info\",\n\tsrcs: [\"android_x86_64/unwind_reg_info\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"liblzma\",\"libm\",\"libunwindstack\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/system/unwinding/Android.bp
        printf "\n" >> prebuiltlibs/system/unwinding/Android.bp
        popd
    - name: Archive system_unwinding-0
      uses: actions/upload-artifact@v3
      with:
        name: system_unwinding-0
        path: aosp/prebuiltlibs/system/unwinding
  external_zlib-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Restore Cache external/zlib
      id: external_zlib
      uses: actions/cache@v3
      with:
        path: "aosp/external/zlib"
        key: "external_zlib@$BRANCH"
        restore-keys: "external_zlib@$BRANCH"
    - name: Clone project external/zlib
      if: steps.external_zlib.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/zlib
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_zlib-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/zlib/minigzip/linux_glibc_x86_64/minigzip out/soong/.intermediates/external/zlib/libz/android_recovery_x86_64_shared/libz.so out/soong/.intermediates/external/zlib/libz/android_recovery_x86_64_static/libz.a out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared/libz.so out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared_29/libz.so out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared_30/libz.so out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared_current/libz.so out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared/libz.so out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared_29/libz.so out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared_30/libz.so out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared_current/libz.so out/soong/.intermediates/external/zlib/libz/android_x86_64_shared/libz.so out/soong/.intermediates/external/zlib/libz/android_x86_64_static/libz.a out/soong/.intermediates/external/zlib/libz/android_x86_64_static_apex10000/libz.a out/soong/.intermediates/external/zlib/libz/android_x86_x86_64_shared/libz.so out/soong/.intermediates/external/zlib/libz/android_x86_x86_64_static/libz.a out/soong/.intermediates/external/zlib/libz/android_x86_x86_64_static_apex10000/libz.a out/soong/.intermediates/external/zlib/libz/linux_glibc_x86_64_shared/libz-host.so out/soong/.intermediates/external/zlib/libz/linux_glibc_x86_64_static/libz.a out/soong/.intermediates/external/zlib/libz_stable/android_vendor.31_x86_64_shared/libz_stable.so out/soong/.intermediates/external/zlib/libz_stable/android_vendor.31_x86_64_static/libz_stable.a out/soong/.intermediates/external/zlib/libz.ndk/android_x86_64_sdk_shared_current/libz.so)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_zlib-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/zlib/minigzip/linux_glibc_x86_64/minigzip ] && mkdir -p prebuiltlibs/external/zlib/linux_glibc_x86_64/ && cp out/soong/.intermediates/external/zlib/minigzip/linux_glibc_x86_64/minigzip prebuiltlibs/external/zlib/linux_glibc_x86_64/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_recovery_x86_64_shared/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/zlib/libz/android_recovery_x86_64_shared/libz.so prebuiltlibs/external/zlib/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_recovery_x86_64_static/libz.a ] && mkdir -p prebuiltlibs/external/zlib/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/zlib/libz/android_recovery_x86_64_static/libz.a prebuiltlibs/external/zlib/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared/libz.so prebuiltlibs/external/zlib/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared_29/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_vendor.31_x86_64_shared_29/ && cp out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared_29/libz.so prebuiltlibs/external/zlib/android_vendor.31_x86_64_shared_29/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared_30/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_vendor.31_x86_64_shared_30/ && cp out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared_30/libz.so prebuiltlibs/external/zlib/android_vendor.31_x86_64_shared_30/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared_current/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_vendor.31_x86_64_shared_current/ && cp out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_64_shared_current/libz.so prebuiltlibs/external/zlib/android_vendor.31_x86_64_shared_current/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared/libz.so prebuiltlibs/external/zlib/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared_29/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_vendor.31_x86_x86_64_shared_29/ && cp out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared_29/libz.so prebuiltlibs/external/zlib/android_vendor.31_x86_x86_64_shared_29/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared_30/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_vendor.31_x86_x86_64_shared_30/ && cp out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared_30/libz.so prebuiltlibs/external/zlib/android_vendor.31_x86_x86_64_shared_30/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared_current/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_vendor.31_x86_x86_64_shared_current/ && cp out/soong/.intermediates/external/zlib/libz/android_vendor.31_x86_x86_64_shared_current/libz.so prebuiltlibs/external/zlib/android_vendor.31_x86_x86_64_shared_current/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_x86_64_shared/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_x86_64_shared/ && cp out/soong/.intermediates/external/zlib/libz/android_x86_64_shared/libz.so prebuiltlibs/external/zlib/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_x86_64_static/libz.a ] && mkdir -p prebuiltlibs/external/zlib/android_x86_64_static/ && cp out/soong/.intermediates/external/zlib/libz/android_x86_64_static/libz.a prebuiltlibs/external/zlib/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_x86_64_static_apex10000/libz.a ] && mkdir -p prebuiltlibs/external/zlib/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/zlib/libz/android_x86_64_static_apex10000/libz.a prebuiltlibs/external/zlib/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_x86_x86_64_shared/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/zlib/libz/android_x86_x86_64_shared/libz.so prebuiltlibs/external/zlib/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_x86_x86_64_static/libz.a ] && mkdir -p prebuiltlibs/external/zlib/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/zlib/libz/android_x86_x86_64_static/libz.a prebuiltlibs/external/zlib/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/android_x86_x86_64_static_apex10000/libz.a ] && mkdir -p prebuiltlibs/external/zlib/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/zlib/libz/android_x86_x86_64_static_apex10000/libz.a prebuiltlibs/external/zlib/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/linux_glibc_x86_64_shared/libz-host.so ] && mkdir -p prebuiltlibs/external/zlib/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/external/zlib/libz/linux_glibc_x86_64_shared/libz-host.so prebuiltlibs/external/zlib/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/zlib/libz/linux_glibc_x86_64_static/libz.a ] && mkdir -p prebuiltlibs/external/zlib/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/zlib/libz/linux_glibc_x86_64_static/libz.a prebuiltlibs/external/zlib/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/zlib/libz_stable/android_vendor.31_x86_64_shared/libz_stable.so ] && mkdir -p prebuiltlibs/external/zlib/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/zlib/libz_stable/android_vendor.31_x86_64_shared/libz_stable.so prebuiltlibs/external/zlib/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/zlib/libz_stable/android_vendor.31_x86_64_static/libz_stable.a ] && mkdir -p prebuiltlibs/external/zlib/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/external/zlib/libz_stable/android_vendor.31_x86_64_static/libz_stable.a prebuiltlibs/external/zlib/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/zlib/libz.ndk/android_x86_64_sdk_shared_current/libz.so ] && mkdir -p prebuiltlibs/external/zlib/android_x86_64_sdk_shared_current/ && cp out/soong/.intermediates/external/zlib/libz.ndk/android_x86_64_sdk_shared_current/libz.so prebuiltlibs/external/zlib/android_x86_64_sdk_shared_current/ || true
        mkdir -p prebuiltlibs/external/zlib/. && cp -r external/zlib/./* prebuiltlibs/external/zlib/.
        cp -r out/soong/ninja/external/zlib prebuiltlibs/external/zlib/external_zlib-0
        grep '|external/zlib' out/soong/module-info.txt >> prebuiltlibs/external/zlib/MODULES
        du -ad1 external/zlib | sort -rnk1 > prebuiltlibs/external/zlib/.SIZE
        popd
    - name: write Android.bp external_zlib-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_binary {\n\tname: \"minigzip\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64: \"linux_glibc_x86_64/minigzip\",\n\tsrcs: [\"linux_glibc_x86_64/minigzip\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libz\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libz.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libz.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libz.so\",\n\tandroid_vendor_31_x86_64_shared_29: \"android_vendor.31_x86_64_shared_29/libz.so\",\n\tandroid_vendor_31_x86_64_shared_30: \"android_vendor.31_x86_64_shared_30/libz.so\",\n\tandroid_vendor_31_x86_64_shared_current: \"android_vendor.31_x86_64_shared_current/libz.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libz.so\",\n\tandroid_vendor_31_x86_x86_64_shared_29: \"android_vendor.31_x86_x86_64_shared_29/libz.so\",\n\tandroid_vendor_31_x86_x86_64_shared_30: \"android_vendor.31_x86_x86_64_shared_30/libz.so\",\n\tandroid_vendor_31_x86_x86_64_shared_current: \"android_vendor.31_x86_x86_64_shared_current/libz.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libz.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libz.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libz.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libz.so\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libz.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libz.a\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libz.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libz.a\",\n\tsrcs: [\"android_x86_64_shared/libz.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tstubs: { versions: [\"29\",\"30\",\"current\",], }, stl: \"none\", vndk: { enabled: true, }, \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\".\"],\n}\ncc_prebuilt_library {\n\tname: \"libz_stable\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libz_stable.so\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libz_stable.a\",\n\tsrcs: [\"android_vendor.31_x86_64_shared/libz_stable.so\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tstl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\".\"],\n}\ncc_prebuilt_library_shared {\n\tname: \"libz.ndk\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tsdk_version: \"minimum\",\n\tsdk_variant_only: true,\n\tandroid_x86_64_sdk_shared_current: \"android_x86_64_sdk_shared_current/libz.ndk.so\",\n\tsrcs: [\"android_x86_64_sdk_shared_current/libz.ndk.so\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstubs: { versions: [\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"REL\",\"current\",], }, \n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/zlib/Android.bp
        printf "\n" >> prebuiltlibs/external/zlib/Android.bp
        popd
    - name: Archive external_zlib-0
      uses: actions/upload-artifact@v3
      with:
        name: external_zlib-0
        path: aosp/prebuiltlibs/external/zlib
  external_protobuf-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0,external_zlib-0,system_logging-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Restore Cache external/zlib
      id: external_zlib
      uses: actions/cache@v3
      with:
        path: "aosp/external/zlib"
        key: "external_zlib@$BRANCH"
        restore-keys: "external_zlib@$BRANCH"
    - name: Clone project external/zlib
      if: steps.external_zlib.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/zlib
    - name: Download artifact external_zlib-0
      uses: actions/download-artifact@v3
      with:
        name: external_zlib-0
        path: aosp/prebuiltlibs/external/zlib/
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Download artifact system_logging-0
      uses: actions/download-artifact@v3
      with:
        name: system_logging-0
        path: aosp/prebuiltlibs/system/logging/
    - name: Restore Cache external/protobuf
      id: external_protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/protobuf"
        key: "external_protobuf@$BRANCH"
        restore-keys: "external_protobuf@$BRANCH"
    - name: Clone project external/protobuf
      if: steps.external_protobuf.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/protobuf
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_protobuf-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/protobuf/libprotoc/linux_glibc_x86_64_static/libprotoc.a out/soong/.intermediates/external/protobuf/aprotoc/linux_glibc_x86_64/aprotoc out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_recovery_x86_64_shared/libprotobuf-cpp-lite.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_recovery_x86_64_static/libprotobuf-cpp-lite.a out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_vendor.31_x86_64_shared/libprotobuf-cpp-lite-3.9.1.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_vendor.31_x86_x86_64_shared/libprotobuf-cpp-lite-3.9.1.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_shared/libprotobuf-cpp-lite.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_shared_apex10000/libprotobuf-cpp-lite.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static/libprotobuf-cpp-lite.a out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_apex10000/libprotobuf-cpp-lite.a out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_apex30/libprotobuf-cpp-lite.a out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_cfi/libprotobuf-cpp-lite.a out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_cfi_apex29/libprotobuf-cpp-lite.a out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_x86_64_shared/libprotobuf-cpp-lite.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_x86_64_static/libprotobuf-cpp-lite.a out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_x86_64_static_apex10000/libprotobuf-cpp-lite.a out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/linux_glibc_x86_64_shared/libprotobuf-cpp-lite.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/linux_glibc_x86_64_static/libprotobuf-cpp-lite.a out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_vendor.31_x86_64_shared/libprotobuf-cpp-full-3.9.1.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_vendor.31_x86_x86_64_shared/libprotobuf-cpp-full-3.9.1.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_x86_64_shared/libprotobuf-cpp-full.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_x86_64_shared_apex10000/libprotobuf-cpp-full.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_x86_x86_64_shared/libprotobuf-cpp-full.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/linux_glibc_x86_64_shared/libprotobuf-cpp-full.so out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/linux_glibc_x86_64_static/libprotobuf-cpp-full.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_protobuf-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/protobuf/libprotoc/linux_glibc_x86_64_static/libprotoc.a ] && mkdir -p prebuiltlibs/external/protobuf/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/protobuf/libprotoc/linux_glibc_x86_64_static/libprotoc.a prebuiltlibs/external/protobuf/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/protobuf/aprotoc/linux_glibc_x86_64/aprotoc ] && mkdir -p prebuiltlibs/external/protobuf/linux_glibc_x86_64/ && cp out/soong/.intermediates/external/protobuf/aprotoc/linux_glibc_x86_64/aprotoc prebuiltlibs/external/protobuf/linux_glibc_x86_64/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_recovery_x86_64_shared/libprotobuf-cpp-lite.so ] && mkdir -p prebuiltlibs/external/protobuf/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_recovery_x86_64_shared/libprotobuf-cpp-lite.so prebuiltlibs/external/protobuf/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_recovery_x86_64_static/libprotobuf-cpp-lite.a ] && mkdir -p prebuiltlibs/external/protobuf/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_recovery_x86_64_static/libprotobuf-cpp-lite.a prebuiltlibs/external/protobuf/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_vendor.31_x86_64_shared/libprotobuf-cpp-lite-3.9.1.so ] && mkdir -p prebuiltlibs/external/protobuf/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_vendor.31_x86_64_shared/libprotobuf-cpp-lite-3.9.1.so prebuiltlibs/external/protobuf/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_vendor.31_x86_x86_64_shared/libprotobuf-cpp-lite-3.9.1.so ] && mkdir -p prebuiltlibs/external/protobuf/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_vendor.31_x86_x86_64_shared/libprotobuf-cpp-lite-3.9.1.so prebuiltlibs/external/protobuf/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_shared/libprotobuf-cpp-lite.so ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_shared/libprotobuf-cpp-lite.so prebuiltlibs/external/protobuf/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_shared_apex10000/libprotobuf-cpp-lite.so ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_shared_apex10000/libprotobuf-cpp-lite.so prebuiltlibs/external/protobuf/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static/libprotobuf-cpp-lite.a ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_64_static/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static/libprotobuf-cpp-lite.a prebuiltlibs/external/protobuf/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_apex10000/libprotobuf-cpp-lite.a ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_apex10000/libprotobuf-cpp-lite.a prebuiltlibs/external/protobuf/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_apex30/libprotobuf-cpp-lite.a ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_64_static_apex30/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_apex30/libprotobuf-cpp-lite.a prebuiltlibs/external/protobuf/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_cfi/libprotobuf-cpp-lite.a ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_64_static_cfi/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_cfi/libprotobuf-cpp-lite.a prebuiltlibs/external/protobuf/android_x86_64_static_cfi/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_cfi_apex29/libprotobuf-cpp-lite.a ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_64_static_cfi_apex29/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_64_static_cfi_apex29/libprotobuf-cpp-lite.a prebuiltlibs/external/protobuf/android_x86_64_static_cfi_apex29/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_x86_64_shared/libprotobuf-cpp-lite.so ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_x86_64_shared/libprotobuf-cpp-lite.so prebuiltlibs/external/protobuf/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_x86_64_static/libprotobuf-cpp-lite.a ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_x86_64_static/libprotobuf-cpp-lite.a prebuiltlibs/external/protobuf/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_x86_64_static_apex10000/libprotobuf-cpp-lite.a ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/android_x86_x86_64_static_apex10000/libprotobuf-cpp-lite.a prebuiltlibs/external/protobuf/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/linux_glibc_x86_64_shared/libprotobuf-cpp-lite.so ] && mkdir -p prebuiltlibs/external/protobuf/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/linux_glibc_x86_64_shared/libprotobuf-cpp-lite.so prebuiltlibs/external/protobuf/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/linux_glibc_x86_64_static/libprotobuf-cpp-lite.a ] && mkdir -p prebuiltlibs/external/protobuf/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-lite/linux_glibc_x86_64_static/libprotobuf-cpp-lite.a prebuiltlibs/external/protobuf/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_vendor.31_x86_64_shared/libprotobuf-cpp-full-3.9.1.so ] && mkdir -p prebuiltlibs/external/protobuf/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_vendor.31_x86_64_shared/libprotobuf-cpp-full-3.9.1.so prebuiltlibs/external/protobuf/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_vendor.31_x86_x86_64_shared/libprotobuf-cpp-full-3.9.1.so ] && mkdir -p prebuiltlibs/external/protobuf/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_vendor.31_x86_x86_64_shared/libprotobuf-cpp-full-3.9.1.so prebuiltlibs/external/protobuf/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_x86_64_shared/libprotobuf-cpp-full.so ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_x86_64_shared/libprotobuf-cpp-full.so prebuiltlibs/external/protobuf/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_x86_64_shared_apex10000/libprotobuf-cpp-full.so ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_x86_64_shared_apex10000/libprotobuf-cpp-full.so prebuiltlibs/external/protobuf/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_x86_x86_64_shared/libprotobuf-cpp-full.so ] && mkdir -p prebuiltlibs/external/protobuf/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/android_x86_x86_64_shared/libprotobuf-cpp-full.so prebuiltlibs/external/protobuf/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/linux_glibc_x86_64_shared/libprotobuf-cpp-full.so ] && mkdir -p prebuiltlibs/external/protobuf/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/linux_glibc_x86_64_shared/libprotobuf-cpp-full.so prebuiltlibs/external/protobuf/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/linux_glibc_x86_64_static/libprotobuf-cpp-full.a ] && mkdir -p prebuiltlibs/external/protobuf/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/protobuf/libprotobuf-cpp-full/linux_glibc_x86_64_static/libprotobuf-cpp-full.a prebuiltlibs/external/protobuf/linux_glibc_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/protobuf/src && cp -r external/protobuf/src/* prebuiltlibs/external/protobuf/src
        mkdir -p prebuiltlibs/external/protobuf/android && cp -r external/protobuf/android/* prebuiltlibs/external/protobuf/android
        mkdir -p prebuiltlibs/external/protobuf/config && cp -r external/protobuf/config/* prebuiltlibs/external/protobuf/config
        cp -r out/soong/ninja/external/protobuf prebuiltlibs/external/protobuf/external_protobuf-0
        grep '|external/protobuf' out/soong/module-info.txt >> prebuiltlibs/external/protobuf/MODULES
        du -ad1 external/protobuf | sort -rnk1 > prebuiltlibs/external/protobuf/.SIZE
        popd
    - name: write Android.bp external_protobuf-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libprotoc\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libprotoc.a\",\n\tsrcs: [\"linux_glibc_x86_64_static/libprotoc.a\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, vendor: { suffix: \"-3.9.1\", }, },\n\trequired: [\"libz\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"src\",\"android\",\"src\",\"config\"],\n}\ncc_prebuilt_binary {\n\tname: \"aprotoc\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64: \"linux_glibc_x86_64/aprotoc\",\n\tsrcs: [\"linux_glibc_x86_64/aprotoc\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstl: \"libc++_static\", \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libprotobuf-cpp-lite\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libprotobuf-cpp-lite.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libprotobuf-cpp-lite.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libprotobuf-cpp-lite.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libprotobuf-cpp-lite.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libprotobuf-cpp-lite.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libprotobuf-cpp-lite.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libprotobuf-cpp-lite.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libprotobuf-cpp-lite.a\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libprotobuf-cpp-lite.a\",\n\tandroid_x86_64_static_cfi: \"android_x86_64_static_cfi/libprotobuf-cpp-lite.a\",\n\tandroid_x86_64_static_cfi_apex29: \"android_x86_64_static_cfi_apex29/libprotobuf-cpp-lite.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libprotobuf-cpp-lite.so\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libprotobuf-cpp-lite.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libprotobuf-cpp-lite.a\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libprotobuf-cpp-lite.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libprotobuf-cpp-lite.a\",\n\tsrcs: [\"android_x86_64_shared/libprotobuf-cpp-lite.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, vendor: { suffix: \"-3.9.1\", }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\"],\n\tmin_sdk_version: \"29\", apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"src\"],\n}\ncc_prebuilt_library {\n\tname: \"libprotobuf-cpp-full\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libprotobuf-cpp-full.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libprotobuf-cpp-full.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libprotobuf-cpp-full.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libprotobuf-cpp-full.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libprotobuf-cpp-full.so\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libprotobuf-cpp-full.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libprotobuf-cpp-full.a\",\n\tsrcs: [\"android_x86_64_shared/libprotobuf-cpp-full.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, vendor: { suffix: \"-3.9.1\", }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\",\"libz\"],\n\tapex_available: [\"//apex_available:platform\",\"com.android.appsearch\",\"com.android.virt\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"src\"],\n}" >> prebuiltlibs/external/protobuf/Android.bp
        printf "\n" >> prebuiltlibs/external/protobuf/Android.bp
        popd
    - name: Archive external_protobuf-0
      uses: actions/upload-artifact@v3
      with:
        name: external_protobuf-0
        path: aosp/prebuiltlibs/external/protobuf
  external_libevent-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/libevent
      id: external_libevent
      uses: actions/cache@v3
      with:
        path: "aosp/external/libevent"
        key: "external_libevent@$BRANCH"
        restore-keys: "external_libevent@$BRANCH"
    - name: Clone project external/libevent
      if: steps.external_libevent.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/libevent
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_libevent-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/libevent/libevent/android_recovery_x86_64_shared/libevent.so out/soong/.intermediates/external/libevent/libevent/android_vendor.31_x86_64_shared/libevent.so out/soong/.intermediates/external/libevent/libevent/android_vendor.31_x86_x86_64_shared/libevent.so out/soong/.intermediates/external/libevent/libevent/android_x86_64_shared/libevent.so out/soong/.intermediates/external/libevent/libevent/android_x86_64_static/libevent.a out/soong/.intermediates/external/libevent/libevent/android_x86_x86_64_shared/libevent.so)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_libevent-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/libevent/libevent/android_recovery_x86_64_shared/libevent.so ] && mkdir -p prebuiltlibs/external/libevent/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/libevent/libevent/android_recovery_x86_64_shared/libevent.so prebuiltlibs/external/libevent/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libevent/libevent/android_vendor.31_x86_64_shared/libevent.so ] && mkdir -p prebuiltlibs/external/libevent/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/libevent/libevent/android_vendor.31_x86_64_shared/libevent.so prebuiltlibs/external/libevent/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libevent/libevent/android_vendor.31_x86_x86_64_shared/libevent.so ] && mkdir -p prebuiltlibs/external/libevent/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libevent/libevent/android_vendor.31_x86_x86_64_shared/libevent.so prebuiltlibs/external/libevent/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libevent/libevent/android_x86_64_shared/libevent.so ] && mkdir -p prebuiltlibs/external/libevent/android_x86_64_shared/ && cp out/soong/.intermediates/external/libevent/libevent/android_x86_64_shared/libevent.so prebuiltlibs/external/libevent/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libevent/libevent/android_x86_64_static/libevent.a ] && mkdir -p prebuiltlibs/external/libevent/android_x86_64_static/ && cp out/soong/.intermediates/external/libevent/libevent/android_x86_64_static/libevent.a prebuiltlibs/external/libevent/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libevent/libevent/android_x86_x86_64_shared/libevent.so ] && mkdir -p prebuiltlibs/external/libevent/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libevent/libevent/android_x86_x86_64_shared/libevent.so prebuiltlibs/external/libevent/android_x86_x86_64_shared/ || true
        mkdir -p prebuiltlibs/external/libevent/include && cp -r external/libevent/include/* prebuiltlibs/external/libevent/include
        cp -r out/soong/ninja/external/libevent prebuiltlibs/external/libevent/external_libevent-0
        grep '|external/libevent' out/soong/module-info.txt >> prebuiltlibs/external/libevent/MODULES
        du -ad1 external/libevent | sort -rnk1 > prebuiltlibs/external/libevent/.SIZE
        popd
    - name: write Android.bp external_libevent-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libevent\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libevent.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libevent.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libevent.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libevent.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libevent.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libevent.so\",\n\tsrcs: [\"android_x86_64_shared/libevent.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tvndk: { enabled: true, }, \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}" >> prebuiltlibs/external/libevent/Android.bp
        printf "\n" >> prebuiltlibs/external/libevent/Android.bp
        popd
    - name: Archive external_libevent-0
      uses: actions/upload-artifact@v3
      with:
        name: external_libevent-0
        path: aosp/prebuiltlibs/external/libevent
  external_brotli-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Restore Cache external/brotli
      id: external_brotli
      uses: actions/cache@v3
      with:
        path: "aosp/external/brotli"
        key: "external_brotli@$BRANCH"
        restore-keys: "external_brotli@$BRANCH"
    - name: Clone project external/brotli
      if: steps.external_brotli.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/brotli
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_brotli-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/brotli/libbrotli/android_recovery_x86_64_static/libbrotli.a out/soong/.intermediates/external/brotli/libbrotli/android_vendor.31_x86_64_static/libbrotli.a out/soong/.intermediates/external/brotli/libbrotli/android_x86_64_static/libbrotli.a out/soong/.intermediates/external/brotli/libbrotli/android_x86_64_static_apex10000/libbrotli.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_brotli-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/brotli/libbrotli/android_recovery_x86_64_static/libbrotli.a ] && mkdir -p prebuiltlibs/external/brotli/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/brotli/libbrotli/android_recovery_x86_64_static/libbrotli.a prebuiltlibs/external/brotli/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/brotli/libbrotli/android_vendor.31_x86_64_static/libbrotli.a ] && mkdir -p prebuiltlibs/external/brotli/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/external/brotli/libbrotli/android_vendor.31_x86_64_static/libbrotli.a prebuiltlibs/external/brotli/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/brotli/libbrotli/android_x86_64_static/libbrotli.a ] && mkdir -p prebuiltlibs/external/brotli/android_x86_64_static/ && cp out/soong/.intermediates/external/brotli/libbrotli/android_x86_64_static/libbrotli.a prebuiltlibs/external/brotli/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/brotli/libbrotli/android_x86_64_static_apex10000/libbrotli.a ] && mkdir -p prebuiltlibs/external/brotli/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/brotli/libbrotli/android_x86_64_static_apex10000/libbrotli.a prebuiltlibs/external/brotli/android_x86_64_static_apex10000/ || true
        mkdir -p prebuiltlibs/external/brotli/c/include && cp -r external/brotli/c/include/* prebuiltlibs/external/brotli/c/include
        cp -r out/soong/ninja/external/brotli prebuiltlibs/external/brotli/external_brotli-0
        grep '|external/brotli' out/soong/module-info.txt >> prebuiltlibs/external/brotli/MODULES
        du -ad1 external/brotli | sort -rnk1 > prebuiltlibs/external/brotli/.SIZE
        popd
    - name: write Android.bp external_brotli-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_static {\n\tname: \"libbrotli\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libbrotli.a\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libbrotli.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libbrotli.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libbrotli.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libbrotli.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tstl: \"none\", apex_available: [\"//apex_available:platform\",\"com.android.adbd\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"c/include\"],\n}" >> prebuiltlibs/external/brotli/Android.bp
        printf "\n" >> prebuiltlibs/external/brotli/Android.bp
        popd
    - name: Archive external_brotli-0
      uses: actions/upload-artifact@v3
      with:
        name: external_brotli-0
        path: aosp/prebuiltlibs/external/brotli
  external_gflags-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/gflags
      id: external_gflags
      uses: actions/cache@v3
      with:
        path: "aosp/external/gflags"
        key: "external_gflags@$BRANCH"
        restore-keys: "external_gflags@$BRANCH"
    - name: Clone project external/gflags
      if: steps.external_gflags.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/gflags
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_gflags-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/gflags/libgflags/android_x86_64_static/libgflags.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_gflags-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/gflags/libgflags/android_x86_64_static/libgflags.a ] && mkdir -p prebuiltlibs/external/gflags/android_x86_64_static/ && cp out/soong/.intermediates/external/gflags/libgflags/android_x86_64_static/libgflags.a prebuiltlibs/external/gflags/android_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/gflags/android && cp -r external/gflags/android/* prebuiltlibs/external/gflags/android
        cp -r out/soong/ninja/external/gflags prebuiltlibs/external/gflags/external_gflags-0
        grep '|external/gflags' out/soong/module-info.txt >> prebuiltlibs/external/gflags/MODULES
        du -ad1 external/gflags | sort -rnk1 > prebuiltlibs/external/gflags/.SIZE
        popd
    - name: write Android.bp external_gflags-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libgflags\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_static: \"android_x86_64_static/libgflags.a\",\n\tsrcs: [\"android_x86_64_static/libgflags.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"android\"],\n}" >> prebuiltlibs/external/gflags/Android.bp
        printf "\n" >> prebuiltlibs/external/gflags/Android.bp
        popd
    - name: Archive external_gflags-0
      uses: actions/upload-artifact@v3
      with:
        name: external_gflags-0
        path: aosp/prebuiltlibs/external/gflags
  external_jsoncpp-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/jsoncpp
      id: external_jsoncpp
      uses: actions/cache@v3
      with:
        path: "aosp/external/jsoncpp"
        key: "external_jsoncpp@$BRANCH"
        restore-keys: "external_jsoncpp@$BRANCH"
    - name: Clone project external/jsoncpp
      if: steps.external_jsoncpp.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/jsoncpp
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_jsoncpp-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_recovery_x86_64_shared/libjsoncpp.so out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_recovery_x86_64_static/libjsoncpp.a out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_64_shared/libjsoncpp.so out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_64_static/libjsoncpp.a out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_x86_64_shared/libjsoncpp.so out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_x86_64_static/libjsoncpp.a out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_shared/libjsoncpp.so out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static/libjsoncpp.a out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static_apex29/libjsoncpp.a out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static_apex30/libjsoncpp.a out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static_cfi_apex29/libjsoncpp.a out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_x86_64_static/libjsoncpp.a out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_x86_64_static_apex29/libjsoncpp.a out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_x86_64_static_apex30/libjsoncpp.a out/soong/.intermediates/external/jsoncpp/libjsoncpp/linux_glibc_x86_64_static/libjsoncpp.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_jsoncpp-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_recovery_x86_64_shared/libjsoncpp.so ] && mkdir -p prebuiltlibs/external/jsoncpp/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_recovery_x86_64_shared/libjsoncpp.so prebuiltlibs/external/jsoncpp/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_recovery_x86_64_static/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_recovery_x86_64_static/libjsoncpp.a prebuiltlibs/external/jsoncpp/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_64_shared/libjsoncpp.so ] && mkdir -p prebuiltlibs/external/jsoncpp/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_64_shared/libjsoncpp.so prebuiltlibs/external/jsoncpp/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_64_static/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_64_static/libjsoncpp.a prebuiltlibs/external/jsoncpp/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_x86_64_shared/libjsoncpp.so ] && mkdir -p prebuiltlibs/external/jsoncpp/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_x86_64_shared/libjsoncpp.so prebuiltlibs/external/jsoncpp/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_x86_64_static/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_vendor.31_x86_x86_64_static/libjsoncpp.a prebuiltlibs/external/jsoncpp/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_shared/libjsoncpp.so ] && mkdir -p prebuiltlibs/external/jsoncpp/android_x86_64_shared/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_shared/libjsoncpp.so prebuiltlibs/external/jsoncpp/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/android_x86_64_static/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static/libjsoncpp.a prebuiltlibs/external/jsoncpp/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static_apex29/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/android_x86_64_static_apex29/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static_apex29/libjsoncpp.a prebuiltlibs/external/jsoncpp/android_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static_apex30/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/android_x86_64_static_apex30/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static_apex30/libjsoncpp.a prebuiltlibs/external/jsoncpp/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static_cfi_apex29/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/android_x86_64_static_cfi_apex29/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_64_static_cfi_apex29/libjsoncpp.a prebuiltlibs/external/jsoncpp/android_x86_64_static_cfi_apex29/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_x86_64_static/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/android_x86_x86_64_static/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_x86_64_static/libjsoncpp.a prebuiltlibs/external/jsoncpp/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_x86_64_static_apex29/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/android_x86_x86_64_static_apex29/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_x86_64_static_apex29/libjsoncpp.a prebuiltlibs/external/jsoncpp/android_x86_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_x86_64_static_apex30/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/android_x86_x86_64_static_apex30/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/android_x86_x86_64_static_apex30/libjsoncpp.a prebuiltlibs/external/jsoncpp/android_x86_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/external/jsoncpp/libjsoncpp/linux_glibc_x86_64_static/libjsoncpp.a ] && mkdir -p prebuiltlibs/external/jsoncpp/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/jsoncpp/libjsoncpp/linux_glibc_x86_64_static/libjsoncpp.a prebuiltlibs/external/jsoncpp/linux_glibc_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/jsoncpp/include && cp -r external/jsoncpp/include/* prebuiltlibs/external/jsoncpp/include
        cp -r out/soong/ninja/external/jsoncpp prebuiltlibs/external/jsoncpp/external_jsoncpp-0
        grep '|external/jsoncpp' out/soong/module-info.txt >> prebuiltlibs/external/jsoncpp/MODULES
        du -ad1 external/jsoncpp | sort -rnk1 > prebuiltlibs/external/jsoncpp/.SIZE
        popd
    - name: write Android.bp external_jsoncpp-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libjsoncpp\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libjsoncpp.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libjsoncpp.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libjsoncpp.so\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libjsoncpp.a\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libjsoncpp.so\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libjsoncpp.a\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libjsoncpp.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libjsoncpp.a\",\n\tandroid_x86_64_static_apex29: \"android_x86_64_static_apex29/libjsoncpp.a\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libjsoncpp.a\",\n\tandroid_x86_64_static_cfi_apex29: \"android_x86_64_static_cfi_apex29/libjsoncpp.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libjsoncpp.a\",\n\tandroid_x86_x86_64_static_apex29: \"android_x86_x86_64_static_apex29/libjsoncpp.a\",\n\tandroid_x86_x86_64_static_apex30: \"android_x86_x86_64_static_apex30/libjsoncpp.a\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libjsoncpp.a\",\n\tsrcs: [\"android_x86_64_shared/libjsoncpp.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"29\", vndk: { enabled: true, }, apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}" >> prebuiltlibs/external/jsoncpp/Android.bp
        printf "\n" >> prebuiltlibs/external/jsoncpp/Android.bp
        popd
    - name: Archive external_jsoncpp-0
      uses: actions/upload-artifact@v3
      with:
        name: external_jsoncpp-0
        path: aosp/prebuiltlibs/external/jsoncpp
  external_libcap-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/libcap
      id: external_libcap
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcap"
        key: "external_libcap@$BRANCH"
        restore-keys: "external_libcap@$BRANCH"
    - name: Clone project external/libcap
      if: steps.external_libcap.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/libcap
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_libcap-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/libcap/libcap/android_recovery_x86_64_static/libcap.a out/soong/.intermediates/external/libcap/libcap/android_vendor.31_x86_64_shared/libcap.so out/soong/.intermediates/external/libcap/libcap/android_vendor.31_x86_x86_64_shared/libcap.so out/soong/.intermediates/external/libcap/libcap/android_x86_64_shared/libcap.so out/soong/.intermediates/external/libcap/libcap/android_x86_64_shared_apex29/libcap.so out/soong/.intermediates/external/libcap/libcap/android_x86_64_static/libcap.a out/soong/.intermediates/external/libcap/libcap/android_x86_64_static_apex10000/libcap.a out/soong/.intermediates/external/libcap/libcap/android_x86_x86_64_shared/libcap.so out/soong/.intermediates/external/libcap/libcap/linux_glibc_x86_64_static/libcap.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_libcap-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/libcap/libcap/android_recovery_x86_64_static/libcap.a ] && mkdir -p prebuiltlibs/external/libcap/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/libcap/libcap/android_recovery_x86_64_static/libcap.a prebuiltlibs/external/libcap/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcap/libcap/android_vendor.31_x86_64_shared/libcap.so ] && mkdir -p prebuiltlibs/external/libcap/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/libcap/libcap/android_vendor.31_x86_64_shared/libcap.so prebuiltlibs/external/libcap/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libcap/libcap/android_vendor.31_x86_x86_64_shared/libcap.so ] && mkdir -p prebuiltlibs/external/libcap/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libcap/libcap/android_vendor.31_x86_x86_64_shared/libcap.so prebuiltlibs/external/libcap/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libcap/libcap/android_x86_64_shared/libcap.so ] && mkdir -p prebuiltlibs/external/libcap/android_x86_64_shared/ && cp out/soong/.intermediates/external/libcap/libcap/android_x86_64_shared/libcap.so prebuiltlibs/external/libcap/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libcap/libcap/android_x86_64_shared_apex29/libcap.so ] && mkdir -p prebuiltlibs/external/libcap/android_x86_64_shared_apex29/ && cp out/soong/.intermediates/external/libcap/libcap/android_x86_64_shared_apex29/libcap.so prebuiltlibs/external/libcap/android_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/external/libcap/libcap/android_x86_64_static/libcap.a ] && mkdir -p prebuiltlibs/external/libcap/android_x86_64_static/ && cp out/soong/.intermediates/external/libcap/libcap/android_x86_64_static/libcap.a prebuiltlibs/external/libcap/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/libcap/libcap/android_x86_64_static_apex10000/libcap.a ] && mkdir -p prebuiltlibs/external/libcap/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/libcap/libcap/android_x86_64_static_apex10000/libcap.a prebuiltlibs/external/libcap/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/external/libcap/libcap/android_x86_x86_64_shared/libcap.so ] && mkdir -p prebuiltlibs/external/libcap/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libcap/libcap/android_x86_x86_64_shared/libcap.so prebuiltlibs/external/libcap/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libcap/libcap/linux_glibc_x86_64_static/libcap.a ] && mkdir -p prebuiltlibs/external/libcap/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/libcap/libcap/linux_glibc_x86_64_static/libcap.a prebuiltlibs/external/libcap/linux_glibc_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/libcap/libcap/include && cp -r external/libcap/libcap/include/* prebuiltlibs/external/libcap/libcap/include
        cp -r out/soong/ninja/external/libcap prebuiltlibs/external/libcap/external_libcap-0
        grep '|external/libcap' out/soong/module-info.txt >> prebuiltlibs/external/libcap/MODULES
        du -ad1 external/libcap | sort -rnk1 > prebuiltlibs/external/libcap/.SIZE
        popd
    - name: write Android.bp external_libcap-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libcap\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libcap.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libcap.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libcap.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libcap.so\",\n\tandroid_x86_64_shared_apex29: \"android_x86_64_shared_apex29/libcap.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libcap.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libcap.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libcap.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libcap.a\",\n\tsrcs: [\"android_x86_64_shared/libcap.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\",\"libc++\"],\n\tmin_sdk_version: \"29\", vndk: { enabled: true, }, apex_available: [\"//apex_available:platform\",\"com.android.adbd\",\"com.android.media.swcodec\",\"com.android.virt\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libcap/include\"],\n}" >> prebuiltlibs/external/libcap/Android.bp
        printf "\n" >> prebuiltlibs/external/libcap/Android.bp
        popd
    - name: Archive external_libcap-0
      uses: actions/upload-artifact@v3
      with:
        name: external_libcap-0
        path: aosp/prebuiltlibs/external/libcap
  external_minijail-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcap-0,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/libcap
      id: external_libcap
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcap"
        key: "external_libcap@$BRANCH"
        restore-keys: "external_libcap@$BRANCH"
    - name: Clone project external/libcap
      if: steps.external_libcap.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/libcap
    - name: Download artifact external_libcap-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcap-0
        path: aosp/prebuiltlibs/external/libcap/
    - name: Restore Cache external/minijail
      id: external_minijail
      uses: actions/cache@v3
      with:
        path: "aosp/external/minijail"
        key: "external_minijail@$BRANCH"
        restore-keys: "external_minijail@$BRANCH"
    - name: Clone project external/minijail
      if: steps.external_minijail.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/minijail
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_minijail-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/minijail/libminijail/android_recovery_x86_64_static/libminijail.a out/soong/.intermediates/external/minijail/libminijail/android_vendor.31_x86_64_shared/libminijail.so out/soong/.intermediates/external/minijail/libminijail/android_vendor.31_x86_x86_64_shared/libminijail.so out/soong/.intermediates/external/minijail/libminijail/android_x86_64_shared/libminijail.so out/soong/.intermediates/external/minijail/libminijail/android_x86_64_shared_apex29/libminijail.so out/soong/.intermediates/external/minijail/libminijail/android_x86_64_static_apex10000/libminijail.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_minijail-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/minijail/libminijail/android_recovery_x86_64_static/libminijail.a ] && mkdir -p prebuiltlibs/external/minijail/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/minijail/libminijail/android_recovery_x86_64_static/libminijail.a prebuiltlibs/external/minijail/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/minijail/libminijail/android_vendor.31_x86_64_shared/libminijail.so ] && mkdir -p prebuiltlibs/external/minijail/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/minijail/libminijail/android_vendor.31_x86_64_shared/libminijail.so prebuiltlibs/external/minijail/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/minijail/libminijail/android_vendor.31_x86_x86_64_shared/libminijail.so ] && mkdir -p prebuiltlibs/external/minijail/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/minijail/libminijail/android_vendor.31_x86_x86_64_shared/libminijail.so prebuiltlibs/external/minijail/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/minijail/libminijail/android_x86_64_shared/libminijail.so ] && mkdir -p prebuiltlibs/external/minijail/android_x86_64_shared/ && cp out/soong/.intermediates/external/minijail/libminijail/android_x86_64_shared/libminijail.so prebuiltlibs/external/minijail/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/minijail/libminijail/android_x86_64_shared_apex29/libminijail.so ] && mkdir -p prebuiltlibs/external/minijail/android_x86_64_shared_apex29/ && cp out/soong/.intermediates/external/minijail/libminijail/android_x86_64_shared_apex29/libminijail.so prebuiltlibs/external/minijail/android_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/external/minijail/libminijail/android_x86_64_static_apex10000/libminijail.a ] && mkdir -p prebuiltlibs/external/minijail/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/external/minijail/libminijail/android_x86_64_static_apex10000/libminijail.a prebuiltlibs/external/minijail/android_x86_64_static_apex10000/ || true
        mkdir -p prebuiltlibs/external/minijail/. && cp -r external/minijail/./* prebuiltlibs/external/minijail/.
        cp -r out/soong/ninja/external/minijail prebuiltlibs/external/minijail/external_minijail-0
        grep '|external/minijail' out/soong/module-info.txt >> prebuiltlibs/external/minijail/MODULES
        du -ad1 external/minijail | sort -rnk1 > prebuiltlibs/external/minijail/.SIZE
        popd
    - name: write Android.bp external_minijail-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libminijail\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libminijail.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libminijail.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libminijail.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libminijail.so\",\n\tandroid_x86_64_shared_apex29: \"android_x86_64_shared_apex29/libminijail.so\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libminijail.a\",\n\tsrcs: [\"android_x86_64_shared/libminijail.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\",\"libc++\",\"libcap\"],\n\tmin_sdk_version: \"29\", vndk: { enabled: true, }, apex_available: [\"//apex_available:platform\",\"com.android.adbd\",\"com.android.media.swcodec\",\"com.android.virt\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\".\"],\n}" >> prebuiltlibs/external/minijail/Android.bp
        printf "\n" >> prebuiltlibs/external/minijail/Android.bp
        popd
    - name: Archive external_minijail-0
      uses: actions/upload-artifact@v3
      with:
        name: external_minijail-0
        path: aosp/prebuiltlibs/external/minijail
  external_avb-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_boringssl-0,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/boringssl
      id: external_boringssl
      uses: actions/cache@v3
      with:
        path: "aosp/external/boringssl"
        key: "external_boringssl@$BRANCH"
        restore-keys: "external_boringssl@$BRANCH"
    - name: Clone project external/boringssl
      if: steps.external_boringssl.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/boringssl
    - name: Download artifact external_boringssl-0
      uses: actions/download-artifact@v3
      with:
        name: external_boringssl-0
        path: aosp/prebuiltlibs/external/boringssl/
    - name: Restore Cache external/avb
      id: external_avb
      uses: actions/cache@v3
      with:
        path: "aosp/external/avb"
        key: "external_avb@$BRANCH"
        restore-keys: "external_avb@$BRANCH"
    - name: Clone project external/avb
      if: steps.external_avb.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/avb
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_avb-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/avb/libavb/android_recovery_x86_64_static/libavb.a out/soong/.intermediates/external/avb/libavb/android_x86_64_static/libavb.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_avb-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/avb/libavb/android_recovery_x86_64_static/libavb.a ] && mkdir -p prebuiltlibs/external/avb/android_recovery_x86_64_static/ && cp out/soong/.intermediates/external/avb/libavb/android_recovery_x86_64_static/libavb.a prebuiltlibs/external/avb/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/avb/libavb/android_x86_64_static/libavb.a ] && mkdir -p prebuiltlibs/external/avb/android_x86_64_static/ && cp out/soong/.intermediates/external/avb/libavb/android_x86_64_static/libavb.a prebuiltlibs/external/avb/android_x86_64_static/ || true
        cp -r out/soong/ninja/external/avb prebuiltlibs/external/avb/external_avb-0
        grep '|external/avb' out/soong/module-info.txt >> prebuiltlibs/external/avb/MODULES
        du -ad1 external/avb | sort -rnk1 > prebuiltlibs/external/avb/.SIZE
        popd
    - name: write Android.bp external_avb-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_static {\n\tname: \"libavb\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libavb.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libavb.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libavb.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libcrypto\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/avb/Android.bp
        printf "\n" >> prebuiltlibs/external/avb/Android.bp
        popd
    - name: Archive external_avb-0
      uses: actions/upload-artifact@v3
      with:
        name: external_avb-0
        path: aosp/prebuiltlibs/external/avb
  system_gsid-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0,system_libbase-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact system_libbase-0
      uses: actions/download-artifact@v3
      with:
        name: system_libbase-0
        path: aosp/prebuiltlibs/system/libbase/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache system/gsid
      id: system_gsid
      uses: actions/cache@v3
      with:
        path: "aosp/system/gsid"
        key: "system_gsid@$BRANCH"
        restore-keys: "system_gsid@$BRANCH"
    - name: Clone project system/gsid
      if: steps.system_gsid.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/gsid
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target system_gsid-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/system/gsid/libgsi/android_recovery_x86_64_shared/libgsi.so out/soong/.intermediates/system/gsid/libgsi/android_recovery_x86_64_static/libgsi.a out/soong/.intermediates/system/gsid/libgsi/android_x86_64_shared/libgsi.so out/soong/.intermediates/system/gsid/libgsi/android_x86_64_static/libgsi.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target system_gsid-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/system/gsid/libgsi/android_recovery_x86_64_shared/libgsi.so ] && mkdir -p prebuiltlibs/system/gsid/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/gsid/libgsi/android_recovery_x86_64_shared/libgsi.so prebuiltlibs/system/gsid/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/gsid/libgsi/android_recovery_x86_64_static/libgsi.a ] && mkdir -p prebuiltlibs/system/gsid/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/gsid/libgsi/android_recovery_x86_64_static/libgsi.a prebuiltlibs/system/gsid/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/gsid/libgsi/android_x86_64_shared/libgsi.so ] && mkdir -p prebuiltlibs/system/gsid/android_x86_64_shared/ && cp out/soong/.intermediates/system/gsid/libgsi/android_x86_64_shared/libgsi.so prebuiltlibs/system/gsid/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/gsid/libgsi/android_x86_64_static/libgsi.a ] && mkdir -p prebuiltlibs/system/gsid/android_x86_64_static/ && cp out/soong/.intermediates/system/gsid/libgsi/android_x86_64_static/libgsi.a prebuiltlibs/system/gsid/android_x86_64_static/ || true
        mkdir -p prebuiltlibs/system/gsid/include && cp -r system/gsid/include/* prebuiltlibs/system/gsid/include
        cp -r out/soong/ninja/system/gsid prebuiltlibs/system/gsid/system_gsid-0
        grep '|system/gsid' out/soong/module-info.txt >> prebuiltlibs/system/gsid/MODULES
        du -ad1 system/gsid | sort -rnk1 > prebuiltlibs/system/gsid/.SIZE
        popd
    - name: write Android.bp system_gsid-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libgsi\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libgsi.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libgsi.a\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libgsi.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libgsi.a\",\n\tsrcs: [\"android_x86_64_shared/libgsi.so\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}" >> prebuiltlibs/system/gsid/Android.bp
        printf "\n" >> prebuiltlibs/system/gsid/Android.bp
        popd
    - name: Archive system_gsid-0
      uses: actions/upload-artifact@v3
      with:
        name: system_gsid-0
        path: aosp/prebuiltlibs/system/gsid
  system_core-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_avb-0,external_boringssl-0,external_brotli-0,external_e2fsprogs-0,external_gflags-0,external_jsoncpp-0,external_libcxx-0,external_libcxxabi-0,external_libevent-0,external_lzma-0,external_minijail-0,external_protobuf-0,external_zlib-0,prebuilts_rust-0,system_gsid-0,system_libbase-0,system_libprocinfo-0,system_logging-0,system_unwinding-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Restore Cache system/gsid
      id: system_gsid
      uses: actions/cache@v3
      with:
        path: "aosp/system/gsid"
        key: "system_gsid@$BRANCH"
        restore-keys: "system_gsid@$BRANCH"
    - name: Clone project system/gsid
      if: steps.system_gsid.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/gsid
    - name: Restore Cache hardware/interfaces
      id: hardware_interfaces
      uses: actions/cache@v3
      with:
        path: "aosp/hardware/interfaces"
        key: "hardware_interfaces@$BRANCH"
        restore-keys: "hardware_interfaces@$BRANCH"
    - name: Clone project hardware/interfaces
      if: steps.hardware_interfaces.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform hardware/interfaces
    - name: Restore Cache hardware/libhardware
      id: hardware_libhardware
      uses: actions/cache@v3
      with:
        path: "aosp/hardware/libhardware"
        key: "hardware_libhardware@$BRANCH"
        restore-keys: "hardware_libhardware@$BRANCH"
    - name: Clone project hardware/libhardware
      if: steps.hardware_libhardware.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform hardware/libhardware
    - name: Restore Cache packages/modules/StatsD
      id: packages_modules_StatsD
      uses: actions/cache@v3
      with:
        path: "aosp/packages/modules/StatsD"
        key: "packages_modules_StatsD@$BRANCH"
        restore-keys: "packages_modules_StatsD@$BRANCH"
    - name: Clone project packages/modules/StatsD
      if: steps.packages_modules_StatsD.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform packages/modules/StatsD
    - name: Restore Cache external/googletest
      id: external_googletest
      uses: actions/cache@v3
      with:
        path: "aosp/external/googletest"
        key: "external_googletest@$BRANCH"
        restore-keys: "external_googletest@$BRANCH"
    - name: Clone project external/googletest
      if: steps.external_googletest.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/googletest
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/e2fsprogs
      id: external_e2fsprogs
      uses: actions/cache@v3
      with:
        path: "aosp/external/e2fsprogs"
        key: "external_e2fsprogs@$BRANCH"
        restore-keys: "external_e2fsprogs@$BRANCH"
    - name: Clone project external/e2fsprogs
      if: steps.external_e2fsprogs.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/e2fsprogs
    - name: Download artifact external_e2fsprogs-0
      uses: actions/download-artifact@v3
      with:
        name: external_e2fsprogs-0
        path: aosp/prebuiltlibs/external/e2fsprogs/
    - name: Restore Cache external/boringssl
      id: external_boringssl
      uses: actions/cache@v3
      with:
        path: "aosp/external/boringssl"
        key: "external_boringssl@$BRANCH"
        restore-keys: "external_boringssl@$BRANCH"
    - name: Clone project external/boringssl
      if: steps.external_boringssl.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/boringssl
    - name: Download artifact external_boringssl-0
      uses: actions/download-artifact@v3
      with:
        name: external_boringssl-0
        path: aosp/prebuiltlibs/external/boringssl/
    - name: Download artifact system_logging-0
      uses: actions/download-artifact@v3
      with:
        name: system_logging-0
        path: aosp/prebuiltlibs/system/logging/
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Download artifact prebuilts_rust-0
      uses: actions/download-artifact@v3
      with:
        name: prebuilts_rust-0
        path: aosp/prebuiltlibs/prebuilts/rust/
    - name: Download artifact system_libbase-0
      uses: actions/download-artifact@v3
      with:
        name: system_libbase-0
        path: aosp/prebuiltlibs/system/libbase/
    - name: Restore Cache external/lzma
      id: external_lzma
      uses: actions/cache@v3
      with:
        path: "aosp/external/lzma"
        key: "external_lzma@$BRANCH"
        restore-keys: "external_lzma@$BRANCH"
    - name: Clone project external/lzma
      if: steps.external_lzma.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/lzma
    - name: Download artifact external_lzma-0
      uses: actions/download-artifact@v3
      with:
        name: external_lzma-0
        path: aosp/prebuiltlibs/external/lzma/
    - name: Restore Cache system/unwinding
      id: system_unwinding
      uses: actions/cache@v3
      with:
        path: "aosp/system/unwinding"
        key: "system_unwinding@$BRANCH"
        restore-keys: "system_unwinding@$BRANCH"
    - name: Clone project system/unwinding
      if: steps.system_unwinding.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/unwinding
    - name: Download artifact system_unwinding-0
      uses: actions/download-artifact@v3
      with:
        name: system_unwinding-0
        path: aosp/prebuiltlibs/system/unwinding/
    - name: Restore Cache system/libprocinfo
      id: system_libprocinfo
      uses: actions/cache@v3
      with:
        path: "aosp/system/libprocinfo"
        key: "system_libprocinfo@$BRANCH"
        restore-keys: "system_libprocinfo@$BRANCH"
    - name: Clone project system/libprocinfo
      if: steps.system_libprocinfo.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/libprocinfo
    - name: Download artifact system_libprocinfo-0
      uses: actions/download-artifact@v3
      with:
        name: system_libprocinfo-0
        path: aosp/prebuiltlibs/system/libprocinfo/
    - name: Restore Cache external/protobuf
      id: external_protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/protobuf"
        key: "external_protobuf@$BRANCH"
        restore-keys: "external_protobuf@$BRANCH"
    - name: Clone project external/protobuf
      if: steps.external_protobuf.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/protobuf
    - name: Download artifact external_protobuf-0
      uses: actions/download-artifact@v3
      with:
        name: external_protobuf-0
        path: aosp/prebuiltlibs/external/protobuf/
    - name: Restore Cache external/libevent
      id: external_libevent
      uses: actions/cache@v3
      with:
        path: "aosp/external/libevent"
        key: "external_libevent@$BRANCH"
        restore-keys: "external_libevent@$BRANCH"
    - name: Clone project external/libevent
      if: steps.external_libevent.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/libevent
    - name: Download artifact external_libevent-0
      uses: actions/download-artifact@v3
      with:
        name: external_libevent-0
        path: aosp/prebuiltlibs/external/libevent/
    - name: Restore Cache external/brotli
      id: external_brotli
      uses: actions/cache@v3
      with:
        path: "aosp/external/brotli"
        key: "external_brotli@$BRANCH"
        restore-keys: "external_brotli@$BRANCH"
    - name: Clone project external/brotli
      if: steps.external_brotli.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/brotli
    - name: Download artifact external_brotli-0
      uses: actions/download-artifact@v3
      with:
        name: external_brotli-0
        path: aosp/prebuiltlibs/external/brotli/
    - name: Restore Cache external/gflags
      id: external_gflags
      uses: actions/cache@v3
      with:
        path: "aosp/external/gflags"
        key: "external_gflags@$BRANCH"
        restore-keys: "external_gflags@$BRANCH"
    - name: Clone project external/gflags
      if: steps.external_gflags.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/gflags
    - name: Download artifact external_gflags-0
      uses: actions/download-artifact@v3
      with:
        name: external_gflags-0
        path: aosp/prebuiltlibs/external/gflags/
    - name: Restore Cache external/zlib
      id: external_zlib
      uses: actions/cache@v3
      with:
        path: "aosp/external/zlib"
        key: "external_zlib@$BRANCH"
        restore-keys: "external_zlib@$BRANCH"
    - name: Clone project external/zlib
      if: steps.external_zlib.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/zlib
    - name: Download artifact external_zlib-0
      uses: actions/download-artifact@v3
      with:
        name: external_zlib-0
        path: aosp/prebuiltlibs/external/zlib/
    - name: Restore Cache external/jsoncpp
      id: external_jsoncpp
      uses: actions/cache@v3
      with:
        path: "aosp/external/jsoncpp"
        key: "external_jsoncpp@$BRANCH"
        restore-keys: "external_jsoncpp@$BRANCH"
    - name: Clone project external/jsoncpp
      if: steps.external_jsoncpp.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/jsoncpp
    - name: Download artifact external_jsoncpp-0
      uses: actions/download-artifact@v3
      with:
        name: external_jsoncpp-0
        path: aosp/prebuiltlibs/external/jsoncpp/
    - name: Restore Cache external/minijail
      id: external_minijail
      uses: actions/cache@v3
      with:
        path: "aosp/external/minijail"
        key: "external_minijail@$BRANCH"
        restore-keys: "external_minijail@$BRANCH"
    - name: Clone project external/minijail
      if: steps.external_minijail.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/minijail
    - name: Download artifact external_minijail-0
      uses: actions/download-artifact@v3
      with:
        name: external_minijail-0
        path: aosp/prebuiltlibs/external/minijail/
    - name: Restore Cache external/avb
      id: external_avb
      uses: actions/cache@v3
      with:
        path: "aosp/external/avb"
        key: "external_avb@$BRANCH"
        restore-keys: "external_avb@$BRANCH"
    - name: Clone project external/avb
      if: steps.external_avb.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/avb
    - name: Download artifact external_avb-0
      uses: actions/download-artifact@v3
      with:
        name: external_avb-0
        path: aosp/prebuiltlibs/external/avb/
    - name: Restore Cache system/gsid
      id: system_gsid
      uses: actions/cache@v3
      with:
        path: "aosp/system/gsid"
        key: "system_gsid@$BRANCH"
        restore-keys: "system_gsid@$BRANCH"
    - name: Clone project system/gsid
      if: steps.system_gsid.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform system/gsid
    - name: Download artifact system_gsid-0
      uses: actions/download-artifact@v3
      with:
        name: system_gsid-0
        path: aosp/prebuiltlibs/system/gsid/
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target system_core-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_recovery_x86_64_static/libpropertyinfoparser.a out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_64_static/libpropertyinfoparser.a out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_64_static_apex10000/libpropertyinfoparser.a out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_x86_64_static/libpropertyinfoparser.a out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_x86_64_static_apex10000/libpropertyinfoparser.a out/soong/.intermediates/system/core/libkeyutils/libkeyutils/android_recovery_x86_64_shared/libkeyutils.so out/soong/.intermediates/system/core/libkeyutils/libkeyutils/android_x86_64_shared/libkeyutils.so out/soong/.intermediates/system/core/libkeyutils/libkeyutils/android_x86_64_static/libkeyutils.a out/soong/.intermediates/system/core/reboot/reboot/android_recovery_x86_64/reboot out/soong/.intermediates/system/core/reboot/reboot/android_x86_64/reboot out/soong/.intermediates/system/core/fs_mgr/libfstab/android_recovery_x86_64_static/libfstab.a out/soong/.intermediates/system/core/fs_mgr/libfstab/android_vendor.31_x86_64_static/libfstab.a out/soong/.intermediates/system/core/fs_mgr/libfstab/android_x86_64_static/libfstab.a out/soong/.intermediates/system/core/libasyncio/libasyncio/android_recovery_x86_64_shared/libasyncio.so out/soong/.intermediates/system/core/libasyncio/libasyncio/android_recovery_x86_64_static/libasyncio.a out/soong/.intermediates/system/core/libasyncio/libasyncio/android_x86_64_shared/libasyncio.so out/soong/.intermediates/system/core/libasyncio/libasyncio/android_x86_64_static_apex10000/libasyncio.a out/soong/.intermediates/system/core/libasyncio/libasyncio/android_x86_x86_64_shared/libasyncio.so out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_vendor.31_x86_64_static/libgrallocusage.a out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_vendor.31_x86_x86_64_static/libgrallocusage.a out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_x86_64_static/libgrallocusage.a out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_x86_64_static_apex29/libgrallocusage.a out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_x86_x86_64_static/libgrallocusage.a out/soong/.intermediates/system/core/libstats/pull_lazy/libstatspull_lazy/android_x86_64_static_lto-thin/libstatspull_lazy.a out/soong/.intermediates/system/core/libstats/pull_lazy/libstatspull_lazy/android_x86_x86_64_static_lto-thin/libstatspull_lazy.a out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_64_static/libstatssocket_lazy.a out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_64_static_lto-thin/libstatssocket_lazy.a out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_x86_64_static/libstatssocket_lazy.a out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_x86_64_static_lto-thin/libstatssocket_lazy.a out/soong/.intermediates/system/core/libsync/libsync/android_recovery_x86_64_static/libsync.a out/soong/.intermediates/system/core/libsync/libsync/android_vendor.31_x86_64_shared/libsync.so out/soong/.intermediates/system/core/libsync/libsync/android_vendor.31_x86_x86_64_shared/libsync.so out/soong/.intermediates/system/core/libsync/libsync/android_x86_64_shared/libsync.so out/soong/.intermediates/system/core/libsync/libsync/android_x86_64_static/libsync.a out/soong/.intermediates/system/core/libsync/libsync/android_x86_x86_64_shared/libsync.so out/soong/.intermediates/system/core/fs_mgr/libdm/libdm/android_x86_64_static/libdm.a out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_recovery_x86_64_shared/libcrypto_utils.so out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_recovery_x86_64_static/libcrypto_utils.a out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_vendor.31_x86_64_shared/libcrypto_utils.so out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_vendor.31_x86_x86_64_shared/libcrypto_utils.so out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_shared/libcrypto_utils.so out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_shared_apex10000/libcrypto_utils.so out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_static/libcrypto_utils.a out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_static_apex10000/libcrypto_utils.a out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_x86_64_shared/libcrypto_utils.so out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_x86_64_shared_apex10000/libcrypto_utils.so out/soong/.intermediates/system/core/libcutils/libcutils_bindgen/android_x86_64_rlib_rlib-std/libcutils_bindgen.rlib out/soong/.intermediates/system/core/libdiskconfig/libdiskconfig/android_vendor.31_x86_64_shared/libdiskconfig.so out/soong/.intermediates/system/core/libdiskconfig/libdiskconfig/android_vendor.31_x86_x86_64_shared/libdiskconfig.so out/soong/.intermediates/system/core/libdiskconfig/libdiskconfig/android_x86_64_shared/libdiskconfig.so out/soong/.intermediates/system/core/libnetutils/libnetutils/android_vendor.31_x86_64_shared/libnetutils.so out/soong/.intermediates/system/core/libnetutils/libnetutils/android_vendor.31_x86_x86_64_shared/libnetutils.so out/soong/.intermediates/system/core/libnetutils/libnetutils/android_x86_64_shared/libnetutils.so out/soong/.intermediates/system/core/libnetutils/libnetutils/android_x86_x86_64_shared/libnetutils.so out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_recovery_x86_64_shared/libpackagelistparser.so out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_x86_64_shared/libpackagelistparser.so out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_x86_64_static/libpackagelistparser.a out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_x86_x86_64_shared/libpackagelistparser.so out/soong/.intermediates/system/core/libqtaguid/libqtaguid/android_x86_64_shared/libqtaguid.so out/soong/.intermediates/system/core/libusbhost/libusbhost/android_vendor.31_x86_64_shared/libusbhost.so out/soong/.intermediates/system/core/libusbhost/libusbhost/android_vendor.31_x86_x86_64_shared/libusbhost.so out/soong/.intermediates/system/core/libusbhost/libusbhost/android_x86_64_shared/libusbhost.so out/soong/.intermediates/system/core/libusbhost/libusbhost/android_x86_x86_64_shared/libusbhost.so out/soong/.intermediates/system/core/libutils/libutils/android_recovery_x86_64_shared/libutils.so out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_64_shared/libutils.so out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_64_static/libutils.a out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_x86_64_shared/libutils.so out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_x86_64_static/libutils.a out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_shared/libutils.so out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_shared_apex29/libutils.so out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static/libutils.a out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static_apex29/libutils.a out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static_apex30/libutils.a out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static_cfi_apex29/libutils.a out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_shared/libutils.so out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_shared_apex29/libutils.so out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_static/libutils.a out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_static_apex30/libutils.a out/soong/.intermediates/system/core/libutils/libutils/linux_glibc_x86_64_shared/libutils.so out/soong/.intermediates/system/core/libutils/libutils/linux_glibc_x86_64_static/libutils.a out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_vendor.31_x86_64_shared/libvndksupport.so out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_vendor.31_x86_x86_64_shared/libvndksupport.so out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_x86_64_shared/libvndksupport.so out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_x86_64_shared_29/libvndksupport.so out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_x86_x86_64_shared/libvndksupport.so out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_recovery_x86_64_static/libdebuggerd_handler_fallback.a out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_64_static/libdebuggerd_handler_fallback.a out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_64_static_apex10000/libdebuggerd_handler_fallback.a out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_x86_64_static/libdebuggerd_handler_fallback.a out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_x86_64_static_apex10000/libdebuggerd_handler_fallback.a out/soong/.intermediates/system/core/debuggerd/libdebuggerd_client/android_x86_64_shared/libdebuggerd_client.so out/soong/.intermediates/system/core/debuggerd/libdebuggerd_client/android_x86_x86_64_shared/libdebuggerd_client.so out/soong/.intermediates/system/core/debuggerd/crash_dump/android_x86_64_apex10000/crash_dump64 out/soong/.intermediates/system/core/debuggerd/crash_dump/android_x86_x86_64_apex10000/crash_dump32 out/soong/.intermediates/system/core/debuggerd/debuggerd/android_x86_64/debuggerd out/soong/.intermediates/system/core/debuggerd/tombstoned/android_x86_64/tombstoned out/soong/.intermediates/system/core/debuggerd/libtombstoned_client/android_x86_64_shared/libtombstoned_client.so out/soong/.intermediates/system/core/debuggerd/libtombstoned_client/android_x86_x86_64_shared/libtombstoned_client.so out/soong/.intermediates/system/core/diagnose_usb/libdiagnose_usb/android_recovery_x86_64_static/libdiagnose_usb.a out/soong/.intermediates/system/core/diagnose_usb/libdiagnose_usb/android_x86_64_static/libdiagnose_usb.a out/soong/.intermediates/system/core/diagnose_usb/libdiagnose_usb/android_x86_64_static_apex10000/libdiagnose_usb.a out/soong/.intermediates/system/core/fs_mgr/clean_scratch_files/android_x86_64/clean_scratch_files out/soong/.intermediates/system/core/fs_mgr/libsnapshot/snapuserd/android_x86_64/snapuserd out/soong/.intermediates/system/core/fs_mgr/tools/dmctl/android_x86_64/dmctl out/soong/.intermediates/system/core/fs_mgr/tools/dmuserd/android_x86_64/dmuserd out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_recovery_x86_64_static/libbatterymonitor.a out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_vendor.31_x86_64_static/libbatterymonitor.a out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_vendor.31_x86_x86_64_static/libbatterymonitor.a out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_x86_64_static/libbatterymonitor.a out/soong/.intermediates/system/core/libappfuse/libappfuse/android_x86_64_shared/libappfuse.so out/soong/.intermediates/system/core/libappfuse/libappfuse/android_x86_x86_64_shared/libappfuse.so out/soong/.intermediates/system/core/libcutils/libcutils/android_recovery_x86_64_shared/libcutils.so out/soong/.intermediates/system/core/libcutils/libcutils/android_recovery_x86_64_static/libcutils.a out/soong/.intermediates/system/core/libcutils/libcutils/android_vendor.31_x86_64_shared/libcutils.so out/soong/.intermediates/system/core/libcutils/libcutils/android_vendor.31_x86_x86_64_shared/libcutils.so out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_shared/libcutils.so out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_shared_apex10000/libcutils.so out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_shared_apex29/libcutils.so out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static/libcutils.a out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_apex10000/libcutils.a out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_apex30/libcutils.a out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_cfi/libcutils.a out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_cfi_apex29/libcutils.a out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_shared/libcutils.so out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_shared_apex10000/libcutils.so out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_static/libcutils.a out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_static_apex30/libcutils.a out/soong/.intermediates/system/core/libcutils/libcutils/linux_glibc_x86_64_shared/libcutils.so out/soong/.intermediates/system/core/libcutils/libcutils/linux_glibc_x86_64_static/libcutils.a out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_recovery_x86_64_shared/libcutils_sockets.so out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_recovery_x86_64_static/libcutils_sockets.a out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_x86_64_shared/libcutils_sockets.so out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_x86_64_static_apex10000/libcutils_sockets.a out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_recovery_x86_64_shared/libprocessgroup.so out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_vendor.31_x86_64_shared/libprocessgroup.so out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_vendor.31_x86_x86_64_shared/libprocessgroup.so out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_64_shared/libprocessgroup.so out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_64_static_apex30/libprocessgroup.a out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_64_static_cfi_apex29/libprocessgroup.a out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_x86_64_shared/libprocessgroup.so out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_x86_64_static_apex30/libprocessgroup.a out/soong/.intermediates/system/core/libprocessgroup/cgrouprc/libcgrouprc/android_x86_64_shared/libcgrouprc.so out/soong/.intermediates/system/core/libprocessgroup/cgrouprc/libcgrouprc/android_x86_64_shared_29/libcgrouprc.so out/soong/.intermediates/system/core/libprocessgroup/cgrouprc/libcgrouprc/android_x86_x86_64_shared/libcgrouprc.so out/soong/.intermediates/system/core/libsparse/libsparse/android_recovery_x86_64_shared/libsparse.so out/soong/.intermediates/system/core/libsparse/libsparse/android_x86_64_shared/libsparse.so out/soong/.intermediates/system/core/libsparse/libsparse/android_x86_64_static/libsparse.a out/soong/.intermediates/system/core/libstats/push_compat/libstatspush_compat/android_x86_64_static_cfi/libstatspush_compat.a out/soong/.intermediates/system/core/libstats/push_compat/libstatspush_compat/android_x86_64_static_cfi_apex29/libstatspush_compat.a out/soong/.intermediates/system/core/libsysutils/libsysutils/android_vendor.31_x86_64_shared/libsysutils.so out/soong/.intermediates/system/core/libsysutils/libsysutils/android_vendor.31_x86_x86_64_shared/libsysutils.so out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_shared/libsysutils.so out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_static_apex30/libsysutils.a out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_static_cfi/libsysutils.a out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_static_cfi_apex29/libsysutils.a out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_x86_64_shared/libsysutils.so out/soong/.intermediates/system/core/libutils/libutilscallstack/android_vendor.31_x86_64_shared/libutilscallstack.so out/soong/.intermediates/system/core/libutils/libutilscallstack/android_vendor.31_x86_x86_64_shared/libutilscallstack.so out/soong/.intermediates/system/core/libutils/libutilscallstack/android_x86_64_shared/libutilscallstack.so out/soong/.intermediates/system/core/libutils/libutilscallstack/android_x86_x86_64_shared/libutilscallstack.so out/soong/.intermediates/system/core/llkd/llkd/android_x86_64/llkd out/soong/.intermediates/system/core/mini_keyctl/mini-keyctl/android_x86_64/mini-keyctl out/soong/.intermediates/system/core/mini_keyctl/libmini_keyctl_static/android_x86_64_static/libmini_keyctl_static.a out/soong/.intermediates/system/core/sdcard/sdcard/android_x86_64/sdcard out/soong/.intermediates/system/core/toolbox/toolbox/android_recovery_x86_64/toolbox out/soong/.intermediates/system/core/toolbox/toolbox/android_x86_64/toolbox out/soong/.intermediates/system/core/toolbox/toolbox_vendor/android_vendor.31_x86_64/toolbox out/soong/.intermediates/system/core/watchdogd/watchdogd/android_recovery_x86_64/watchdogd out/soong/.intermediates/system/core/watchdogd/watchdogd/android_x86_64/watchdogd out/soong/.intermediates/system/core/fs_mgr/libfs_avb/libfs_avb/android_x86_64_static/libfs_avb.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target system_core-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_recovery_x86_64_static/libpropertyinfoparser.a ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_recovery_x86_64_static/libpropertyinfoparser.a prebuiltlibs/system/core/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_64_static/libpropertyinfoparser.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_64_static/libpropertyinfoparser.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_64_static_apex10000/libpropertyinfoparser.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_64_static_apex10000/libpropertyinfoparser.a prebuiltlibs/system/core/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_x86_64_static/libpropertyinfoparser.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_x86_64_static/libpropertyinfoparser.a prebuiltlibs/system/core/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_x86_64_static_apex10000/libpropertyinfoparser.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/core/property_service/libpropertyinfoparser/libpropertyinfoparser/android_x86_x86_64_static_apex10000/libpropertyinfoparser.a prebuiltlibs/system/core/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/libkeyutils/libkeyutils/android_recovery_x86_64_shared/libkeyutils.so ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/core/libkeyutils/libkeyutils/android_recovery_x86_64_shared/libkeyutils.so prebuiltlibs/system/core/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libkeyutils/libkeyutils/android_x86_64_shared/libkeyutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libkeyutils/libkeyutils/android_x86_64_shared/libkeyutils.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libkeyutils/libkeyutils/android_x86_64_static/libkeyutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/libkeyutils/libkeyutils/android_x86_64_static/libkeyutils.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/reboot/reboot/android_recovery_x86_64/reboot ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64/ && cp out/soong/.intermediates/system/core/reboot/reboot/android_recovery_x86_64/reboot prebuiltlibs/system/core/android_recovery_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/reboot/reboot/android_x86_64/reboot ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/reboot/reboot/android_x86_64/reboot prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/fs_mgr/libfstab/android_recovery_x86_64_static/libfstab.a ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/core/fs_mgr/libfstab/android_recovery_x86_64_static/libfstab.a prebuiltlibs/system/core/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/fs_mgr/libfstab/android_vendor.31_x86_64_static/libfstab.a ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/system/core/fs_mgr/libfstab/android_vendor.31_x86_64_static/libfstab.a prebuiltlibs/system/core/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/fs_mgr/libfstab/android_x86_64_static/libfstab.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/fs_mgr/libfstab/android_x86_64_static/libfstab.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libasyncio/libasyncio/android_recovery_x86_64_shared/libasyncio.so ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/core/libasyncio/libasyncio/android_recovery_x86_64_shared/libasyncio.so prebuiltlibs/system/core/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libasyncio/libasyncio/android_recovery_x86_64_static/libasyncio.a ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/core/libasyncio/libasyncio/android_recovery_x86_64_static/libasyncio.a prebuiltlibs/system/core/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libasyncio/libasyncio/android_x86_64_shared/libasyncio.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libasyncio/libasyncio/android_x86_64_shared/libasyncio.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libasyncio/libasyncio/android_x86_64_static_apex10000/libasyncio.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/core/libasyncio/libasyncio/android_x86_64_static_apex10000/libasyncio.a prebuiltlibs/system/core/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/libasyncio/libasyncio/android_x86_x86_64_shared/libasyncio.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libasyncio/libasyncio/android_x86_x86_64_shared/libasyncio.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_vendor.31_x86_64_static/libgrallocusage.a ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_vendor.31_x86_64_static/libgrallocusage.a prebuiltlibs/system/core/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_vendor.31_x86_x86_64_static/libgrallocusage.a ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_vendor.31_x86_x86_64_static/libgrallocusage.a prebuiltlibs/system/core/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_x86_64_static/libgrallocusage.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_x86_64_static/libgrallocusage.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_x86_64_static_apex29/libgrallocusage.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex29/ && cp out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_x86_64_static_apex29/libgrallocusage.a prebuiltlibs/system/core/android_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_x86_x86_64_static/libgrallocusage.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/core/libgrallocusage/libgrallocusage/android_x86_x86_64_static/libgrallocusage.a prebuiltlibs/system/core/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libstats/pull_lazy/libstatspull_lazy/android_x86_64_static_lto-thin/libstatspull_lazy.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_lto-thin/ && cp out/soong/.intermediates/system/core/libstats/pull_lazy/libstatspull_lazy/android_x86_64_static_lto-thin/libstatspull_lazy.a prebuiltlibs/system/core/android_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/system/core/libstats/pull_lazy/libstatspull_lazy/android_x86_x86_64_static_lto-thin/libstatspull_lazy.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static_lto-thin/ && cp out/soong/.intermediates/system/core/libstats/pull_lazy/libstatspull_lazy/android_x86_x86_64_static_lto-thin/libstatspull_lazy.a prebuiltlibs/system/core/android_x86_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_64_static/libstatssocket_lazy.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_64_static/libstatssocket_lazy.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_64_static_lto-thin/libstatssocket_lazy.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_lto-thin/ && cp out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_64_static_lto-thin/libstatssocket_lazy.a prebuiltlibs/system/core/android_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_x86_64_static/libstatssocket_lazy.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_x86_64_static/libstatssocket_lazy.a prebuiltlibs/system/core/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_x86_64_static_lto-thin/libstatssocket_lazy.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static_lto-thin/ && cp out/soong/.intermediates/system/core/libstats/socket_lazy/libstatssocket_lazy/android_x86_x86_64_static_lto-thin/libstatssocket_lazy.a prebuiltlibs/system/core/android_x86_x86_64_static_lto-thin/ || true
        [ -e out/soong/.intermediates/system/core/libsync/libsync/android_recovery_x86_64_static/libsync.a ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/core/libsync/libsync/android_recovery_x86_64_static/libsync.a prebuiltlibs/system/core/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libsync/libsync/android_vendor.31_x86_64_shared/libsync.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libsync/libsync/android_vendor.31_x86_64_shared/libsync.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libsync/libsync/android_vendor.31_x86_x86_64_shared/libsync.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libsync/libsync/android_vendor.31_x86_x86_64_shared/libsync.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libsync/libsync/android_x86_64_shared/libsync.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libsync/libsync/android_x86_64_shared/libsync.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libsync/libsync/android_x86_64_static/libsync.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/libsync/libsync/android_x86_64_static/libsync.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libsync/libsync/android_x86_x86_64_shared/libsync.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libsync/libsync/android_x86_x86_64_shared/libsync.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/fs_mgr/libdm/libdm/android_x86_64_static/libdm.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/fs_mgr/libdm/libdm/android_x86_64_static/libdm.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_recovery_x86_64_shared/libcrypto_utils.so ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_recovery_x86_64_shared/libcrypto_utils.so prebuiltlibs/system/core/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_recovery_x86_64_static/libcrypto_utils.a ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_recovery_x86_64_static/libcrypto_utils.a prebuiltlibs/system/core/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_vendor.31_x86_64_shared/libcrypto_utils.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_vendor.31_x86_64_shared/libcrypto_utils.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_vendor.31_x86_x86_64_shared/libcrypto_utils.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_vendor.31_x86_x86_64_shared/libcrypto_utils.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_shared/libcrypto_utils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_shared/libcrypto_utils.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_shared_apex10000/libcrypto_utils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_shared_apex10000/libcrypto_utils.so prebuiltlibs/system/core/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_static/libcrypto_utils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_static/libcrypto_utils.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_static_apex10000/libcrypto_utils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_64_static_apex10000/libcrypto_utils.a prebuiltlibs/system/core/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_x86_64_shared/libcrypto_utils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_x86_64_shared/libcrypto_utils.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_x86_64_shared_apex10000/libcrypto_utils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/system/core/libcrypto_utils/libcrypto_utils/android_x86_x86_64_shared_apex10000/libcrypto_utils.so prebuiltlibs/system/core/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils_bindgen/android_x86_64_rlib_rlib-std/libcutils_bindgen.rlib ] && mkdir -p prebuiltlibs/system/core/android_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/system/core/libcutils/libcutils_bindgen/android_x86_64_rlib_rlib-std/libcutils_bindgen.rlib prebuiltlibs/system/core/android_x86_64_rlib_rlib-std/ || true
        [ -e out/soong/.intermediates/system/core/libdiskconfig/libdiskconfig/android_vendor.31_x86_64_shared/libdiskconfig.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libdiskconfig/libdiskconfig/android_vendor.31_x86_64_shared/libdiskconfig.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libdiskconfig/libdiskconfig/android_vendor.31_x86_x86_64_shared/libdiskconfig.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libdiskconfig/libdiskconfig/android_vendor.31_x86_x86_64_shared/libdiskconfig.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libdiskconfig/libdiskconfig/android_x86_64_shared/libdiskconfig.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libdiskconfig/libdiskconfig/android_x86_64_shared/libdiskconfig.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libnetutils/libnetutils/android_vendor.31_x86_64_shared/libnetutils.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libnetutils/libnetutils/android_vendor.31_x86_64_shared/libnetutils.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libnetutils/libnetutils/android_vendor.31_x86_x86_64_shared/libnetutils.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libnetutils/libnetutils/android_vendor.31_x86_x86_64_shared/libnetutils.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libnetutils/libnetutils/android_x86_64_shared/libnetutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libnetutils/libnetutils/android_x86_64_shared/libnetutils.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libnetutils/libnetutils/android_x86_x86_64_shared/libnetutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libnetutils/libnetutils/android_x86_x86_64_shared/libnetutils.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_recovery_x86_64_shared/libpackagelistparser.so ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_recovery_x86_64_shared/libpackagelistparser.so prebuiltlibs/system/core/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_x86_64_shared/libpackagelistparser.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_x86_64_shared/libpackagelistparser.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_x86_64_static/libpackagelistparser.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_x86_64_static/libpackagelistparser.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_x86_x86_64_shared/libpackagelistparser.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libpackagelistparser/libpackagelistparser/android_x86_x86_64_shared/libpackagelistparser.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libqtaguid/libqtaguid/android_x86_64_shared/libqtaguid.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libqtaguid/libqtaguid/android_x86_64_shared/libqtaguid.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libusbhost/libusbhost/android_vendor.31_x86_64_shared/libusbhost.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libusbhost/libusbhost/android_vendor.31_x86_64_shared/libusbhost.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libusbhost/libusbhost/android_vendor.31_x86_x86_64_shared/libusbhost.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libusbhost/libusbhost/android_vendor.31_x86_x86_64_shared/libusbhost.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libusbhost/libusbhost/android_x86_64_shared/libusbhost.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libusbhost/libusbhost/android_x86_64_shared/libusbhost.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libusbhost/libusbhost/android_x86_x86_64_shared/libusbhost.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libusbhost/libusbhost/android_x86_x86_64_shared/libusbhost.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_recovery_x86_64_shared/libutils.so ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_recovery_x86_64_shared/libutils.so prebuiltlibs/system/core/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_64_shared/libutils.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_64_shared/libutils.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_64_static/libutils.a ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_64_static/libutils.a prebuiltlibs/system/core/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_x86_64_shared/libutils.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_x86_64_shared/libutils.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_x86_64_static/libutils.a ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_vendor.31_x86_x86_64_static/libutils.a prebuiltlibs/system/core/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_shared/libutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_shared/libutils.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_shared_apex29/libutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared_apex29/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_shared_apex29/libutils.so prebuiltlibs/system/core/android_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static/libutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static/libutils.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static_apex29/libutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex29/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static_apex29/libutils.a prebuiltlibs/system/core/android_x86_64_static_apex29/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static_apex30/libutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex30/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static_apex30/libutils.a prebuiltlibs/system/core/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static_cfi_apex29/libutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_cfi_apex29/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_x86_64_static_cfi_apex29/libutils.a prebuiltlibs/system/core/android_x86_64_static_cfi_apex29/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_shared/libutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_shared/libutils.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_shared_apex29/libutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared_apex29/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_shared_apex29/libutils.so prebuiltlibs/system/core/android_x86_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_static/libutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_static/libutils.a prebuiltlibs/system/core/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_static_apex30/libutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static_apex30/ && cp out/soong/.intermediates/system/core/libutils/libutils/android_x86_x86_64_static_apex30/libutils.a prebuiltlibs/system/core/android_x86_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/linux_glibc_x86_64_shared/libutils.so ] && mkdir -p prebuiltlibs/system/core/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/system/core/libutils/libutils/linux_glibc_x86_64_shared/libutils.so prebuiltlibs/system/core/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutils/linux_glibc_x86_64_static/libutils.a ] && mkdir -p prebuiltlibs/system/core/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/system/core/libutils/libutils/linux_glibc_x86_64_static/libutils.a prebuiltlibs/system/core/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_vendor.31_x86_64_shared/libvndksupport.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_vendor.31_x86_64_shared/libvndksupport.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_vendor.31_x86_x86_64_shared/libvndksupport.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_vendor.31_x86_x86_64_shared/libvndksupport.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_x86_64_shared/libvndksupport.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_x86_64_shared/libvndksupport.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_x86_64_shared_29/libvndksupport.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared_29/ && cp out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_x86_64_shared_29/libvndksupport.so prebuiltlibs/system/core/android_x86_64_shared_29/ || true
        [ -e out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_x86_x86_64_shared/libvndksupport.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libvndksupport/libvndksupport/android_x86_x86_64_shared/libvndksupport.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_recovery_x86_64_static/libdebuggerd_handler_fallback.a ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_recovery_x86_64_static/libdebuggerd_handler_fallback.a prebuiltlibs/system/core/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_64_static/libdebuggerd_handler_fallback.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_64_static/libdebuggerd_handler_fallback.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_64_static_apex10000/libdebuggerd_handler_fallback.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_64_static_apex10000/libdebuggerd_handler_fallback.a prebuiltlibs/system/core/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_x86_64_static/libdebuggerd_handler_fallback.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_x86_64_static/libdebuggerd_handler_fallback.a prebuiltlibs/system/core/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_x86_64_static_apex10000/libdebuggerd_handler_fallback.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/core/debuggerd/libdebuggerd_handler_fallback/android_x86_x86_64_static_apex10000/libdebuggerd_handler_fallback.a prebuiltlibs/system/core/android_x86_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/libdebuggerd_client/android_x86_64_shared/libdebuggerd_client.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/debuggerd/libdebuggerd_client/android_x86_64_shared/libdebuggerd_client.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/libdebuggerd_client/android_x86_x86_64_shared/libdebuggerd_client.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/debuggerd/libdebuggerd_client/android_x86_x86_64_shared/libdebuggerd_client.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/crash_dump/android_x86_64_apex10000/crash_dump64 ] && mkdir -p prebuiltlibs/system/core/android_x86_64_apex10000/ && cp out/soong/.intermediates/system/core/debuggerd/crash_dump/android_x86_64_apex10000/crash_dump64 prebuiltlibs/system/core/android_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/crash_dump/android_x86_x86_64_apex10000/crash_dump32 ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_apex10000/ && cp out/soong/.intermediates/system/core/debuggerd/crash_dump/android_x86_x86_64_apex10000/crash_dump32 prebuiltlibs/system/core/android_x86_x86_64_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/debuggerd/android_x86_64/debuggerd ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/debuggerd/debuggerd/android_x86_64/debuggerd prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/tombstoned/android_x86_64/tombstoned ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/debuggerd/tombstoned/android_x86_64/tombstoned prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/libtombstoned_client/android_x86_64_shared/libtombstoned_client.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/debuggerd/libtombstoned_client/android_x86_64_shared/libtombstoned_client.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/debuggerd/libtombstoned_client/android_x86_x86_64_shared/libtombstoned_client.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/debuggerd/libtombstoned_client/android_x86_x86_64_shared/libtombstoned_client.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/diagnose_usb/libdiagnose_usb/android_recovery_x86_64_static/libdiagnose_usb.a ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/core/diagnose_usb/libdiagnose_usb/android_recovery_x86_64_static/libdiagnose_usb.a prebuiltlibs/system/core/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/diagnose_usb/libdiagnose_usb/android_x86_64_static/libdiagnose_usb.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/diagnose_usb/libdiagnose_usb/android_x86_64_static/libdiagnose_usb.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/diagnose_usb/libdiagnose_usb/android_x86_64_static_apex10000/libdiagnose_usb.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/core/diagnose_usb/libdiagnose_usb/android_x86_64_static_apex10000/libdiagnose_usb.a prebuiltlibs/system/core/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/fs_mgr/clean_scratch_files/android_x86_64/clean_scratch_files ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/fs_mgr/clean_scratch_files/android_x86_64/clean_scratch_files prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/fs_mgr/libsnapshot/snapuserd/android_x86_64/snapuserd ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/fs_mgr/libsnapshot/snapuserd/android_x86_64/snapuserd prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/fs_mgr/tools/dmctl/android_x86_64/dmctl ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/fs_mgr/tools/dmctl/android_x86_64/dmctl prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/fs_mgr/tools/dmuserd/android_x86_64/dmuserd ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/fs_mgr/tools/dmuserd/android_x86_64/dmuserd prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_recovery_x86_64_static/libbatterymonitor.a ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_recovery_x86_64_static/libbatterymonitor.a prebuiltlibs/system/core/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_vendor.31_x86_64_static/libbatterymonitor.a ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_vendor.31_x86_64_static/libbatterymonitor.a prebuiltlibs/system/core/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_vendor.31_x86_x86_64_static/libbatterymonitor.a ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_vendor.31_x86_x86_64_static/libbatterymonitor.a prebuiltlibs/system/core/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_x86_64_static/libbatterymonitor.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/healthd/libbatterymonitor/android_x86_64_static/libbatterymonitor.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libappfuse/libappfuse/android_x86_64_shared/libappfuse.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libappfuse/libappfuse/android_x86_64_shared/libappfuse.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libappfuse/libappfuse/android_x86_x86_64_shared/libappfuse.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libappfuse/libappfuse/android_x86_x86_64_shared/libappfuse.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_recovery_x86_64_shared/libcutils.so ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_recovery_x86_64_shared/libcutils.so prebuiltlibs/system/core/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_recovery_x86_64_static/libcutils.a ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_recovery_x86_64_static/libcutils.a prebuiltlibs/system/core/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_vendor.31_x86_64_shared/libcutils.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_vendor.31_x86_64_shared/libcutils.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_vendor.31_x86_x86_64_shared/libcutils.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_vendor.31_x86_x86_64_shared/libcutils.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_shared/libcutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_shared/libcutils.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_shared_apex10000/libcutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared_apex10000/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_shared_apex10000/libcutils.so prebuiltlibs/system/core/android_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_shared_apex29/libcutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared_apex29/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_shared_apex29/libcutils.so prebuiltlibs/system/core/android_x86_64_shared_apex29/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static/libcutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static/libcutils.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_apex10000/libcutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_apex10000/libcutils.a prebuiltlibs/system/core/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_apex30/libcutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex30/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_apex30/libcutils.a prebuiltlibs/system/core/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_cfi/libcutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_cfi/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_cfi/libcutils.a prebuiltlibs/system/core/android_x86_64_static_cfi/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_cfi_apex29/libcutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_cfi_apex29/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_64_static_cfi_apex29/libcutils.a prebuiltlibs/system/core/android_x86_64_static_cfi_apex29/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_shared/libcutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_shared/libcutils.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_shared_apex10000/libcutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared_apex10000/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_shared_apex10000/libcutils.so prebuiltlibs/system/core/android_x86_x86_64_shared_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_static/libcutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_static/libcutils.a prebuiltlibs/system/core/android_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_static_apex30/libcutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static_apex30/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/android_x86_x86_64_static_apex30/libcutils.a prebuiltlibs/system/core/android_x86_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/linux_glibc_x86_64_shared/libcutils.so ] && mkdir -p prebuiltlibs/system/core/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/linux_glibc_x86_64_shared/libcutils.so prebuiltlibs/system/core/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils/linux_glibc_x86_64_static/libcutils.a ] && mkdir -p prebuiltlibs/system/core/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/system/core/libcutils/libcutils/linux_glibc_x86_64_static/libcutils.a prebuiltlibs/system/core/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_recovery_x86_64_shared/libcutils_sockets.so ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_recovery_x86_64_shared/libcutils_sockets.so prebuiltlibs/system/core/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_recovery_x86_64_static/libcutils_sockets.a ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_static/ && cp out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_recovery_x86_64_static/libcutils_sockets.a prebuiltlibs/system/core/android_recovery_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_x86_64_shared/libcutils_sockets.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_x86_64_shared/libcutils_sockets.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_x86_64_static_apex10000/libcutils_sockets.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex10000/ && cp out/soong/.intermediates/system/core/libcutils/libcutils_sockets/android_x86_64_static_apex10000/libcutils_sockets.a prebuiltlibs/system/core/android_x86_64_static_apex10000/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_recovery_x86_64_shared/libprocessgroup.so ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_recovery_x86_64_shared/libprocessgroup.so prebuiltlibs/system/core/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_vendor.31_x86_64_shared/libprocessgroup.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_vendor.31_x86_64_shared/libprocessgroup.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_vendor.31_x86_x86_64_shared/libprocessgroup.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_vendor.31_x86_x86_64_shared/libprocessgroup.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_64_shared/libprocessgroup.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_64_shared/libprocessgroup.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_64_static_apex30/libprocessgroup.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex30/ && cp out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_64_static_apex30/libprocessgroup.a prebuiltlibs/system/core/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_64_static_cfi_apex29/libprocessgroup.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_cfi_apex29/ && cp out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_64_static_cfi_apex29/libprocessgroup.a prebuiltlibs/system/core/android_x86_64_static_cfi_apex29/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_x86_64_shared/libprocessgroup.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_x86_64_shared/libprocessgroup.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_x86_64_static_apex30/libprocessgroup.a ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_static_apex30/ && cp out/soong/.intermediates/system/core/libprocessgroup/libprocessgroup/android_x86_x86_64_static_apex30/libprocessgroup.a prebuiltlibs/system/core/android_x86_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/cgrouprc/libcgrouprc/android_x86_64_shared/libcgrouprc.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libprocessgroup/cgrouprc/libcgrouprc/android_x86_64_shared/libcgrouprc.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/cgrouprc/libcgrouprc/android_x86_64_shared_29/libcgrouprc.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared_29/ && cp out/soong/.intermediates/system/core/libprocessgroup/cgrouprc/libcgrouprc/android_x86_64_shared_29/libcgrouprc.so prebuiltlibs/system/core/android_x86_64_shared_29/ || true
        [ -e out/soong/.intermediates/system/core/libprocessgroup/cgrouprc/libcgrouprc/android_x86_x86_64_shared/libcgrouprc.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libprocessgroup/cgrouprc/libcgrouprc/android_x86_x86_64_shared/libcgrouprc.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libsparse/libsparse/android_recovery_x86_64_shared/libsparse.so ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/system/core/libsparse/libsparse/android_recovery_x86_64_shared/libsparse.so prebuiltlibs/system/core/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libsparse/libsparse/android_x86_64_shared/libsparse.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libsparse/libsparse/android_x86_64_shared/libsparse.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libsparse/libsparse/android_x86_64_static/libsparse.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/libsparse/libsparse/android_x86_64_static/libsparse.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/libstats/push_compat/libstatspush_compat/android_x86_64_static_cfi/libstatspush_compat.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_cfi/ && cp out/soong/.intermediates/system/core/libstats/push_compat/libstatspush_compat/android_x86_64_static_cfi/libstatspush_compat.a prebuiltlibs/system/core/android_x86_64_static_cfi/ || true
        [ -e out/soong/.intermediates/system/core/libstats/push_compat/libstatspush_compat/android_x86_64_static_cfi_apex29/libstatspush_compat.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_cfi_apex29/ && cp out/soong/.intermediates/system/core/libstats/push_compat/libstatspush_compat/android_x86_64_static_cfi_apex29/libstatspush_compat.a prebuiltlibs/system/core/android_x86_64_static_cfi_apex29/ || true
        [ -e out/soong/.intermediates/system/core/libsysutils/libsysutils/android_vendor.31_x86_64_shared/libsysutils.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libsysutils/libsysutils/android_vendor.31_x86_64_shared/libsysutils.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libsysutils/libsysutils/android_vendor.31_x86_x86_64_shared/libsysutils.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libsysutils/libsysutils/android_vendor.31_x86_x86_64_shared/libsysutils.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_shared/libsysutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_shared/libsysutils.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_static_apex30/libsysutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_apex30/ && cp out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_static_apex30/libsysutils.a prebuiltlibs/system/core/android_x86_64_static_apex30/ || true
        [ -e out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_static_cfi/libsysutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_cfi/ && cp out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_static_cfi/libsysutils.a prebuiltlibs/system/core/android_x86_64_static_cfi/ || true
        [ -e out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_static_cfi_apex29/libsysutils.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static_cfi_apex29/ && cp out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_64_static_cfi_apex29/libsysutils.a prebuiltlibs/system/core/android_x86_64_static_cfi_apex29/ || true
        [ -e out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_x86_64_shared/libsysutils.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libsysutils/libsysutils/android_x86_x86_64_shared/libsysutils.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutilscallstack/android_vendor.31_x86_64_shared/libutilscallstack.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/system/core/libutils/libutilscallstack/android_vendor.31_x86_64_shared/libutilscallstack.so prebuiltlibs/system/core/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutilscallstack/android_vendor.31_x86_x86_64_shared/libutilscallstack.so ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libutils/libutilscallstack/android_vendor.31_x86_x86_64_shared/libutilscallstack.so prebuiltlibs/system/core/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutilscallstack/android_x86_64_shared/libutilscallstack.so ] && mkdir -p prebuiltlibs/system/core/android_x86_64_shared/ && cp out/soong/.intermediates/system/core/libutils/libutilscallstack/android_x86_64_shared/libutilscallstack.so prebuiltlibs/system/core/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/libutils/libutilscallstack/android_x86_x86_64_shared/libutilscallstack.so ] && mkdir -p prebuiltlibs/system/core/android_x86_x86_64_shared/ && cp out/soong/.intermediates/system/core/libutils/libutilscallstack/android_x86_x86_64_shared/libutilscallstack.so prebuiltlibs/system/core/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/system/core/llkd/llkd/android_x86_64/llkd ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/llkd/llkd/android_x86_64/llkd prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/mini_keyctl/mini-keyctl/android_x86_64/mini-keyctl ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/mini_keyctl/mini-keyctl/android_x86_64/mini-keyctl prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/mini_keyctl/libmini_keyctl_static/android_x86_64_static/libmini_keyctl_static.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/mini_keyctl/libmini_keyctl_static/android_x86_64_static/libmini_keyctl_static.a prebuiltlibs/system/core/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/system/core/sdcard/sdcard/android_x86_64/sdcard ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/sdcard/sdcard/android_x86_64/sdcard prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/toolbox/toolbox/android_recovery_x86_64/toolbox ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64/ && cp out/soong/.intermediates/system/core/toolbox/toolbox/android_recovery_x86_64/toolbox prebuiltlibs/system/core/android_recovery_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/toolbox/toolbox/android_x86_64/toolbox ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/toolbox/toolbox/android_x86_64/toolbox prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/toolbox/toolbox_vendor/android_vendor.31_x86_64/toolbox ] && mkdir -p prebuiltlibs/system/core/android_vendor.31_x86_64/ && cp out/soong/.intermediates/system/core/toolbox/toolbox_vendor/android_vendor.31_x86_64/toolbox prebuiltlibs/system/core/android_vendor.31_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/watchdogd/watchdogd/android_recovery_x86_64/watchdogd ] && mkdir -p prebuiltlibs/system/core/android_recovery_x86_64/ && cp out/soong/.intermediates/system/core/watchdogd/watchdogd/android_recovery_x86_64/watchdogd prebuiltlibs/system/core/android_recovery_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/watchdogd/watchdogd/android_x86_64/watchdogd ] && mkdir -p prebuiltlibs/system/core/android_x86_64/ && cp out/soong/.intermediates/system/core/watchdogd/watchdogd/android_x86_64/watchdogd prebuiltlibs/system/core/android_x86_64/ || true
        [ -e out/soong/.intermediates/system/core/fs_mgr/libfs_avb/libfs_avb/android_x86_64_static/libfs_avb.a ] && mkdir -p prebuiltlibs/system/core/android_x86_64_static/ && cp out/soong/.intermediates/system/core/fs_mgr/libfs_avb/libfs_avb/android_x86_64_static/libfs_avb.a prebuiltlibs/system/core/android_x86_64_static/ || true
        mkdir -p prebuiltlibs/system/core/property_service/libpropertyinfoparser/include && cp -r system/core/property_service/libpropertyinfoparser/include/* prebuiltlibs/system/core/property_service/libpropertyinfoparser/include
        mkdir -p prebuiltlibs/system/core/libkeyutils/include/ && cp -r system/core/libkeyutils/include//* prebuiltlibs/system/core/libkeyutils/include/
        mkdir -p prebuiltlibs/system/core/fs_mgr/include_fstab && cp -r system/core/fs_mgr/include_fstab/* prebuiltlibs/system/core/fs_mgr/include_fstab
        mkdir -p prebuiltlibs/system/core/libasyncio/include && cp -r system/core/libasyncio/include/* prebuiltlibs/system/core/libasyncio/include
        mkdir -p prebuiltlibs/system/core/libgrallocusage/include && cp -r system/core/libgrallocusage/include/* prebuiltlibs/system/core/libgrallocusage/include
        mkdir -p prebuiltlibs/system/core/libsync/include && cp -r system/core/libsync/include/* prebuiltlibs/system/core/libsync/include
        mkdir -p prebuiltlibs/system/core/fs_mgr/libdm/include && cp -r system/core/fs_mgr/libdm/include/* prebuiltlibs/system/core/fs_mgr/libdm/include
        mkdir -p prebuiltlibs/system/core/libcrypto_utils/include && cp -r system/core/libcrypto_utils/include/* prebuiltlibs/system/core/libcrypto_utils/include
        mkdir -p prebuiltlibs/system/core/libdiskconfig/include && cp -r system/core/libdiskconfig/include/* prebuiltlibs/system/core/libdiskconfig/include
        mkdir -p prebuiltlibs/system/core/libnetutils/include && cp -r system/core/libnetutils/include/* prebuiltlibs/system/core/libnetutils/include
        mkdir -p prebuiltlibs/system/core/libpackagelistparser/include && cp -r system/core/libpackagelistparser/include/* prebuiltlibs/system/core/libpackagelistparser/include
        mkdir -p prebuiltlibs/system/core/libusbhost/include && cp -r system/core/libusbhost/include/* prebuiltlibs/system/core/libusbhost/include
        mkdir -p prebuiltlibs/system/core/libvndksupport/include && cp -r system/core/libvndksupport/include/* prebuiltlibs/system/core/libvndksupport/include
        mkdir -p prebuiltlibs/system/core/debuggerd/include && cp -r system/core/debuggerd/include/* prebuiltlibs/system/core/debuggerd/include
        mkdir -p prebuiltlibs/system/core/debuggerd/tombstoned/include && cp -r system/core/debuggerd/tombstoned/include/* prebuiltlibs/system/core/debuggerd/tombstoned/include
        mkdir -p prebuiltlibs/system/core/diagnose_usb/include && cp -r system/core/diagnose_usb/include/* prebuiltlibs/system/core/diagnose_usb/include
        mkdir -p prebuiltlibs/system/core/healthd/include && cp -r system/core/healthd/include/* prebuiltlibs/system/core/healthd/include
        mkdir -p prebuiltlibs/system/core/libappfuse/include && cp -r system/core/libappfuse/include/* prebuiltlibs/system/core/libappfuse/include
        mkdir -p prebuiltlibs/system/core/libcutils/include && cp -r system/core/libcutils/include/* prebuiltlibs/system/core/libcutils/include
        mkdir -p prebuiltlibs/system/core/libprocessgroup/include && cp -r system/core/libprocessgroup/include/* prebuiltlibs/system/core/libprocessgroup/include
        mkdir -p prebuiltlibs/system/core/libprocessgroup/cgrouprc/include && cp -r system/core/libprocessgroup/cgrouprc/include/* prebuiltlibs/system/core/libprocessgroup/cgrouprc/include
        mkdir -p prebuiltlibs/system/core/libsparse/include && cp -r system/core/libsparse/include/* prebuiltlibs/system/core/libsparse/include
        mkdir -p prebuiltlibs/system/core/libstats/push_compat/include && cp -r system/core/libstats/push_compat/include/* prebuiltlibs/system/core/libstats/push_compat/include
        mkdir -p prebuiltlibs/system/core/libsysutils/include && cp -r system/core/libsysutils/include/* prebuiltlibs/system/core/libsysutils/include
        mkdir -p prebuiltlibs/system/core/mini_keyctl/. && cp -r system/core/mini_keyctl/./* prebuiltlibs/system/core/mini_keyctl/.
        mkdir -p prebuiltlibs/system/core/fs_mgr/libfs_avb/include && cp -r system/core/fs_mgr/libfs_avb/include/* prebuiltlibs/system/core/fs_mgr/libfs_avb/include
        cp -r out/soong/ninja/system/core prebuiltlibs/system/core/system_core-0
        grep '|system/core' out/soong/module-info.txt >> prebuiltlibs/system/core/MODULES
        du -ad1 system/core | sort -rnk1 > prebuiltlibs/system/core/.SIZE
        popd
    - name: write Android.bp system_core-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_static {\n\tname: \"libpropertyinfoparser\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libpropertyinfoparser.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libpropertyinfoparser.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libpropertyinfoparser.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libpropertyinfoparser.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libpropertyinfoparser.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libpropertyinfoparser.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [],\n\tsystem_shared_libs: [\"\",], stl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"property_service/libpropertyinfoparser/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libkeyutils\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libkeyutils.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libkeyutils.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libkeyutils.a\",\n\tsrcs: [\"android_x86_64_shared/libkeyutils.so\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tstl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libkeyutils/include/\"],\n}\ncc_prebuilt_binary {\n\tname: \"reboot\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64: \"android_recovery_x86_64/reboot\",\n\tandroid_x86_64: \"android_x86_64/reboot\",\n\tsrcs: [\"android_recovery_x86_64/reboot\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libcutils\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_static {\n\tname: \"libfstab\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libfstab.a\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libfstab.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libfstab.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libfstab.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"fs_mgr/include_fstab\"],\n}\ncc_prebuilt_library {\n\tname: \"libasyncio\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libasyncio.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libasyncio.a\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libasyncio.so\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libasyncio.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libasyncio.so\",\n\tsrcs: [\"android_x86_64_shared/libasyncio.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tapex_available: [\"//apex_available:platform\",\"com.android.adbd\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libasyncio/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libgrallocusage\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libgrallocusage.a\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libgrallocusage.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libgrallocusage.a\",\n\tandroid_x86_64_static_apex29: \"android_x86_64_static_apex29/libgrallocusage.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libgrallocusage.a\",\n\tsrcs: [\"android_x86_64_static/libgrallocusage.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"android.hardware.graphics.allocator@2.0\",\"libc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"29\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libgrallocusage/include\"],\n}\ncc_prebuilt_library_static {\n\tname: \"libstatspull_lazy\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_static_lto_thin: \"android_x86_64_static_lto-thin/libstatspull_lazy.a\",\n\tandroid_x86_x86_64_static_lto_thin: \"android_x86_x86_64_static_lto-thin/libstatspull_lazy.a\",\n\tsrcs: [\"android_x86_64_static_lto-thin/libstatspull_lazy.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tapex_available: [\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_static {\n\tname: \"libstatssocket_lazy\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_static: \"android_x86_64_static/libstatssocket_lazy.a\",\n\tandroid_x86_64_static_lto_thin: \"android_x86_64_static_lto-thin/libstatssocket_lazy.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libstatssocket_lazy.a\",\n\tandroid_x86_x86_64_static_lto_thin: \"android_x86_x86_64_static_lto-thin/libstatssocket_lazy.a\",\n\tsrcs: [\"android_x86_64_static/libstatssocket_lazy.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tapex_available: [\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libsync\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libsync.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libsync.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libsync.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libsync.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libsync.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libsync.so\",\n\tsrcs: [\"android_x86_64_shared/libsync.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\",\"libc++\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libsync/include\"],\n}\ncc_prebuilt_library_static {\n\tname: \"libdm\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_static: \"android_x86_64_static/libdm.a\",\n\tsrcs: [\"android_x86_64_static/libdm.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"fs_mgr/libdm/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libcrypto_utils\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libcrypto_utils.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libcrypto_utils.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libcrypto_utils.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libcrypto_utils.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libcrypto_utils.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libcrypto_utils.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libcrypto_utils.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libcrypto_utils.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libcrypto_utils.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/libcrypto_utils.so\",\n\tsrcs: [\"android_x86_64_shared/libcrypto_utils.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libcrypto\",\"libdl\",\"libm\"],\n\tvndk: { enabled: true, }, apex_available: [\"//apex_available:platform\",\"com.android.adbd\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libcrypto_utils/include\"],\n}\nrust_prebuilt_rlib {\n\tname: \"libcutils_bindgen\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_rlib_rlib_std: \"android_x86_64_rlib_rlib-std/libcutils_bindgen.rlib\",\n\tsrcs: [\"android_x86_64_rlib_rlib-std/libcutils_bindgen.rlib\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"liblog\",\"libm\"],\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libdiskconfig\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libdiskconfig.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libdiskconfig.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libdiskconfig.so\",\n\tsrcs: [\"android_x86_64_shared/libdiskconfig.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libcutils\",\"libdl\",\"liblog\",\"libm\"],\n\tvndk: { enabled: true, }, \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libdiskconfig/include\"],\n}\ncc_prebuilt_library_shared {\n\tname: \"libnetutils\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libnetutils.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libnetutils.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libnetutils.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libnetutils.so\",\n\tsrcs: [\"android_x86_64_shared/libnetutils.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libcutils\",\"libdl\",\"liblog\",\"libm\"],\n\tvndk: { enabled: true, }, apex_available: [\"//apex_available:platform\",\"com.android.tethering\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libnetutils/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libpackagelistparser\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libpackagelistparser.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libpackagelistparser.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libpackagelistparser.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libpackagelistparser.so\",\n\tsrcs: [\"android_x86_64_shared/libpackagelistparser.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libpackagelistparser/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libqtaguid\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_shared: \"android_x86_64_shared/libqtaguid.so\",\n\tsrcs: [\"android_x86_64_shared/libqtaguid.so\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libusbhost\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libusbhost.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libusbhost.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libusbhost.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libusbhost.so\",\n\tsrcs: [\"android_x86_64_shared/libusbhost.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\"],\n\tvndk: { enabled: true, }, \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libusbhost/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libutils\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libutils.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libutils.so\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libutils.a\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libutils.so\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libutils.a\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libutils.so\",\n\tandroid_x86_64_shared_apex29: \"android_x86_64_shared_apex29/libutils.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libutils.a\",\n\tandroid_x86_64_static_apex29: \"android_x86_64_static_apex29/libutils.a\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libutils.a\",\n\tandroid_x86_64_static_cfi_apex29: \"android_x86_64_static_cfi_apex29/libutils.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libutils.so\",\n\tandroid_x86_x86_64_shared_apex29: \"android_x86_x86_64_shared_apex29/libutils.so\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libutils.a\",\n\tandroid_x86_x86_64_static_apex30: \"android_x86_x86_64_static_apex30/libutils.a\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libutils.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libutils.a\",\n\tsrcs: [\"android_x86_64_shared/libutils.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libcutils\",\"libdl\",\"liblog\",\"libm\",\"libprocessgroup\",\"libvndksupport\"],\n\tmin_sdk_version: \"apex_inherit\", vndk: { enabled: true, }, apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libvndksupport\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libvndksupport.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libvndksupport.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libvndksupport.so\",\n\tandroid_x86_64_shared_29: \"android_x86_64_shared_29/libvndksupport.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libvndksupport.so\",\n\tsrcs: [\"android_x86_64_shared/libvndksupport.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libdl_android\",\"liblog\",\"libm\"],\n\tstubs: { versions: [\"29\",\"current\",], }, \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libvndksupport/include\"],\n}\ncc_prebuilt_library_static {\n\tname: \"libdebuggerd_handler_fallback\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libdebuggerd_handler_fallback.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libdebuggerd_handler_fallback.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libdebuggerd_handler_fallback.a\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libdebuggerd_handler_fallback.a\",\n\tandroid_x86_x86_64_static_apex10000: \"android_x86_x86_64_static_apex10000/libdebuggerd_handler_fallback.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libdebuggerd_handler_fallback.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tapex_available: [\"//apex_available:platform\",\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"debuggerd/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libdebuggerd_client\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_shared: \"android_x86_64_shared/libdebuggerd_client.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libdebuggerd_client.so\",\n\tsrcs: [\"android_x86_64_shared/libdebuggerd_client.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libcutils\",\"libdl\",\"libm\",\"libprocinfo\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"debuggerd/include\"],\n}\ncc_prebuilt_binary {\n\tname: \"crash_dump\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_apex10000: \"android_x86_64_apex10000/crash_dump\",\n\tandroid_x86_x86_64_apex10000: \"android_x86_x86_64_apex10000/crash_dump\",\n\tsrcs: [\"android_x86_64_apex10000/crash_dump\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\tmultilib: { lib64: { suffix: \"64\", }, lib32: { suffix: \"32\", }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\",\"libprocinfo\",\"libunwindstack\"],\n\tapex_available: [\"com.android.runtime\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"debuggerd\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/debuggerd\",\n\tsrcs: [\"android_x86_64/debuggerd\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdebuggerd_client\",\"libdl\",\"liblog\",\"libm\",\"libprocinfo\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"tombstoned\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/tombstoned\",\n\tsrcs: [\"android_x86_64/tombstoned\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_shared {\n\tname: \"libtombstoned_client\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_shared: \"android_x86_64_shared/libtombstoned_client.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libtombstoned_client.so\",\n\tsrcs: [\"android_x86_64_shared/libtombstoned_client.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libcutils\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"debuggerd/tombstoned/include\"],\n}\ncc_prebuilt_library_static {\n\tname: \"libdiagnose_usb\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libdiagnose_usb.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libdiagnose_usb.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libdiagnose_usb.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libdiagnose_usb.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tapex_available: [\"//apex_available:platform\",\"com.android.adbd\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"diagnose_usb/include\"],\n}\ncc_prebuilt_binary {\n\tname: \"clean_scratch_files\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/clean_scratch_files\",\n\tsrcs: [\"android_x86_64/clean_scratch_files\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"libfs_mgr_binder\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"snapuserd\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/snapuserd\",\n\tsrcs: [\"android_x86_64/snapuserd\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tsystem_shared_libs: [\"\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"dmctl\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/dmctl\",\n\tsrcs: [\"android_x86_64/dmctl\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"dmuserd\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/dmuserd\",\n\tsrcs: [\"android_x86_64/dmuserd\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_static {\n\tname: \"libbatterymonitor\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libbatterymonitor.a\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libbatterymonitor.a\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libbatterymonitor.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libbatterymonitor.a\",\n\tsrcs: [\"android_recovery_x86_64_static/libbatterymonitor.a\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"android.hardware.health@2.1\",\"libbase\",\"libc\",\"libdl\",\"libm\",\"libutils\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"healthd/include\"],\n}\ncc_prebuilt_library_shared {\n\tname: \"libappfuse\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_shared: \"android_x86_64_shared/libappfuse.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libappfuse.so\",\n\tsrcs: [\"android_x86_64_shared/libappfuse.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libappfuse/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libcutils\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libcutils.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libcutils.a\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libcutils.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libcutils.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libcutils.so\",\n\tandroid_x86_64_shared_apex10000: \"android_x86_64_shared_apex10000/libcutils.so\",\n\tandroid_x86_64_shared_apex29: \"android_x86_64_shared_apex29/libcutils.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libcutils.a\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libcutils.a\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libcutils.a\",\n\tandroid_x86_64_static_cfi: \"android_x86_64_static_cfi/libcutils.a\",\n\tandroid_x86_64_static_cfi_apex29: \"android_x86_64_static_cfi_apex29/libcutils.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libcutils.so\",\n\tandroid_x86_x86_64_shared_apex10000: \"android_x86_x86_64_shared_apex10000/libcutils.so\",\n\tandroid_x86_x86_64_static: \"android_x86_x86_64_static/libcutils.a\",\n\tandroid_x86_x86_64_static_apex30: \"android_x86_x86_64_static_apex30/libcutils.a\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libcutils.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libcutils.a\",\n\tsrcs: [\"android_x86_64_shared/libcutils.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\"],\n\tmin_sdk_version: \"29\", vndk: { enabled: true, }, apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libcutils_sockets\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libcutils_sockets.so\",\n\tandroid_recovery_x86_64_static: \"android_recovery_x86_64_static/libcutils_sockets.a\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libcutils_sockets.so\",\n\tandroid_x86_64_static_apex10000: \"android_x86_64_static_apex10000/libcutils_sockets.a\",\n\tsrcs: [\"android_x86_64_shared/libcutils_sockets.so\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"liblog\",\"libm\"],\n\tmin_sdk_version: \"29\", apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libcutils/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libprocessgroup\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libprocessgroup.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libprocessgroup.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libprocessgroup.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libprocessgroup.so\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libprocessgroup.a\",\n\tandroid_x86_64_static_cfi_apex29: \"android_x86_64_static_cfi_apex29/libprocessgroup.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libprocessgroup.so\",\n\tandroid_x86_x86_64_static_apex30: \"android_x86_x86_64_static_apex30/libprocessgroup.a\",\n\tsrcs: [\"android_x86_64_shared/libprocessgroup.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libcgrouprc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"29\", vndk: { enabled: true, }, apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libprocessgroup/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libcgrouprc\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_shared: \"android_x86_64_shared/libcgrouprc.so\",\n\tandroid_x86_64_shared_29: \"android_x86_64_shared_29/libcgrouprc.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libcgrouprc.so\",\n\tsrcs: [\"android_x86_64_shared/libcgrouprc.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tstubs: { versions: [\"29\",\"current\",], }, \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libprocessgroup/cgrouprc/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libsparse\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libsparse.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libsparse.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libsparse.a\",\n\tsrcs: [\"android_x86_64_shared/libsparse.so\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"libm\",\"libz\"],\n\tapex_available: [\"//apex_available:platform\",\"com.android.virt\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libsparse/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libstatspush_compat\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_static_cfi: \"android_x86_64_static_cfi/libstatspush_compat.a\",\n\tandroid_x86_64_static_cfi_apex29: \"android_x86_64_static_cfi_apex29/libstatspush_compat.a\",\n\tsrcs: [\"android_x86_64_static_cfi/libstatspush_compat.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"liblog\",\"libm\"],\n\tmin_sdk_version: \"29\", apex_available: [\"com.android.resolv\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libstats/push_compat/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libsysutils\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libsysutils.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libsysutils.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libsysutils.so\",\n\tandroid_x86_64_static_apex30: \"android_x86_64_static_apex30/libsysutils.a\",\n\tandroid_x86_64_static_cfi: \"android_x86_64_static_cfi/libsysutils.a\",\n\tandroid_x86_64_static_cfi_apex29: \"android_x86_64_static_cfi_apex29/libsysutils.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libsysutils.so\",\n\tsrcs: [\"android_x86_64_shared/libsysutils.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libcutils\",\"libdl\",\"liblog\",\"libm\"],\n\tmin_sdk_version: \"apex_inherit\", vndk: { enabled: true, }, apex_available: [\"//apex_available:anyapex\",\"//apex_available:platform\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libsysutils/include\"],\n}\ncc_prebuilt_library {\n\tname: \"libutilscallstack\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libutilscallstack.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libutilscallstack.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libutilscallstack.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libutilscallstack.so\",\n\tsrcs: [\"android_x86_64_shared/libutilscallstack.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libbacktrace\",\"libc\",\"libc++\",\"libcutils\",\"libdl\",\"liblog\",\"libm\",\"libprocessgroup\",\"libutils\",\"libvndksupport\"],\n\tvndk: { enabled: true, }, \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"llkd\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/llkd\",\n\tsrcs: [\"android_x86_64/llkd\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libcutils\",\"libdl\",\"liblog\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"mini-keyctl\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/mini-keyctl\",\n\tsrcs: [\"android_x86_64/mini-keyctl\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"libkeyutils\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_static {\n\tname: \"libmini_keyctl_static\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_static: \"android_x86_64_static/libmini_keyctl_static.a\",\n\tsrcs: [\"android_x86_64_static/libmini_keyctl_static.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libdl\",\"libkeyutils\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"mini_keyctl/.\"],\n}\ncc_prebuilt_binary {\n\tname: \"sdcard\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/sdcard\",\n\tsrcs: [\"android_x86_64/sdcard\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libcutils\",\"libdl\",\"libm\",\"libminijail\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"toolbox\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64: \"android_recovery_x86_64/toolbox\",\n\tandroid_x86_64: \"android_x86_64/toolbox\",\n\tsrcs: [\"android_recovery_x86_64/toolbox\"],\n\ttarget: { android: { compile_multilib: \"64\", symlinks: [\"getevent\",\"getprop\",\"modprobe\",\"setprop\",\"start\",\"stop\",], }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"toolbox_vendor\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tandroid_vendor_31_x86_64: \"android_vendor.31_x86_64/toolbox_vendor\",\n\tsrcs: [\"android_vendor.31_x86_64/toolbox_vendor\"],\n\ttarget: { android: { compile_multilib: \"64\", symlinks: [\"getevent\",\"getprop\",\"modprobe\",\"setprop\",\"start\",\"stop\",], }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tstem: \"toolbox\", soc_specific: true, \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"watchdogd\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\trecovery_available: true,\n\tandroid_recovery_x86_64: \"android_recovery_x86_64/watchdogd\",\n\tandroid_x86_64: \"android_x86_64/watchdogd\",\n\tsrcs: [\"android_recovery_x86_64/watchdogd\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library_static {\n\tname: \"libfs_avb\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_static: \"android_x86_64_static/libfs_avb.a\",\n\tsrcs: [\"android_x86_64_static/libfs_avb.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libbase\",\"libc\",\"libcrypto\",\"libdl\",\"libm\"],\n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"fs_mgr/libfs_avb/include\"],\n}" >> prebuiltlibs/system/core/Android.bp
        printf "\n" >> prebuiltlibs/system/core/Android.bp
        popd
    - name: Archive system_core-0
      uses: actions/upload-artifact@v3
      with:
        name: system_core-0
        path: aosp/prebuiltlibs/system/core
  external_pcre-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Restore Cache external/pcre
      id: external_pcre
      uses: actions/cache@v3
      with:
        path: "aosp/external/pcre"
        key: "external_pcre@$BRANCH"
        restore-keys: "external_pcre@$BRANCH"
    - name: Clone project external/pcre
      if: steps.external_pcre.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/pcre
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_pcre-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/pcre/libpcre2/android_recovery_x86_64_shared/libpcre2.so out/soong/.intermediates/external/pcre/libpcre2/android_vendor.31_x86_64_shared/libpcre2.so out/soong/.intermediates/external/pcre/libpcre2/android_vendor.31_x86_x86_64_shared/libpcre2.so out/soong/.intermediates/external/pcre/libpcre2/android_x86_64_shared/libpcre2.so out/soong/.intermediates/external/pcre/libpcre2/android_x86_64_static/libpcre2.a out/soong/.intermediates/external/pcre/libpcre2/android_x86_x86_64_shared/libpcre2.so out/soong/.intermediates/external/pcre/libpcre2/linux_glibc_x86_64_shared/libpcre2.so out/soong/.intermediates/external/pcre/libpcre2/linux_glibc_x86_64_static/libpcre2.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_pcre-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/pcre/libpcre2/android_recovery_x86_64_shared/libpcre2.so ] && mkdir -p prebuiltlibs/external/pcre/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/pcre/libpcre2/android_recovery_x86_64_shared/libpcre2.so prebuiltlibs/external/pcre/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/pcre/libpcre2/android_vendor.31_x86_64_shared/libpcre2.so ] && mkdir -p prebuiltlibs/external/pcre/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/pcre/libpcre2/android_vendor.31_x86_64_shared/libpcre2.so prebuiltlibs/external/pcre/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/pcre/libpcre2/android_vendor.31_x86_x86_64_shared/libpcre2.so ] && mkdir -p prebuiltlibs/external/pcre/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/pcre/libpcre2/android_vendor.31_x86_x86_64_shared/libpcre2.so prebuiltlibs/external/pcre/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/pcre/libpcre2/android_x86_64_shared/libpcre2.so ] && mkdir -p prebuiltlibs/external/pcre/android_x86_64_shared/ && cp out/soong/.intermediates/external/pcre/libpcre2/android_x86_64_shared/libpcre2.so prebuiltlibs/external/pcre/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/pcre/libpcre2/android_x86_64_static/libpcre2.a ] && mkdir -p prebuiltlibs/external/pcre/android_x86_64_static/ && cp out/soong/.intermediates/external/pcre/libpcre2/android_x86_64_static/libpcre2.a prebuiltlibs/external/pcre/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/pcre/libpcre2/android_x86_x86_64_shared/libpcre2.so ] && mkdir -p prebuiltlibs/external/pcre/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/pcre/libpcre2/android_x86_x86_64_shared/libpcre2.so prebuiltlibs/external/pcre/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/pcre/libpcre2/linux_glibc_x86_64_shared/libpcre2.so ] && mkdir -p prebuiltlibs/external/pcre/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/external/pcre/libpcre2/linux_glibc_x86_64_shared/libpcre2.so prebuiltlibs/external/pcre/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/pcre/libpcre2/linux_glibc_x86_64_static/libpcre2.a ] && mkdir -p prebuiltlibs/external/pcre/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/pcre/libpcre2/linux_glibc_x86_64_static/libpcre2.a prebuiltlibs/external/pcre/linux_glibc_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/pcre/include && cp -r external/pcre/include/* prebuiltlibs/external/pcre/include
        cp -r out/soong/ninja/external/pcre prebuiltlibs/external/pcre/external_pcre-0
        grep '|external/pcre' out/soong/module-info.txt >> prebuiltlibs/external/pcre/MODULES
        du -ad1 external/pcre | sort -rnk1 > prebuiltlibs/external/pcre/.SIZE
        popd
    - name: write Android.bp external_pcre-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libpcre2\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libpcre2.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libpcre2.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libpcre2.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libpcre2.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libpcre2.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libpcre2.so\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libpcre2.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libpcre2.a\",\n\tsrcs: [\"android_x86_64_shared/libpcre2.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\"],\n\tsystem_shared_libs: [\"libc\",], stl: \"none\", vndk: { enabled: true, }, \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}" >> prebuiltlibs/external/pcre/Android.bp
        printf "\n" >> prebuiltlibs/external/pcre/Android.bp
        popd
    - name: Archive external_pcre-0
      uses: actions/upload-artifact@v3
      with:
        name: external_pcre-0
        path: aosp/prebuiltlibs/external/pcre
  external_selinux-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_pcre-0,prebuilts_rust-0,system_core-0,system_logging-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact system_logging-0
      uses: actions/download-artifact@v3
      with:
        name: system_logging-0
        path: aosp/prebuiltlibs/system/logging/
    - name: Download artifact system_core-0
      uses: actions/download-artifact@v3
      with:
        name: system_core-0
        path: aosp/prebuiltlibs/system/core/
    - name: Restore Cache external/pcre
      id: external_pcre
      uses: actions/cache@v3
      with:
        path: "aosp/external/pcre"
        key: "external_pcre@$BRANCH"
        restore-keys: "external_pcre@$BRANCH"
    - name: Clone project external/pcre
      if: steps.external_pcre.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/pcre
    - name: Download artifact external_pcre-0
      uses: actions/download-artifact@v3
      with:
        name: external_pcre-0
        path: aosp/prebuiltlibs/external/pcre/
    - name: Restore Cache prebuilts/rust
      id: prebuilts_rust
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/rust"
        key: "prebuilts_rust@$BRANCH"
        restore-keys: "prebuilts_rust@$BRANCH"
    - name: Clone project prebuilts/rust
      if: steps.prebuilts_rust.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform prebuilts/rust
    - name: Download artifact prebuilts_rust-0
      uses: actions/download-artifact@v3
      with:
        name: prebuilts_rust-0
        path: aosp/prebuiltlibs/prebuilts/rust/
    - name: Restore Cache external/selinux
      id: external_selinux
      uses: actions/cache@v3
      with:
        path: "aosp/external/selinux"
        key: "external_selinux@$BRANCH"
        restore-keys: "external_selinux@$BRANCH"
    - name: Clone project external/selinux
      if: steps.external_selinux.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/selinux
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_selinux-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/selinux/libsepol/libsepol/linux_glibc_x86_64_static/libsepol.a out/soong/.intermediates/external/selinux/checkpolicy/checkpolicy/linux_glibc_x86_64/checkpolicy out/soong/.intermediates/external/selinux/secilc/secilc/android_x86_64/secilc out/soong/.intermediates/external/selinux/secilc/secilc/linux_glibc_x86_64/secilc out/soong/.intermediates/external/selinux/libselinux/libselinux/android_recovery_x86_64_shared/libselinux.so out/soong/.intermediates/external/selinux/libselinux/libselinux/android_vendor.31_x86_64_shared/libselinux.so out/soong/.intermediates/external/selinux/libselinux/libselinux/android_x86_64_shared/libselinux.so out/soong/.intermediates/external/selinux/libselinux/libselinux/android_x86_64_static/libselinux.a out/soong/.intermediates/external/selinux/libselinux/libselinux/android_x86_x86_64_shared/libselinux.so out/soong/.intermediates/external/selinux/libselinux/libselinux/linux_glibc_x86_64_shared/libselinux.so out/soong/.intermediates/external/selinux/libselinux/libselinux/linux_glibc_x86_64_static/libselinux.a out/soong/.intermediates/external/selinux/libselinux/libselinux_bindgen/android_x86_64_rlib_rlib-std/libselinux_bindgen.rlib)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_selinux-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/selinux/libsepol/libsepol/linux_glibc_x86_64_static/libsepol.a ] && mkdir -p prebuiltlibs/external/selinux/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/selinux/libsepol/libsepol/linux_glibc_x86_64_static/libsepol.a prebuiltlibs/external/selinux/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/selinux/checkpolicy/checkpolicy/linux_glibc_x86_64/checkpolicy ] && mkdir -p prebuiltlibs/external/selinux/linux_glibc_x86_64/ && cp out/soong/.intermediates/external/selinux/checkpolicy/checkpolicy/linux_glibc_x86_64/checkpolicy prebuiltlibs/external/selinux/linux_glibc_x86_64/ || true
        [ -e out/soong/.intermediates/external/selinux/secilc/secilc/android_x86_64/secilc ] && mkdir -p prebuiltlibs/external/selinux/android_x86_64/ && cp out/soong/.intermediates/external/selinux/secilc/secilc/android_x86_64/secilc prebuiltlibs/external/selinux/android_x86_64/ || true
        [ -e out/soong/.intermediates/external/selinux/secilc/secilc/linux_glibc_x86_64/secilc ] && mkdir -p prebuiltlibs/external/selinux/linux_glibc_x86_64/ && cp out/soong/.intermediates/external/selinux/secilc/secilc/linux_glibc_x86_64/secilc prebuiltlibs/external/selinux/linux_glibc_x86_64/ || true
        [ -e out/soong/.intermediates/external/selinux/libselinux/libselinux/android_recovery_x86_64_shared/libselinux.so ] && mkdir -p prebuiltlibs/external/selinux/android_recovery_x86_64_shared/ && cp out/soong/.intermediates/external/selinux/libselinux/libselinux/android_recovery_x86_64_shared/libselinux.so prebuiltlibs/external/selinux/android_recovery_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/selinux/libselinux/libselinux/android_vendor.31_x86_64_shared/libselinux.so ] && mkdir -p prebuiltlibs/external/selinux/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/selinux/libselinux/libselinux/android_vendor.31_x86_64_shared/libselinux.so prebuiltlibs/external/selinux/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/selinux/libselinux/libselinux/android_x86_64_shared/libselinux.so ] && mkdir -p prebuiltlibs/external/selinux/android_x86_64_shared/ && cp out/soong/.intermediates/external/selinux/libselinux/libselinux/android_x86_64_shared/libselinux.so prebuiltlibs/external/selinux/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/selinux/libselinux/libselinux/android_x86_64_static/libselinux.a ] && mkdir -p prebuiltlibs/external/selinux/android_x86_64_static/ && cp out/soong/.intermediates/external/selinux/libselinux/libselinux/android_x86_64_static/libselinux.a prebuiltlibs/external/selinux/android_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/selinux/libselinux/libselinux/android_x86_x86_64_shared/libselinux.so ] && mkdir -p prebuiltlibs/external/selinux/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/selinux/libselinux/libselinux/android_x86_x86_64_shared/libselinux.so prebuiltlibs/external/selinux/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/selinux/libselinux/libselinux/linux_glibc_x86_64_shared/libselinux.so ] && mkdir -p prebuiltlibs/external/selinux/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/external/selinux/libselinux/libselinux/linux_glibc_x86_64_shared/libselinux.so prebuiltlibs/external/selinux/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/selinux/libselinux/libselinux/linux_glibc_x86_64_static/libselinux.a ] && mkdir -p prebuiltlibs/external/selinux/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/selinux/libselinux/libselinux/linux_glibc_x86_64_static/libselinux.a prebuiltlibs/external/selinux/linux_glibc_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/selinux/libselinux/libselinux_bindgen/android_x86_64_rlib_rlib-std/libselinux_bindgen.rlib ] && mkdir -p prebuiltlibs/external/selinux/android_x86_64_rlib_rlib-std/ && cp out/soong/.intermediates/external/selinux/libselinux/libselinux_bindgen/android_x86_64_rlib_rlib-std/libselinux_bindgen.rlib prebuiltlibs/external/selinux/android_x86_64_rlib_rlib-std/ || true
        mkdir -p prebuiltlibs/external/selinux/libsepol/cil/include && cp -r external/selinux/libsepol/cil/include/* prebuiltlibs/external/selinux/libsepol/cil/include
        mkdir -p prebuiltlibs/external/selinux/libsepol/include && cp -r external/selinux/libsepol/include/* prebuiltlibs/external/selinux/libsepol/include
        mkdir -p prebuiltlibs/external/selinux/libselinux/include && cp -r external/selinux/libselinux/include/* prebuiltlibs/external/selinux/libselinux/include
        cp -r out/soong/ninja/external/selinux prebuiltlibs/external/selinux/external_selinux-0
        grep '|external/selinux' out/soong/module-info.txt >> prebuiltlibs/external/selinux/MODULES
        du -ad1 external/selinux | sort -rnk1 > prebuiltlibs/external/selinux/.SIZE
        popd
    - name: write Android.bp external_selinux-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libsepol\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libsepol.a\",\n\tsrcs: [\"linux_glibc_x86_64_static/libsepol.a\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [],\n\tstl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libsepol/cil/include\",\"libsepol/include\"],\n}\ncc_prebuilt_binary {\n\tname: \"checkpolicy\",\n\tdevice_supported: false,\n\thost_supported: true,\n\tvendor_available: false,\n\tlinux_glibc_x86_64: \"linux_glibc_x86_64/checkpolicy\",\n\tsrcs: [\"linux_glibc_x86_64/checkpolicy\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc++\"],\n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_binary {\n\tname: \"secilc\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/secilc\",\n\tlinux_glibc_x86_64: \"linux_glibc_x86_64/secilc\",\n\tsrcs: [\"android_x86_64/secilc\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tbootstrap: true, stl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n}\ncc_prebuilt_library {\n\tname: \"libselinux\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\trecovery_available: true,\n\tandroid_recovery_x86_64_shared: \"android_recovery_x86_64_shared/libselinux.so\",\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libselinux.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libselinux.so\",\n\tandroid_x86_64_static: \"android_x86_64_static/libselinux.a\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libselinux.so\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libselinux.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libselinux.a\",\n\tsrcs: [\"android_x86_64_shared/libselinux.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"liblog\",\"libpackagelistparser\",\"libpcre2\"],\n\tsystem_shared_libs: [\"libc\",], stubs: { versions: [\"30\",\"current\",], }, stl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"libselinux/include\"],\n}\nrust_prebuilt_rlib {\n\tname: \"libselinux_bindgen\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_rlib_rlib_std: \"android_x86_64_rlib_rlib-std/libselinux_bindgen.rlib\",\n\tsrcs: [\"android_x86_64_rlib_rlib-std/libselinux_bindgen.rlib\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"liblog\",\"libm\"],\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/selinux/Android.bp
        printf "\n" >> prebuiltlibs/external/selinux/Android.bp
        popd
    - name: Archive external_selinux-0
      uses: actions/upload-artifact@v3
      with:
        name: external_selinux-0
        path: aosp/prebuiltlibs/external/selinux
  external_bc-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Restore Cache external/bc
      id: external_bc
      uses: actions/cache@v3
      with:
        path: "aosp/external/bc"
        key: "external_bc@$BRANCH"
        restore-keys: "external_bc@$BRANCH"
    - name: Clone project external/bc
      if: steps.external_bc.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/bc
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_bc-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/bc/bc/android_x86_64/bc)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_bc-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/bc/bc/android_x86_64/bc ] && mkdir -p prebuiltlibs/external/bc/android_x86_64/ && cp out/soong/.intermediates/external/bc/bc/android_x86_64/bc prebuiltlibs/external/bc/android_x86_64/ || true
        cp -r out/soong/ninja/external/bc prebuiltlibs/external/bc/external_bc-0
        grep '|external/bc' out/soong/module-info.txt >> prebuiltlibs/external/bc/MODULES
        du -ad1 external/bc | sort -rnk1 > prebuiltlibs/external/bc/.SIZE
        popd
    - name: write Android.bp external_bc-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_binary {\n\tname: \"bc\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/bc\",\n\tsrcs: [\"android_x86_64/bc\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tstl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/bc/Android.bp
        printf "\n" >> prebuiltlibs/external/bc/Android.bp
        popd
    - name: Archive external_bc-0
      uses: actions/upload-artifact@v3
      with:
        name: external_bc-0
        path: aosp/prebuiltlibs/external/bc
  external_bzip2-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Restore Cache external/bzip2
      id: external_bzip2
      uses: actions/cache@v3
      with:
        path: "aosp/external/bzip2"
        key: "external_bzip2@$BRANCH"
        restore-keys: "external_bzip2@$BRANCH"
    - name: Clone project external/bzip2
      if: steps.external_bzip2.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/bzip2
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_bzip2-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/bzip2/libbz/android_vendor.31_x86_64_static/libbz.a out/soong/.intermediates/external/bzip2/bzip2/android_x86_64/bzip2)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_bzip2-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/bzip2/libbz/android_vendor.31_x86_64_static/libbz.a ] && mkdir -p prebuiltlibs/external/bzip2/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/external/bzip2/libbz/android_vendor.31_x86_64_static/libbz.a prebuiltlibs/external/bzip2/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/bzip2/bzip2/android_x86_64/bzip2 ] && mkdir -p prebuiltlibs/external/bzip2/android_x86_64/ && cp out/soong/.intermediates/external/bzip2/bzip2/android_x86_64/bzip2 prebuiltlibs/external/bzip2/android_x86_64/ || true
        mkdir -p prebuiltlibs/external/bzip2/. && cp -r external/bzip2/./* prebuiltlibs/external/bzip2/.
        cp -r out/soong/ninja/external/bzip2 prebuiltlibs/external/bzip2/external_bzip2-0
        grep '|external/bzip2' out/soong/module-info.txt >> prebuiltlibs/external/bzip2/MODULES
        du -ad1 external/bzip2 | sort -rnk1 > prebuiltlibs/external/bzip2/.SIZE
        popd
    - name: write Android.bp external_bzip2-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_static {\n\tname: \"libbz\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libbz.a\",\n\tsrcs: [\"android_vendor.31_x86_64_static/libbz.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tstl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\".\"],\n}\ncc_prebuilt_binary {\n\tname: \"bzip2\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64: \"android_x86_64/bzip2\",\n\tsrcs: [\"android_x86_64/bzip2\"],\n\ttarget: { android: { compile_multilib: \"64\", symlinks: [\"bunzip2\",\"bzcat\",], }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tstl: \"none\", \n\tprefer: true,\n\tstrip: { none: true, },\n}" >> prebuiltlibs/external/bzip2/Android.bp
        printf "\n" >> prebuiltlibs/external/bzip2/Android.bp
        popd
    - name: Archive external_bzip2-0
      uses: actions/upload-artifact@v3
      with:
        name: external_bzip2-0
        path: aosp/prebuiltlibs/external/bzip2
  external_expat-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Restore Cache external/expat
      id: external_expat
      uses: actions/cache@v3
      with:
        path: "aosp/external/expat"
        key: "external_expat@$BRANCH"
        restore-keys: "external_expat@$BRANCH"
    - name: Clone project external/expat
      if: steps.external_expat.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/expat
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_expat-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_64_shared/libexpat.so out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_64_static/libexpat.a out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_x86_64_shared/libexpat.so out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_x86_64_static/libexpat.a out/soong/.intermediates/external/expat/libexpat/android_x86_64_shared/libexpat.so out/soong/.intermediates/external/expat/libexpat/android_x86_64_shared_apex31/libexpat.so out/soong/.intermediates/external/expat/libexpat/android_x86_x86_64_shared/libexpat.so out/soong/.intermediates/external/expat/libexpat/android_x86_x86_64_shared_apex31/libexpat.so out/soong/.intermediates/external/expat/libexpat/linux_glibc_x86_64_shared/libexpat-host.so out/soong/.intermediates/external/expat/libexpat/linux_glibc_x86_64_static/libexpat.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_expat-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_64_shared/libexpat.so ] && mkdir -p prebuiltlibs/external/expat/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_64_shared/libexpat.so prebuiltlibs/external/expat/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_64_static/libexpat.a ] && mkdir -p prebuiltlibs/external/expat/android_vendor.31_x86_64_static/ && cp out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_64_static/libexpat.a prebuiltlibs/external/expat/android_vendor.31_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_x86_64_shared/libexpat.so ] && mkdir -p prebuiltlibs/external/expat/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_x86_64_shared/libexpat.so prebuiltlibs/external/expat/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_x86_64_static/libexpat.a ] && mkdir -p prebuiltlibs/external/expat/android_vendor.31_x86_x86_64_static/ && cp out/soong/.intermediates/external/expat/libexpat/android_vendor.31_x86_x86_64_static/libexpat.a prebuiltlibs/external/expat/android_vendor.31_x86_x86_64_static/ || true
        [ -e out/soong/.intermediates/external/expat/libexpat/android_x86_64_shared/libexpat.so ] && mkdir -p prebuiltlibs/external/expat/android_x86_64_shared/ && cp out/soong/.intermediates/external/expat/libexpat/android_x86_64_shared/libexpat.so prebuiltlibs/external/expat/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/expat/libexpat/android_x86_64_shared_apex31/libexpat.so ] && mkdir -p prebuiltlibs/external/expat/android_x86_64_shared_apex31/ && cp out/soong/.intermediates/external/expat/libexpat/android_x86_64_shared_apex31/libexpat.so prebuiltlibs/external/expat/android_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/external/expat/libexpat/android_x86_x86_64_shared/libexpat.so ] && mkdir -p prebuiltlibs/external/expat/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/expat/libexpat/android_x86_x86_64_shared/libexpat.so prebuiltlibs/external/expat/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/expat/libexpat/android_x86_x86_64_shared_apex31/libexpat.so ] && mkdir -p prebuiltlibs/external/expat/android_x86_x86_64_shared_apex31/ && cp out/soong/.intermediates/external/expat/libexpat/android_x86_x86_64_shared_apex31/libexpat.so prebuiltlibs/external/expat/android_x86_x86_64_shared_apex31/ || true
        [ -e out/soong/.intermediates/external/expat/libexpat/linux_glibc_x86_64_shared/libexpat-host.so ] && mkdir -p prebuiltlibs/external/expat/linux_glibc_x86_64_shared/ && cp out/soong/.intermediates/external/expat/libexpat/linux_glibc_x86_64_shared/libexpat-host.so prebuiltlibs/external/expat/linux_glibc_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/expat/libexpat/linux_glibc_x86_64_static/libexpat.a ] && mkdir -p prebuiltlibs/external/expat/linux_glibc_x86_64_static/ && cp out/soong/.intermediates/external/expat/libexpat/linux_glibc_x86_64_static/libexpat.a prebuiltlibs/external/expat/linux_glibc_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/expat/lib && cp -r external/expat/lib/* prebuiltlibs/external/expat/lib
        cp -r out/soong/ninja/external/expat prebuiltlibs/external/expat/external_expat-0
        grep '|external/expat' out/soong/module-info.txt >> prebuiltlibs/external/expat/MODULES
        du -ad1 external/expat | sort -rnk1 > prebuiltlibs/external/expat/.SIZE
        popd
    - name: write Android.bp external_expat-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libexpat\",\n\tdevice_supported: true,\n\thost_supported: true,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libexpat.so\",\n\tandroid_vendor_31_x86_64_static: \"android_vendor.31_x86_64_static/libexpat.a\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libexpat.so\",\n\tandroid_vendor_31_x86_x86_64_static: \"android_vendor.31_x86_x86_64_static/libexpat.a\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libexpat.so\",\n\tandroid_x86_64_shared_apex31: \"android_x86_64_shared_apex31/libexpat.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libexpat.so\",\n\tandroid_x86_x86_64_shared_apex31: \"android_x86_x86_64_shared_apex31/libexpat.so\",\n\tlinux_glibc_x86_64_shared: \"linux_glibc_x86_64_shared/libexpat.so\",\n\tlinux_glibc_x86_64_static: \"linux_glibc_x86_64_static/libexpat.a\",\n\tsrcs: [\"android_x86_64_shared/libexpat.so\"],\n\ttarget: { host: { compile_multilib: \"64\",  }, android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"apex_inherit\", stl: \"none\", vndk: { enabled: true, }, apex_available: [\"//apex_available:platform\",\"com.android.art\",\"com.android.art.debug\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"lib\"],\n}" >> prebuiltlibs/external/expat/Android.bp
        printf "\n" >> prebuiltlibs/external/expat/Android.bp
        popd
    - name: Archive external_expat-0
      uses: actions/upload-artifact@v3
      with:
        name: external_expat-0
        path: aosp/prebuiltlibs/external/expat
  external_fft2d-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Restore Cache external/fft2d
      id: external_fft2d
      uses: actions/cache@v3
      with:
        path: "aosp/external/fft2d"
        key: "external_fft2d@$BRANCH"
        restore-keys: "external_fft2d@$BRANCH"
    - name: Clone project external/fft2d
      if: steps.external_fft2d.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/fft2d
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_fft2d-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/fft2d/libfft2d/android_x86_64_sdk_static_apex30/libfft2d.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_fft2d-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/fft2d/libfft2d/android_x86_64_sdk_static_apex30/libfft2d.a ] && mkdir -p prebuiltlibs/external/fft2d/android_x86_64_sdk_static_apex30/ && cp out/soong/.intermediates/external/fft2d/libfft2d/android_x86_64_sdk_static_apex30/libfft2d.a prebuiltlibs/external/fft2d/android_x86_64_sdk_static_apex30/ || true
        mkdir -p prebuiltlibs/external/fft2d/src/fft2d && cp -r external/fft2d/src/fft2d/* prebuiltlibs/external/fft2d/src/fft2d
        cp -r out/soong/ninja/external/fft2d prebuiltlibs/external/fft2d/external_fft2d-0
        grep '|external/fft2d' out/soong/module-info.txt >> prebuiltlibs/external/fft2d/MODULES
        du -ad1 external/fft2d | sort -rnk1 > prebuiltlibs/external/fft2d/.SIZE
        popd
    - name: write Android.bp external_fft2d-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_static {\n\tname: \"libfft2d\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_sdk_static_apex30: \"android_x86_64_sdk_static_apex30/libfft2d.a\",\n\tsrcs: [\"android_x86_64_sdk_static_apex30/libfft2d.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc.ndk\",\"libdl.ndk\",\"libm.ndk\",\"libstdc++.ndk\"],\n\tmin_sdk_version: \"30\", sdk_version: \"current\", apex_available: [\"//apex_available:platform\",\"com.android.extservices\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"src/fft2d\"],\n}" >> prebuiltlibs/external/fft2d/Android.bp
        printf "\n" >> prebuiltlibs/external/fft2d/Android.bp
        popd
    - name: Archive external_fft2d-0
      uses: actions/upload-artifact@v3
      with:
        name: external_fft2d-0
        path: aosp/prebuiltlibs/external/fft2d
  external_libfuse-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Restore Cache external/libfuse
      id: external_libfuse
      uses: actions/cache@v3
      with:
        path: "aosp/external/libfuse"
        key: "external_libfuse@$BRANCH"
        restore-keys: "external_libfuse@$BRANCH"
    - name: Clone project external/libfuse
      if: steps.external_libfuse.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/libfuse
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_libfuse-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/libfuse/libfuse/android_x86_64_sdk_shared/libfuse.so out/soong/.intermediates/external/libfuse/libfuse/android_x86_64_sdk_shared_apex30/libfuse.so)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_libfuse-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/libfuse/libfuse/android_x86_64_sdk_shared/libfuse.so ] && mkdir -p prebuiltlibs/external/libfuse/android_x86_64_sdk_shared/ && cp out/soong/.intermediates/external/libfuse/libfuse/android_x86_64_sdk_shared/libfuse.so prebuiltlibs/external/libfuse/android_x86_64_sdk_shared/ || true
        [ -e out/soong/.intermediates/external/libfuse/libfuse/android_x86_64_sdk_shared_apex30/libfuse.so ] && mkdir -p prebuiltlibs/external/libfuse/android_x86_64_sdk_shared_apex30/ && cp out/soong/.intermediates/external/libfuse/libfuse/android_x86_64_sdk_shared_apex30/libfuse.so prebuiltlibs/external/libfuse/android_x86_64_sdk_shared_apex30/ || true
        mkdir -p prebuiltlibs/external/libfuse/include && cp -r external/libfuse/include/* prebuiltlibs/external/libfuse/include
        mkdir -p prebuiltlibs/external/libfuse/lib && cp -r external/libfuse/lib/* prebuiltlibs/external/libfuse/lib
        cp -r out/soong/ninja/external/libfuse prebuiltlibs/external/libfuse/external_libfuse-0
        grep '|external/libfuse' out/soong/module-info.txt >> prebuiltlibs/external/libfuse/MODULES
        du -ad1 external/libfuse | sort -rnk1 > prebuiltlibs/external/libfuse/.SIZE
        popd
    - name: write Android.bp external_libfuse-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libfuse\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_sdk_shared: \"android_x86_64_sdk_shared/libfuse.so\",\n\tandroid_x86_64_sdk_shared_apex30: \"android_x86_64_sdk_shared_apex30/libfuse.so\",\n\tsrcs: [\"android_x86_64_sdk_shared/libfuse.so\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc.ndk\",\"libdl.ndk\",\"libm.ndk\",\"libstdc++.ndk\"],\n\tmin_sdk_version: \"30\", sdk_version: \"current\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\",\"lib\"],\n}" >> prebuiltlibs/external/libfuse/Android.bp
        printf "\n" >> prebuiltlibs/external/libfuse/Android.bp
        popd
    - name: Archive external_libfuse-0
      uses: actions/upload-artifact@v3
      with:
        name: external_libfuse-0
        path: aosp/prebuiltlibs/external/libfuse
  external_libjpeg-turbo-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/libjpeg-turbo
      id: external_libjpeg-turbo
      uses: actions/cache@v3
      with:
        path: "aosp/external/libjpeg-turbo"
        key: "external_libjpeg-turbo@$BRANCH"
        restore-keys: "external_libjpeg-turbo@$BRANCH"
    - name: Clone project external/libjpeg-turbo
      if: steps.external_libjpeg-turbo.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/libjpeg-turbo
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_libjpeg-turbo-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_vendor.31_x86_64_shared/libjpeg.so out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_vendor.31_x86_x86_64_shared/libjpeg.so out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_x86_64_shared/libjpeg.so out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_x86_x86_64_shared/libjpeg.so out/soong/.intermediates/external/libjpeg-turbo/libjpeg_static_ndk/android_x86_64_sdk_static/libjpeg_static_ndk.a out/soong/.intermediates/external/libjpeg-turbo/libjpeg_static_ndk/android_x86_64_static/libjpeg_static_ndk.a)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_libjpeg-turbo-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_vendor.31_x86_64_shared/libjpeg.so ] && mkdir -p prebuiltlibs/external/libjpeg-turbo/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_vendor.31_x86_64_shared/libjpeg.so prebuiltlibs/external/libjpeg-turbo/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_vendor.31_x86_x86_64_shared/libjpeg.so ] && mkdir -p prebuiltlibs/external/libjpeg-turbo/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_vendor.31_x86_x86_64_shared/libjpeg.so prebuiltlibs/external/libjpeg-turbo/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_x86_64_shared/libjpeg.so ] && mkdir -p prebuiltlibs/external/libjpeg-turbo/android_x86_64_shared/ && cp out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_x86_64_shared/libjpeg.so prebuiltlibs/external/libjpeg-turbo/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_x86_x86_64_shared/libjpeg.so ] && mkdir -p prebuiltlibs/external/libjpeg-turbo/android_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libjpeg-turbo/libjpeg/android_x86_x86_64_shared/libjpeg.so prebuiltlibs/external/libjpeg-turbo/android_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libjpeg-turbo/libjpeg_static_ndk/android_x86_64_sdk_static/libjpeg_static_ndk.a ] && mkdir -p prebuiltlibs/external/libjpeg-turbo/android_x86_64_sdk_static/ && cp out/soong/.intermediates/external/libjpeg-turbo/libjpeg_static_ndk/android_x86_64_sdk_static/libjpeg_static_ndk.a prebuiltlibs/external/libjpeg-turbo/android_x86_64_sdk_static/ || true
        [ -e out/soong/.intermediates/external/libjpeg-turbo/libjpeg_static_ndk/android_x86_64_static/libjpeg_static_ndk.a ] && mkdir -p prebuiltlibs/external/libjpeg-turbo/android_x86_64_static/ && cp out/soong/.intermediates/external/libjpeg-turbo/libjpeg_static_ndk/android_x86_64_static/libjpeg_static_ndk.a prebuiltlibs/external/libjpeg-turbo/android_x86_64_static/ || true
        mkdir -p prebuiltlibs/external/libjpeg-turbo/. && cp -r external/libjpeg-turbo/./* prebuiltlibs/external/libjpeg-turbo/.
        cp -r out/soong/ninja/external/libjpeg-turbo prebuiltlibs/external/libjpeg-turbo/external_libjpeg-turbo-0
        grep '|external/libjpeg-turbo' out/soong/module-info.txt >> prebuiltlibs/external/libjpeg-turbo/MODULES
        du -ad1 external/libjpeg-turbo | sort -rnk1 > prebuiltlibs/external/libjpeg-turbo/.SIZE
        popd
    - name: write Android.bp external_libjpeg-turbo-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libjpeg\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libjpeg.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libjpeg.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libjpeg.so\",\n\tandroid_x86_x86_64_shared: \"android_x86_x86_64_shared/libjpeg.so\",\n\tsrcs: [\"android_x86_64_shared/libjpeg.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tvndk: { enabled: true, }, \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\".\"],\n}\ncc_prebuilt_library_static {\n\tname: \"libjpeg_static_ndk\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: false,\n\tandroid_x86_64_sdk_static: \"android_x86_64_sdk_static/libjpeg_static_ndk.a\",\n\tandroid_x86_64_static: \"android_x86_64_static/libjpeg_static_ndk.a\",\n\tsrcs: [\"android_x86_64_static/libjpeg_static_ndk.a\"],\n\ttarget: { android: { compile_multilib: \"64\",  }, },\n\trequired: [\"libc.ndk\",\"libdl.ndk\",\"libm.ndk\",\"libstdc++.ndk\",\"libc\",\"libdl\",\"libm\"],\n\tsdk_version: \"21\", \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\".\"],\n}" >> prebuiltlibs/external/libjpeg-turbo/Android.bp
        printf "\n" >> prebuiltlibs/external/libjpeg-turbo/Android.bp
        popd
    - name: Archive external_libjpeg-turbo-0
      uses: actions/upload-artifact@v3
      with:
        name: external_libjpeg-turbo-0
        path: aosp/prebuiltlibs/external/libjpeg-turbo
  external_libldac-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/libldac
      id: external_libldac
      uses: actions/cache@v3
      with:
        path: "aosp/external/libldac"
        key: "external_libldac@$BRANCH"
        restore-keys: "external_libldac@$BRANCH"
    - name: Clone project external/libldac
      if: steps.external_libldac.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/libldac
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_libldac-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/libldac/libldacBT_enc/android_vendor.31_x86_64_shared/libldacBT_enc.so out/soong/.intermediates/external/libldac/libldacBT_enc/android_vendor.31_x86_x86_64_shared/libldacBT_enc.so out/soong/.intermediates/external/libldac/libldacBT_abr/android_vendor.31_x86_64_shared/libldacBT_abr.so out/soong/.intermediates/external/libldac/libldacBT_abr/android_vendor.31_x86_x86_64_shared/libldacBT_abr.so)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_libldac-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/libldac/libldacBT_enc/android_vendor.31_x86_64_shared/libldacBT_enc.so ] && mkdir -p prebuiltlibs/external/libldac/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/libldac/libldacBT_enc/android_vendor.31_x86_64_shared/libldacBT_enc.so prebuiltlibs/external/libldac/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libldac/libldacBT_enc/android_vendor.31_x86_x86_64_shared/libldacBT_enc.so ] && mkdir -p prebuiltlibs/external/libldac/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libldac/libldacBT_enc/android_vendor.31_x86_x86_64_shared/libldacBT_enc.so prebuiltlibs/external/libldac/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libldac/libldacBT_abr/android_vendor.31_x86_64_shared/libldacBT_abr.so ] && mkdir -p prebuiltlibs/external/libldac/android_vendor.31_x86_64_shared/ && cp out/soong/.intermediates/external/libldac/libldacBT_abr/android_vendor.31_x86_64_shared/libldacBT_abr.so prebuiltlibs/external/libldac/android_vendor.31_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libldac/libldacBT_abr/android_vendor.31_x86_x86_64_shared/libldacBT_abr.so ] && mkdir -p prebuiltlibs/external/libldac/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libldac/libldacBT_abr/android_vendor.31_x86_x86_64_shared/libldacBT_abr.so prebuiltlibs/external/libldac/android_vendor.31_x86_x86_64_shared/ || true
        mkdir -p prebuiltlibs/external/libldac/inc && cp -r external/libldac/inc/* prebuiltlibs/external/libldac/inc
        mkdir -p prebuiltlibs/external/libldac/abr/inc && cp -r external/libldac/abr/inc/* prebuiltlibs/external/libldac/abr/inc
        cp -r out/soong/ninja/external/libldac prebuiltlibs/external/libldac/external_libldac-0
        grep '|external/libldac' out/soong/module-info.txt >> prebuiltlibs/external/libldac/MODULES
        du -ad1 external/libldac | sort -rnk1 > prebuiltlibs/external/libldac/.SIZE
        popd
    - name: write Android.bp external_libldac-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library_shared {\n\tname: \"libldacBT_enc\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libldacBT_enc.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libldacBT_enc.so\",\n\tsrcs: [\"android_vendor.31_x86_64_shared/libldacBT_enc.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tvndk: { enabled: true, }, \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"inc\"],\n}\ncc_prebuilt_library_shared {\n\tname: \"libldacBT_abr\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_64_shared: \"android_vendor.31_x86_64_shared/libldacBT_abr.so\",\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libldacBT_abr.so\",\n\tsrcs: [\"android_vendor.31_x86_64_shared/libldacBT_abr.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libldacBT_enc\",\"libm\"],\n\tvndk: { enabled: true, }, \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"abr/inc\"],\n}" >> prebuiltlibs/external/libldac/Android.bp
        printf "\n" >> prebuiltlibs/external/libldac/Android.bp
        popd
    - name: Archive external_libldac-0
      uses: actions/upload-artifact@v3
      with:
        name: external_libldac-0
        path: aosp/prebuiltlibs/external/libldac
  external_libopus-0:
    runs-on: ubuntu-latest
    needs: [bionic-0,clone_bootstrap,clone_prebuilts,external_libcxx-0,external_libcxxabi-0]

    steps:
    - name: Checkout
      uses: actions/checkout@main
    - uses: actions/setup-python@v4
      with:
        python-version: "2.7"
    - name: Restore Cache build/make
      id: build_make
      uses: actions/cache@v3
      with:
        path: "aosp/build/make"
        key: "build_make@$BRANCH"
        restore-keys: "build_make@$BRANCH"
    - name: Restore Cache build/blueprint
      id: build_blueprint
      uses: actions/cache@v3
      with:
        path: "aosp/build/blueprint"
        key: "build_blueprint@$BRANCH"
        restore-keys: "build_blueprint@$BRANCH"
    - name: Restore Cache build/soong
      id: build_soong
      uses: actions/cache@v3
      with:
        path: "aosp/build/soong"
        key: "build_soong@$BRANCH"
        restore-keys: "build_soong@$BRANCH"
    - name: Restore Cache bionic
      id: bionic
      uses: actions/cache@v3
      with:
        path: "aosp/bionic"
        key: "bionic@$BRANCH"
        restore-keys: "bionic@$BRANCH"
    - name: Restore Cache external/libcxx
      id: external_libcxx
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxx"
        key: "external_libcxx@$BRANCH"
        restore-keys: "external_libcxx@$BRANCH"
    - name: Restore Cache external/libcxxabi
      id: external_libcxxabi
      uses: actions/cache@v3
      with:
        path: "aosp/external/libcxxabi"
        key: "external_libcxxabi@$BRANCH"
        restore-keys: "external_libcxxabi@$BRANCH"
    - name: Restore Cache external/compiler-rt
      id: external_compiler-rt
      uses: actions/cache@v3
      with:
        path: "aosp/external/compiler-rt"
        key: "external_compiler-rt@$BRANCH"
        restore-keys: "external_compiler-rt@$BRANCH"
    - name: Restore Cache external/gwp_asan
      id: external_gwp_asan
      uses: actions/cache@v3
      with:
        path: "aosp/external/gwp_asan"
        key: "external_gwp_asan@$BRANCH"
        restore-keys: "external_gwp_asan@$BRANCH"
    - name: Restore Cache external/golang-protobuf
      id: external_golang-protobuf
      uses: actions/cache@v3
      with:
        path: "aosp/external/golang-protobuf"
        key: "external_golang-protobuf@$BRANCH"
        restore-keys: "external_golang-protobuf@$BRANCH"
    - name: Restore Cache external/starlark-go
      id: external_starlark-go
      uses: actions/cache@v3
      with:
        path: "aosp/external/starlark-go"
        key: "external_starlark-go@$BRANCH"
        restore-keys: "external_starlark-go@$BRANCH"
    - name: Restore Cache system/core
      id: system_core
      uses: actions/cache@v3
      with:
        path: "aosp/system/core"
        key: "system_core@$BRANCH"
        restore-keys: "system_core@$BRANCH"
    - name: Restore Cache system/libbase
      id: system_libbase
      uses: actions/cache@v3
      with:
        path: "aosp/system/libbase"
        key: "system_libbase@$BRANCH"
        restore-keys: "system_libbase@$BRANCH"
    - name: Restore Cache system/libhwbinder
      id: system_libhwbinder
      uses: actions/cache@v3
      with:
        path: "aosp/system/libhwbinder"
        key: "system_libhwbinder@$BRANCH"
        restore-keys: "system_libhwbinder@$BRANCH"
    - name: Restore Cache system/logging
      id: system_logging
      uses: actions/cache@v3
      with:
        path: "aosp/system/logging"
        key: "system_logging@$BRANCH"
        restore-keys: "system_logging@$BRANCH"
    - name: Restore Cache system/sepolicy
      id: system_sepolicy
      uses: actions/cache@v3
      with:
        path: "aosp/system/sepolicy"
        key: "system_sepolicy@$BRANCH"
        restore-keys: "system_sepolicy@$BRANCH"
    - name: Restore Cache kernel/configs
      id: kernel_configs
      uses: actions/cache@v3
      with:
        path: "aosp/kernel/configs"
        key: "kernel_configs@$BRANCH"
        restore-keys: "kernel_configs@$BRANCH"
    - name: Restore Cache prebuilts/build-tools
      id: prebuilts_build-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/build-tools"
        key: "prebuilts_build-tools@$BRANCH"
        restore-keys: "prebuilts_build-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang-tools
      id: prebuilts_clang-tools
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang-tools"
        key: "prebuilts_clang-tools@$BRANCH"
        restore-keys: "prebuilts_clang-tools@$BRANCH"
    - name: Restore Cache prebuilts/clang/host/linux-x86
      id: prebuilts_clang_host_linux-x86
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/clang/host/linux-x86"
        key: "prebuilts_clang_host_linux-x86@$BRANCH"
        restore-keys: "prebuilts_clang_host_linux-x86@$BRANCH"
    - name: Restore Cache prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8
      id: prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.17-4.8"
        key: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
        restore-keys: "prebuilts_gcc_linux-x86_host_x86_64-linux-glibc2_17-4_8@$BRANCH"
    - name: Restore Cache prebuilts/ndk
      id: prebuilts_ndk
      uses: actions/cache@v3
      with:
        path: "aosp/prebuilts/ndk"
        key: "prebuilts_ndk@$BRANCH"
        restore-keys: "prebuilts_ndk@$BRANCH"
    - name: Copy and Link
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        cp build/make/core/root.mk Makefile
        ln -sf make/CleanSpec.mk build/ && ln -sf make/core build/
        ln -sf make/target build/ && ln -sf make/tools build/
        ln -sf build/soong/root.bp Android.bp
        mkdir -p prebuilts/go && touch prebuilts/go/.out-dir
        ln -sf $GOROOT_1_19_X64 prebuilts/go/linux-x86
        popd
    - name: Download artifact external_gwp_asan-0
      uses: actions/download-artifact@v3
      with:
        name: external_gwp_asan-0
        path: aosp/prebuiltlibs/external/gwp_asan/
    - name: Download artifact external_scudo-0
      uses: actions/download-artifact@v3
      with:
        name: external_scudo-0
        path: aosp/prebuiltlibs/external/scudo/
    - name: Download artifact external_arm-optimized-routines-0
      uses: actions/download-artifact@v3
      with:
        name: external_arm-optimized-routines-0
        path: aosp/prebuiltlibs/external/arm-optimized-routines/
    - name: Download artifact external_libcxx-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxx-0
        path: aosp/prebuiltlibs/external/libcxx/
    - name: Download artifact external_libcxxabi-0
      uses: actions/download-artifact@v3
      with:
        name: external_libcxxabi-0
        path: aosp/prebuiltlibs/external/libcxxabi/
    - name: Restore Cache external/libopus
      id: external_libopus
      uses: actions/cache@v3
      with:
        path: "aosp/external/libopus"
        key: "external_libopus@$BRANCH"
        restore-keys: "external_libopus@$BRANCH"
    - name: Clone project external/libopus
      if: steps.external_libopus.outputs.cache-hit != 'true'
      run: |
        export ROOTDIR=$(pwd)
        mkdir -p aosp && pushd aosp
        source $ROOTDIR/envsetup.sh
        clone_depth_platform external/libopus
    - name: Start Soong
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        mkdir -p out/soong/.minibootstrap out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/soong_build out/soong/.bootstrap/bin
        ln -sf $ROOTDIR/bpglob out/soong/.minibootstrap
        cp $ROOTDIR/ckati prebuilts/build-tools/linux-x86/bin
        GOROOT=$TOP/prebuilts/go/linux-x86 $ROOTDIR/soong_ui --make-mode --skip-soong-tests --skip-write-modules -j1 TARGET_PRODUCT=aosp_x86_64 TARGET_BUILD_VARIANT=eng ALLOW_MISSING_DEPENDENCIES=true BUILD_BROKEN_DISABLE_BAZEL=1 nothing
        popd
    - name: build target external_libopus-0
      run: |
        export ROOTDIR=$(pwd)
        pushd aosp
        export TOP=$(pwd)
        outputs=$($ROOTDIR/filter-outputs.py out/soong/.intermediates/external/libopus/libopus/android_vendor.31_x86_x86_64_shared/libopus.so out/soong/.intermediates/external/libopus/libopus/android_x86_64_shared/libopus.so out/soong/.intermediates/external/libopus/libopus/android_x86_64_shared_apex29/libopus.so)
        $TOP/prebuilts/build-tools/linux-x86/bin/ninja -f out/combined-aosp_x86_64.ninja $outputs
        popd
    - name: copy target external_libopus-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        [ -e out/soong/.intermediates/external/libopus/libopus/android_vendor.31_x86_x86_64_shared/libopus.so ] && mkdir -p prebuiltlibs/external/libopus/android_vendor.31_x86_x86_64_shared/ && cp out/soong/.intermediates/external/libopus/libopus/android_vendor.31_x86_x86_64_shared/libopus.so prebuiltlibs/external/libopus/android_vendor.31_x86_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libopus/libopus/android_x86_64_shared/libopus.so ] && mkdir -p prebuiltlibs/external/libopus/android_x86_64_shared/ && cp out/soong/.intermediates/external/libopus/libopus/android_x86_64_shared/libopus.so prebuiltlibs/external/libopus/android_x86_64_shared/ || true
        [ -e out/soong/.intermediates/external/libopus/libopus/android_x86_64_shared_apex29/libopus.so ] && mkdir -p prebuiltlibs/external/libopus/android_x86_64_shared_apex29/ && cp out/soong/.intermediates/external/libopus/libopus/android_x86_64_shared_apex29/libopus.so prebuiltlibs/external/libopus/android_x86_64_shared_apex29/ || true
        mkdir -p prebuiltlibs/external/libopus/include && cp -r external/libopus/include/* prebuiltlibs/external/libopus/include
        cp -r out/soong/ninja/external/libopus prebuiltlibs/external/libopus/external_libopus-0
        grep '|external/libopus' out/soong/module-info.txt >> prebuiltlibs/external/libopus/MODULES
        du -ad1 external/libopus | sort -rnk1 > prebuiltlibs/external/libopus/.SIZE
        popd
    - name: write Android.bp external_libopus-0
      run: |
        export ROOTDIR=$(pwd)
        export TOP=$(pwd)
        pushd aosp
        printf "cc_prebuilt_library {\n\tname: \"libopus\",\n\tdevice_supported: true,\n\thost_supported: false,\n\tvendor_available: true,\n\tandroid_vendor_31_x86_x86_64_shared: \"android_vendor.31_x86_x86_64_shared/libopus.so\",\n\tandroid_x86_64_shared: \"android_x86_64_shared/libopus.so\",\n\tandroid_x86_64_shared_apex29: \"android_x86_64_shared_apex29/libopus.so\",\n\tsrcs: [\"android_x86_64_shared/libopus.so\"],\n\ttarget: { android: { compile_multilib: \"both\",  }, },\n\trequired: [\"libc\",\"libc++\",\"libdl\",\"libm\"],\n\tmin_sdk_version: \"29\", apex_available: [\"//apex_available:platform\",\"com.android.media.swcodec\",], \n\tprefer: true,\n\tstrip: { none: true, },\n\texport_include_dirs: [\"include\"],\n}" >> prebuiltlibs/external/libopus/Android.bp
        printf "\n" >> prebuiltlibs/external/libopus/Android.bp
        popd
    - name: Archive external_libopus-0
      uses: actions/upload-artifact@v3
      with:
        name: external_libopus-0
        path: aosp/prebuiltlibs/external/libopus
